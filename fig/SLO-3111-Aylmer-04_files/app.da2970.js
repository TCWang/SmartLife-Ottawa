(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{11:function(e,t,s){"use strict";var a=s(41),i=s.n(a);i.a.language("fr",{delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:e=>1===e?"er":"e",currency:{symbol:"$"}});var r=e=>i()().unformat(e),n=(e,t)=>i()(e).format(t);t.a={init:e=>{i.a.language(e)},encodeValue:n,decodeValue:r,decodeValues:e=>Object.keys(e).reduce((t,s)=>(t[s]=r(e[s].val()),t),{}),encodeCurrencyValue:(e,{noDecimal:t,noDollarSign:s})=>n(e,(({noDecimal:e,noDollarSign:t})=>{var s=".[00]",a="$";return e&&(s=""),t&&(a=""),"en"===i.a.language()?"".concat(a,"0,0 ").concat(s):"0,0 ".concat(s," ").concat(a)})({noDecimal:t,noDollarSign:s})),decodeFloat:e=>parseFloat(e),fixDecimalDelimiter:e=>e="fr"===i.a.language()?e.toString().replace(".",","):e.toString().replace(",","."),formatNumbers:e=>new Intl.NumberFormat("fr-FR").format(e.toString())}},243:function(e){e.exports=JSON.parse('{"packages":{"subTitle":{"residential":"Tarifs pour propriétés résidentielles, commerciales et multiplex<sup>1</sup>","newHomes":"Tarifs pour propriétés neuves","land":"Tarifs pour terrains"},"types":{"residential":"Résidentiel, \\nCommercial et Multiplex","newHomes":"Proprieté neuve","land":"Terrain"},"subTypes":{"res":"Résidentiel","comm":"Commercial","mult":"Multiplex"}}}')},244:function(e){e.exports=JSON.parse('{"packages":{"subTitle":{"residential":"Pricing for residential, commercial and multiplex properties<sup>1</sup>","newHomes":"Pricing for newly built properties","land":"Pricing for lot and land"},"types":{"residential":"Residential, \\nCommercial and Multiplex","newHomes":"Newly built","land":"Lot and land"},"subTypes":{"res":"Residential","comm":"Commercial","mult":"Multiplex"}}}')},25:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return r}));var a=s(33),i="search_",r="survey-visits-count";t.c=(e={currentCount:a.a.getValueFromStorage(r,0),closedSurvey:a.a.getValueFromStorage("survey-sticky-closed",!1),participated:a.a.getValueFromStorage("survey-sticky-participate",!1)},t)=>{switch(t.type){case"INCREMENT_SURVEY_STICKY":return Object.assign({},e,{currentCount:t.count});case"CLOSE_SURVEY_STICKY":return Object.assign({},e,{closedSurvey:!0});case"PARTICIPATE_SURVEY":return Object.assign({},e,{participated:!0});default:return e}}},265:function(e,t,s){e.exports=s(432)},288:function(e,t){if(!Object.setPrototypeOf&&!{}.__proto__){var s=Object.getPrototypeOf;Object.getPrototypeOf=e=>e.__proto__?e.__proto__:s.call(Object,e)}},3:function(e,t,s){"use strict";s.d(t,"l",(function(){return r})),s.d(t,"r",(function(){return n})),s.d(t,"t",(function(){return o})),s.d(t,"s",(function(){return l})),s.d(t,"p",(function(){return c})),s.d(t,"n",(function(){return p})),s.d(t,"o",(function(){return d})),s.d(t,"k",(function(){return h})),s.d(t,"u",(function(){return u})),s.d(t,"h",(function(){return m})),s.d(t,"f",(function(){return g})),s.d(t,"i",(function(){return _})),s.d(t,"g",(function(){return b})),s.d(t,"e",(function(){return v})),s.d(t,"d",(function(){return y})),s.d(t,"q",(function(){return f})),s.d(t,"m",(function(){return T})),s.d(t,"b",(function(){return P})),s.d(t,"a",(function(){return w})),s.d(t,"j",(function(){return E})),s.d(t,"c",(function(){return C}));var a=s(18),i=s.n(a),r=i()("style",{default:"#58bf26"}),n=i()("style",{default:"#333"}),o=(i()("style",{default:"#171717"}),i()("style",{default:"320px"})),l=i()("style",{default:"420px"}),c=i()("style",{default:"640px"}),p=i()("style",{default:"769px"}),d=i()("style",{default:"1200px"}),h=i()("style",{default:"1600px"}),u=1e3,m=2.25,g=2.25,_=1,b=1,v=6,y=1.35,f=6,T=8.4,P=m+_+v+2,w=g+b+y+.8,E=28,C="99999999999999999999"},309:function(e,t,s){var a,i,r;!function(n,o){"use strict";i=[s(2)],void 0===(r="function"==typeof(a=function(e){var t=["-webkit-","-moz-","-o-",""],s=["webkit","moz","MS","o",""];function a(t,s){this._element=e(t),this._options=e.extend({speed:30,direction:"left",cycles:1,space:40,delayBetweenCycles:2e3,handleHover:!0,handleResize:!0},s),this._resizeDelay=parseInt(this._options.handleResize,10)||300,this._horizontal="left"===this._options.direction||"right"===this._options.direction,this._animationName="simplemarquee-"+Math.round(1e13*Math.random()).toString(18),this._onResize=this._onResize.bind(this),this._onCycle=this._onCycle.bind(this),this._options.handleResize&&e(window).on("resize",this._onResize),this._options.handleHover&&this._element.on({"mouseenter.simplemarquee":this._onMouseEnter.bind(this),"mouseleave.simplemarquee":this._onMouseLeave.bind(this)}),this._element.on("destroy.simplemarquee",this.destroy.bind(this)),this.update(!0)}return a.prototype.update=function(e){return this._reset(),this._setup(),this._needsAnimation?e?(this._paused=!1,this._cycles=-1,this._onCycle()):this._paused&&this._pause():(this._paused=!1,this._cycles=0),this},a.prototype.pause=function(){return this._needsAnimation&&(this._resetCycle(),this._paused||(this._pause(),this._element.triggerHandler("pause"),this._paused=!0)),this},a.prototype.resume=function(){return this._needsAnimation&&(this._resetCycle(),this._paused&&(this._resume(),this._element.triggerHandler("resume"),this._paused=!1)),this},a.prototype.toggle=function(){return this._paused?this.resume():this.pause(),this},a.prototype.destroy=function(){this._reset(),this._resizeTimeout&&clearTimeout(this._resizeTimeout),e(window).off("resize",this._onResize),this._element.off(".simplemarquee"),this._element.removeData("_simplemarquee"),this._element=null},a.prototype._reset=function(){this._element.removeClass("has-enough-space").css({"word-wrap":"","overflow-wrap":"","white-space":"",overflow:""}),this._wrappers&&(this._contents.closest(this._element).length&&this._element.append(this._contents),this._wrappers.remove(),this._element.children("style").remove()),this._contents=this._wrappers=this._size=null,this._needsAnimation=!1,this._resetCycle()},a.prototype._setup=function(){var t;this._horizontal?(this._element.css({"word-wrap":"normal","overflow-wrap":"normal","white-space":"nowrap",overflow:"hidden"}),this._needsAnimation=this._element[0].scrollWidth>Math.ceil(this._element.outerWidth())):(this._element.css({"word-wrap":"break-word","overflow-wrap":"break-word","white-space":"normal",overflow:"hidden"}),this._needsAnimation=this._element[0].scrollHeight>Math.ceil(this._element.outerHeight())),this._element.toggleClass("has-enough-space",!this._needsAnimation),this._needsAnimation&&(this._contents=this._element.contents(),(t=e('<div class="simplemarquee-wrapper"></div>')).append(this._contents),this._element.append(t),(t=e('<div class="simplemarquee-wrapper"></div>')).append(this._contents.clone()),this._element.append(t),this._wrappers=this._element.children(),this._horizontal?(this._wrappers.css("display","inline-block"),this._wrappers.eq(1).css("margin-left",this._options.space),this._size=this._wrappers.eq(0).outerWidth()+this._options.space):(this._wrappers.eq(1).css("margin-top",this._options.space),this._size=this._wrappers.eq(0).outerHeight()+this._options.space),this._setupAnimation())},a.prototype._setupAnimation=function(){var e,a,i,r;e="<style>\n",t.forEach((function(t){switch(e+="@"+t+"keyframes "+this._animationName+" {\n",this._options.direction){case"left":e+="    0%   { "+t+"transform: translate(0, 0); } \n",e+="    100% { "+t+"transform: translate(-"+this._size+"px, 0); }\n";break;case"right":e+="    0%   { "+t+"transform: translate(-"+this._size+"px, 0); }\n",e+="    100% { "+t+"transform: translate(0, 0); } \n";break;case"top":e+="    0%   { "+t+"transform: translate(0, 0); } \n",e+="    100% { "+t+"transform: translate(0, -"+this._size+"px); }\n";break;case"bottom":e+="    0%   { "+t+"transform: translate(0, -"+this._size+"px); }\n",e+="    100% { "+t+"transform: translate(0, 0); } \n";break;default:throw new Error("Invalid direction: "+this._options.direction)}e+="}\n"}),this),e+="</style>\n",this._element.append(e),this._wrappers.css("animation",this._animationName+" "+this._size/this._options.speed+"s linear infinite"),a=this._wrappers.eq(0),i="AnimationIteration",r=this._onCycle,s.forEach((function(e){e||(i=i.toLowerCase()),a.on(e+i,r)}))},a.prototype._pause=function(){this._wrappers.css("animation-play-state","paused")},a.prototype._resume=function(){this._wrappers.css("animation-play-state","")},a.prototype._resetCycle=function(){this._cycleTimeout&&(clearTimeout(this._cycleTimeout),this._cycleTimeout=null)},a.prototype._onCycle=function(){this._resetCycle(),this._cycles+=1,this._cycles>=this._options.cycles?(this.pause(),this._element.triggerHandler("finish")):(this._pause(),this._element.triggerHandler("cycle"),this._cycleTimeout=setTimeout(function(){this._cycleTimeout=null,this._resume()}.bind(this),this._options.delayBetweenCycles))},a.prototype._onMouseEnter=function(){this._paused?(this._cycles=0,this.resume()):this.pause()},a.prototype._onMouseLeave=function(){this.resume()},a.prototype._onResize=function(){this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(function(){this._resizeTimeout=null,this.update()}.bind(this),this._resizeDelay)},e.fn.simplemarquee=function(t){return this.each((function(s,i){var r;if(r=(i=e(i)).data("_simplemarquee"),"string"==typeof t){if(!r)return;r[t](arguments[1])}else r?r.update(!0):(r=new a(i,t),i.data("_simplemarquee",r))})),this},e.fn.simplemarquee.Constructor=a,e})?a.apply(t,i):a)||(e.exports=r)}()},33:function(e,t,s){"use strict";var a=s(8),i=s.n(a),r=s(25),n=()=>{i.a.setBucket(r.a);var e=i.a.get(r.b);return e||0};t.a={incrementCount:()=>{i.a.setBucket(r.a);var e=i.a.get(r.b);return i.a.set(r.b,e+1),n()},incrementCompareCount:()=>{i.a.setBucket(r.a);var e=i.a.get("survey-compare-visits-count");return i.a.set("survey-compare-visits-count",e+1),n()},getCount:n,getCompareCount:()=>{i.a.setBucket(r.a);var e=i.a.get("survey-compare-visits-count");return e||0},getValueFromStorage:(e,t)=>{i.a.setBucket(r.a);var s=i.a.get(e);return s||t},setInSessionStorage:(e,t)=>(i.a.setBucket(r.a),i.a.set(e,t),i.a.get(e))}},336:function(e,t){L.Rrose=L.Popup.extend({_initLayout:function(){var e,t,s="leaflet-rrose",a=this._container=L.DomUtil.create("div",s+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&((e=this._closeButton=L.DomUtil.create("a",s+"-close-button",a)).href="#close",e.innerHTML="&#215;",L.DomEvent.on(e,"click",this._onCloseButtonClick,this));this.options.position="n",140-this._map.latLngToContainerPoint(this._latlng).y>0&&(this.options.position="s");var i=this._map.latLngToContainerPoint(this._latlng).x-(this._map.getSize().x-0);i>0?this.options.position+="w":(i=0-this._map.latLngToContainerPoint(this._latlng).x)>0&&(this.options.position+="e"),/s/.test(this.options.position)?("s"===this.options.position?(this._tipContainer=L.DomUtil.create("div",s+"-tip-container",a),t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper",a)):(this._tipContainer=L.DomUtil.create("div",s+"-tip-container "+s+"-tip-container-"+this.options.position,a),t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper "+s+"-content-wrapper-"+this.options.position,a)),this._tip=L.DomUtil.create("div",s+"-tip "+s+"-tip-"+this.options.position,this._tipContainer),L.DomEvent.disableClickPropagation(t),this._contentNode=L.DomUtil.create("div",s+"-content",t),L.DomEvent.on(this._contentNode,"mousewheel",L.DomEvent.stopPropagation)):("n"===this.options.position?(t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper",a),this._tipContainer=L.DomUtil.create("div",s+"-tip-container",a)):(t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper "+s+"-content-wrapper-"+this.options.position,a),this._tipContainer=L.DomUtil.create("div",s+"-tip-container "+s+"-tip-container-"+this.options.position,a)),L.DomEvent.disableClickPropagation(t),this._contentNode=L.DomUtil.create("div",s+"-content",t),L.DomEvent.on(this._contentNode,"mousewheel",L.DomEvent.stopPropagation),this._tip=L.DomUtil.create("div",s+"-tip "+s+"-tip-"+this.options.position,this._tipContainer))},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng),t=L.Browser.any3d,s=this.options.offset;t&&L.DomUtil.setPosition(this._container,e),/s/.test(this.options.position)?this._containerBottom=-this._container.offsetHeight+s.y-(t?0:e.y):this._containerBottom=-s.y-(t?0:e.y),/e/.test(this.options.position)?this._containerLeft=s.x+(t?0:e.x):/w/.test(this.options.position)?this._containerLeft=-Math.round(this._containerWidth)+s.x+(t?0:e.x):this._containerLeft=-Math.round(this._containerWidth/2)+s.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}})},432:function(e,t,s){"use strict";s.r(t);var a={};s.r(a),s.d(a,"TILE_ATTRIBUTION_BASE_URL",(function(){return Or})),s.d(a,"TILE_PROVIDER_URL",(function(){return xr})),s.d(a,"TILE_PROVIDER_OPTIONS",(function(){return Dr})),s.d(a,"DEFAULT_INITIAL_ZOOM_LEVEL",(function(){return Mr})),s.d(a,"MAX_IN_SEARCH_LISTING_COUNT",(function(){return Ar})),s.d(a,"MAP_OPTIONS",(function(){return Ir})),s.d(a,"MAP_MOVE_DEBOUNCE_DELAY",(function(){return Br})),s.d(a,"UPDATE_BOUND_DEBOUNCE_DELAY",(function(){return Fr})),s.d(a,"LISTING_HOUSE_ICON_OPTIONS",(function(){return jr})),s.d(a,"LISTING_MULTIPLEX_ICON_OPTIONS",(function(){return Vr})),s.d(a,"LISTING_TERRAIN_ICON_OPTIONS",(function(){return Ur})),s.d(a,"LISTING_COMMERCIAL_ICON_OPTIONS",(function(){return $r})),s.d(a,"LISTING_BUILDER_ICON_OPTIONS",(function(){return Gr})),s.d(a,"BIG_OPEN_HOUSE_ICON_OPTIONS",(function(){return Hr})),s.d(a,"ICONS_BY_GROUP",(function(){return zr})),s.d(a,"SEARCH_CRITERIA_REGIONS",(function(){return Wr})),s.d(a,"SEARCH_CRITERIA_CITIES",(function(){return Kr})),s.d(a,"SEARCH_CRITERIA_TYPE",(function(){return Yr})),s.d(a,"GROUP_TERRAIN",(function(){return Xr})),s.d(a,"LISTING_TYPE_HOUSE",(function(){return Zr})),s.d(a,"LISTING_TYPE_CONDO",(function(){return Jr})),s.d(a,"SOURCE_DP",(function(){return Qr})),s.d(a,"SOURCE_DDF",(function(){return en})),s.d(a,"SOURCE_IDX_TREB",(function(){return tn})),s.d(a,"SOURCE_IDX_RAHB",(function(){return sn})),s.d(a,"SOURCE_IDX_RAE",(function(){return an})),s.d(a,"SOURCE_IDX_CREB",(function(){return rn})),s.d(a,"SOURCE_IDX_TREB_SOLD",(function(){return nn})),s.d(a,"LISTING_NEW_FLAG_OPTIONS",(function(){return on})),s.d(a,"LISTING_VIEWED_FLAG_OPTIONS",(function(){return ln})),s.d(a,"MAX_CLUSTER_ZOOM_LEVEL",(function(){return cn})),s.d(a,"REGION_MARKERS_CUTOFF_ZOOM_LEVEL",(function(){return pn})),s.d(a,"IN_SEARCH_Z_INDEX",(function(){return dn})),s.d(a,"MAX_ZOOM_LEVEL",(function(){return hn})),s.d(a,"MARKER_CLUSTER_OPTIONS",(function(){return un})),s.d(a,"MARKER_CLUSTER_ICON_OPTIONS",(function(){return mn})),s.d(a,"MARKER_BIG_OPEN_HOUSE_GROUP_CLUSTER_ICON_OPTIONS",(function(){return gn})),s.d(a,"MARKER_BIG_OPEN_HOUSE_CLUSTER_ICON_OPTIONS",(function(){return _n})),s.d(a,"MARKER_GROUP_ICON_OPTIONS",(function(){return bn})),s.d(a,"MARKER_CLUSTER_MAX_RADIUS",(function(){return vn})),s.d(a,"ATTRIBUTION_CONTROL_OPTIONS",(function(){return yn})),s.d(a,"POPUP_OPTIONS",(function(){return fn})),s.d(a,"POPUP_REGIONS_OPTIONS",(function(){return Tn})),s.d(a,"POPUP_CLOSE_DELAY",(function(){return Pn})),s.d(a,"BOUNDS_PADDING_RATIO",(function(){return wn})),s.d(a,"VIEWS_CLICK_TYPE",(function(){return En})),s.d(a,"VIEWS_MOUSEOVER_TYPE",(function(){return Cn})),s.d(a,"SCOPE_IN",(function(){return Sn})),s.d(a,"SCOPE_OUT",(function(){return Rn})),s.d(a,"SCOPE_BOTH",(function(){return Nn})),s.d(a,"REGION_ZOOM_LEVEL_DEFAULT",(function(){return kn})),s.d(a,"REGION_ZOOM_LEVEL",(function(){return Ln})),s.d(a,"USE_REGION_MARKERS_FOR_PROVINCE",(function(){return qn}));s(144),s(153),s(155),s(157),s(158),s(159),s(160),s(161),s(164),s(165),s(166),s(169),s(170),s(173),s(174),s(175),s(177),s(179),s(180),s(186),s(187),s(190),s(191),s(193),s(194),s(195),s(196),s(200),s(201),s(202),s(203),s(204),s(205),s(206),s(207),s(208),s(209),s(210),s(213),s(214),s(215),s(217),s(136),s(288);var i=s(0),r=s.n(i),n=s(44),o=s.n(n),l=s(8),c=s.n(l),p=s(2),d=s.n(p);var h=s(11),u=s(72),m=s(7),g={createProviderWrappedComponent:e=>t=>r.a.createElement(m.a,{store:window.DP.store},e(t)),statelessReducer:(e={})=>e},_=(e={},t)=>{switch(t.type){case"SUBMIT_SEARCH_BAR":return Object.assign({},e,{submitting:!0});case"DISABLE_SEARCH":return Object.assign({},e,{enabled:!1});case"ENABLE_SEARCH":return Object.assign({},e,{enabled:!0});case"COLLAPSE_TAGS":return Object.assign({},e,{tagsCollapsed:!0});case"EXPAND_TAGS":return Object.assign({},e,{tagsCollapsed:!1});default:return e}},b=(e,t="id")=>e.reduce(({ids:e,items:s},a)=>e.includes(a[t])?{ids:e,items:s}:{ids:e.concat(a[t]),items:s.concat(a)},{ids:[],items:[]}).items,v=e=>[...new Set(e)],y=e=>[...new Map(e.map(e=>[e.id,e])).values()],f=e=>({id:"position",typeOfResource:"position",name:e.text,position:e.position}),T=(e=[],t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":case"CLEAR_SEARCH_GEO":return[];case"ADD_POSITION_SEARCH_TERM":return[f(t)];case"ADD_SEARCH_TERM":return b(e.concat([t.term]),"uniqueId").filter(e=>"position"!==e.typeOfResource);case"REMOVE_SEARCH_TERM":var s=e.slice();"region"===t.term.type&&(s=s.filter(e=>e.regionId!==t.term.uniqueId));var a=s.map(e=>e.uniqueId).indexOf(t.term.uniqueId);return-1===a||s.splice(a,1),s;default:return e}},P=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_ROOMS_COUNT":return Object.assign({},e,{selected:t.value});default:return e}},w=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_BATHROOMS_COUNT":return Object.assign({},e,{selected:t.value});default:return e}},E=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_ONLINE_SINCE":return Object.assign({},e,{selected:t.count});default:return e}},C=(e={},t)=>{var s;switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:[]});case"SET_SEARCH_SELECTED_PRICE_RANGE_MINIMUM":return(s=e.selected.slice())[0]=t.value,Object.assign({},e,{selected:s});case"SET_SEARCH_SELECTED_PRICE_RANGE_MAXIMUM":return(s=e.selected.slice())[1]=t.value,Object.assign({},e,{selected:s});case"SET_SEARCH_SELECTED_PRICE_RANGE_PROVIDER":return Object.assign({},e,{sliderProvider:t.value});default:return e}},S=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_TYPE":return Object.assign({},e,{selected:v(e.selected.concat([t.searchType]))});case"ADD_SEARCH_SELECTED_TYPES":return Object.assign({},e,{selected:v(e.selected.concat(t.searchTypes))});case"REMOVE_SEARCH_SELECTED_TYPE":var s=e.selected.slice(),a=s.indexOf(t.searchType);return s.splice(a,1),Object.assign({},e,{selected:s});case"REMOVE_SEARCH_SELECTED_TYPES":var i=e.selected.filter(e=>!t.searchTypes.includes(e));return Object.assign({},e,{selected:i});default:return e}},R=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:[]});case"ADD_SEARCH_SELECTED_SUBTYPE":return Object.assign({},e,{selected:v(e.selected.concat([t.subType]))});case"ADD_SEARCH_SELECTED_SUBTYPES":return Object.assign({},e,{selected:y(e.selected.concat(t.subTypes))});case"REMOVE_SEARCH_SELECTED_SUBTYPE":var s=e.selected.slice(),a=s.map(({id:e})=>e).indexOf(t.subType.id);return s.splice(a,1),Object.assign({},e,{selected:s});case"REMOVE_SEARCH_SELECTED_SUBTYPES":var i=t.subTypes.map(({id:e})=>e),r=e.selected.filter(({id:e})=>!i.includes(e));return Object.assign({},e,{selected:r});case"CLEAR_SEARCH_SELECTED_SUBTYPES":var n=e.selected.filter(({typeId:e})=>!t.searchTypes.includes(e));return Object.assign({},e,{selected:n});default:return e}},N=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_OPTION":return Object.assign({},e,{selected:v(e.selected.concat([t.option]))});case"ADD_SEARCH_SELECTED_OPTIONS":var s=t.options,a=s.indexOf("0");return s.splice(a,1),Object.assign({},e,{selected:v(e.selected.concat(s))});case"REMOVE_SEARCH_SELECTED_OPTION":var i=e.selected.slice(),r=i.map(e=>e).indexOf(t.option);return i.splice(r,1),Object.assign({},e,{selected:i});case"REMOVE_SEARCH_SELECTED_OPTIONS":var n=t.options.map(e=>e.id),o=e.selected.filter(e=>!n.includes(e.id));return Object.assign({},e,{selected:o});default:return e}},k=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":case"CLEAR_SEARCH_GEO":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_FILTER":return Object.assign({},e,{selected:t.filter});default:return e}},q=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_FLAG":return Object.assign({},e,{selected:v(e.selected.concat([t.flag]))});case"REMOVE_SEARCH_SELECTED_FLAG":var s=e.selected.slice(),a=e.selected.indexOf(t.flag);return s.splice(a,1),Object.assign({},e,{selected:s});default:return e}},O="fetching",x="completed",D="failed",M="empty",A="bypass",I=(e={status:M,query:null,payload:[],highlightedIndex:null},t)=>{var s;switch(t.type){case"RESET_SUGGEST_TERMS":return Object.assign({},e,{status:M,payload:[],highlightedIndex:null});case"FETCH_SUGGEST_TERMS":return Object.assign({},e,{status:O,query:t.query,payload:[],highlightedIndex:null});case"COMPLETED_SUGGEST_TERMS":return t.query===e.query&&e.status===O?Object.assign({},e,{status:x,query:null,payload:t.terms,highlightedIndex:0}):e;case"BYPASS_SUGGEST_TERMS":return Object.assign({},e,{status:A,payload:[],highlightedIndex:null});case"FAILED_SUGGEST_TERMS":return t.query===e.query&&e.status===O?Object.assign({},e,{status:D,query:null,payload:[],highlightedIndex:null}):e;case"HIGHLIGHT_SUGGESTED_TERM":return Object.assign({},e,{highlightedIndex:t.index});case"HIGHLIGHT_NEXT_SUGGESTED_TERM":return 0===e.payload.length?e:(s=(s=null!==e.highlightedIndex?e.highlightedIndex+1:0)<e.payload.length?s:0,Object.assign({},e,{highlightedIndex:s}));case"HIGHLIGHT_PREVIOUS_SUGGESTED_TERM":return 0===e.payload.length?e:(s=(s=null!==e.highlightedIndex?e.highlightedIndex-1:e.payload.length-1)>=0?s:e.payload.length-1,Object.assign({},e,{highlightedIndex:s}));default:return e}},B=(e=0,t)=>{switch(t.type){case"RESET_SEARCH_BAR":return Math.random();default:return e}},F=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LAND_AREA":return Object.assign({},e,{selected:t.option});default:return e}};function j(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function V(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?j(Object(s),!0).forEach((function(t){U(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function U(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var $=(e={},t)=>{var s;switch(t.type){case"SET_SEARCH_SORT_ORDER":return Object.assign({},e,{selected:t.option});case"ADD_POSITION_SEARCH_TERM":return s=e.options.map(e=>V({},e,{hidden:!1})),Object.assign({},e,{options:s,selected:"distance"});case"REMOVE_SEARCH_TERM":return"position"!==t.term.id?e:(s=e.options.map(e=>V({},e,{hidden:"distance"===e.value})),Object.assign({},e,{options:s,selected:s[1].value}));default:return e}},G=(e={},t)=>(t.type,e),H=(e={activeTabName:"",scrollToTab:!1,items:[]},t)=>{switch(t.type){case"ACTIVATE_LISTING_TAB":return Object.assign({},e,{activeTabName:t.name,scrollToTab:t.scrollToTab});default:return e}},z=(e={},t)=>{switch(t.type){case"SET_SEARCH_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},W=(e={},t)=>{switch(t.type){case"SHOW_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});case"ADD_GTM_CATEGORY_CONTACT_FORM":return Object.assign({},e,{gtmCategory:t.gtmCategory});case"ADD_GTM_ACTION_CONTACT_FORM":return Object.assign({},e,{gtmAction:t.gtmAction});case"ADD_GTM_SUBMIT_CALL_NAME":return Object.assign({},e,{gtmSubmitCallName:t.gtmSubmitCallName});default:return e}},K=(e={},t)=>{switch(t.type){case"SHOW_CALLBACK_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_CALLBACK_FORM":return Object.assign({},e,{isVisible:!1});case"ADD_GTM_CATEGORY_CALLBACK_FORM":return Object.assign({},e,{gtmCategory:t.gtmCategory});case"ADD_GTM_ACTION_CALLBACK_FORM":return Object.assign({},e,{gtmAction:t.gtmAction});default:return e}},Y=(e={},t)=>{switch(t.type){case"SHOW_SELLER_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_SELLER_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},X=(e={},t)=>{switch(t.type){case"SHOW_LISTING_INFORMATIONS_FORM":return Object.assign({},e,{isVisible:!0,modalType:t.modalType});case"HIDE_LISTING_INFORMATIONS_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},Z=(e={},t)=>{switch(t.type){case"SHOW_LISTING_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_LISTING_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},J=(e={},t)=>{switch(t.type){case"SET_SEARCH_MAP_VISIBLE_IN_SEARCH_LISTING_COUNT":return Object.assign({},e,{visibleInSearchListingCount:t.count});case"SET_SEARCH_MAP_INITIAL_LISTINGS_FETCHED":return Object.assign({},e,{initialListingsFetched:t.fetched});default:return e}},Q=(e={},t)=>{switch(t.type){case"SUBMIT_TESTIMONIALS":return Object.assign({},e,{submitting:!0});default:return e}},ee=(e={},t)=>{switch(t.type){case"SET_TESTIMONIALS_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},te=(e={},t)=>{switch(t.type){case"SET_TESTIMONIALS_REGION_ID":return Object.assign({},e,{regionId:t.regionId});default:return e}},se=(e={},t)=>{switch(t.type){case"TOGGLE_LISTING_FAVOURITE":if(e.favouriteListingIds.includes(t.listingId)){var s=e.favouriteListingIds.slice(),a=s.indexOf(t.listingId);if(-1===a)return e;s.splice(a,1);var i=Object.assign({},e.favouriteListingNotes);return delete i[t.listingId],Object.assign({},e,{favouriteListingIds:s,favouriteListingNotes:i})}return Object.assign({},e,{favouriteListingIds:e.favouriteListingIds.concat([t.listingId])});case"UPDATE_LISTING_FAVOURITE_NOTE":var r=Object.assign({},e.favouriteListingNotes);return r[t.listingId]=t.note,Object.assign({},e,{favouriteListingNotes:r});default:return e}},ae=(e={showPopover:!1,currentPopover:null},t)=>{switch(t.type){case"TOGGLE_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{showPopover:!e.showPopover});case"HIDE_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{showPopover:!1});case"CURRENT_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{currentPopover:t.origin});default:return e}},ie=(e={},t)=>{switch(t.type){case"SUBMIT_BUILDER_LISTINGS":default:return e}},re=(e={},t)=>{switch(t.type){case"SET_BUILDER_LISTINGS_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},ne=(e,t)=>t*le(e),oe=(e,t)=>{var s=t>0?t/100:0,a=le(e);return Math.pow(Math.pow(1+s/2,2),1/a)-1},le=e=>"bi-weekly"===e?26:"weekly"===e?52:12,ce="weekly",pe=e=>{for(var t=Object.assign({},e),s=Math.pow(1+e.interestRate/100/2,1/6)-1,a=1+s,i=1,r=0;r<12*e.amortization;r++)i*=a;var n=Math.floor(e.loanAmount*s/(1-1/i)*100)/100;return t.monthlyMortgage=isNaN(n)?0:n,t.yearlyMortgage=12*t.monthlyMortgage,t.monthlyTotalCosts=t.monthlyCostsRows.concat([t.monthlyMortgage]).reduce((e,t)=>e+t,0),t.yearlyTotalCosts=12*t.monthlyTotalCosts,t.monthlyTotalIncomeNet=t.monthlyIncomeRows.reduce((e,t)=>e+t,0)-t.monthlyTotalCosts,t.yearlyTotalIncomeNet=12*t.monthlyTotalIncomeNet,t},de=(e,t)=>e-t,he=(e,t,s,a)=>{var i=oe(e,s),r=ne(e,a),n=Math.pow(1+i,r),o=t*(i*n)/(n-1);return isNaN(o)?0:+o.toFixed(2)},ue=(e,t)=>{c.a.setBucket("mortgage_calculator");var s=c.a.get(e);return s||t},me=(e,t)=>{c.a.setBucket("mortgage_calculator"),c.a.set(e,t)},ge=(e,t)=>e<t,_e=(e={amortization:ue("amortization","25"),downPayment:ue("downPayment","0"),frequency:ue("frequency",ce),interest:ue("interest","3.09"),price:"0",term:ue("term","5")},t)=>{switch(t.type){case"SET_MORTGAGE_CALCULATOR_VALUE":return me([t.id],t.value),Object.assign({},e,{[t.id]:t.value});default:return e}},be=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LOT_SIZE_MINIMUM":return Object.assign({},e,{selectedMinimum:t.option});case"SET_SEARCH_SELECTED_LOT_SIZE_MAXIMUM":return Object.assign({},e,{selectedMaximum:t.option});case"SET_SEARCH_SELECTED_LOT_SIZE":return Object.assign({},e,{selected:t.option});default:return e}},ve=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LIVING_AREA_MINIMUM":return Object.assign({},e,{selectedMinimum:t.option});case"SET_SEARCH_SELECTED_LIVING_AREA_MAXIMUM":return Object.assign({},e,{selectedMaximum:t.option});case"SET_SEARCH_SELECTED_LIVING_AREA":return Object.assign({},e,{selected:t.option});default:return e}},ye=(e={currentItem:null,visible:!1},t)=>{switch(t.type){case"MODAL_SELECTED_ITEM":return Object.assign({},e,{currentItem:t.selected});case"SHOW_MODAL":return Object.assign({},e,{visible:!0});case"HIDE_MODAL":return Object.assign({},e,{visible:!1});default:return e}},fe=(e={currentPackage:window.DP.isNewHomes?"CONS":"RES"},t)=>{switch(t.type){case"SELECTED_PACKAGE":return Object.assign({},e,{currentPackage:t.selected});default:return e}},Te=(e={},t)=>{switch(t.type){case"SHOW_WARNING_MESSAGE":return Object.assign({},e,{showWarningMessage:!0});default:return e}},Pe=s(25),we=e=>{var t=window.devToolsExtension&&window.devToolsExtension(),s=Object(u.b)({searchLandArea:F,searchTypes:S,searchRooms:P,searchPriceRange:C,searchFlags:q,searchFilters:k,searchOnlineSince:E,searchOptions:N,searchSubTypes:R,searchTerms:T,searchBathrooms:w,searchReset:B,searchSuggestedTerms:I,searchSortOrder:$,searchBar:_,searchPagination:z,searchAdditionalCriteria:g.statelessReducer,searchFieldResults:g.statelessReducer,searchFieldInput:g.statelessReducer,mobileSearch:g.statelessReducer,searchRegionsAndCitiesResults:g.statelessReducer,searchBarPushEvents:g.statelessReducer,searchLotSize:be,searchLivingArea:ve,testimonials:Q,testimonialsPagination:ee,testimonialsRegion:te,listing:G,listingTabs:H,listingsFavourites:se,contactForm:W,sellerContactForm:Y,listingTroubleReachingForm:X,listingContactForm:Z,mortgageCalculator:_e,callbackForm:K,searchMap:J,favouriteNotesPanel:ae,builderListings:ie,builderListingsPagination:re,Modal:ye,warningMessageBar:Te,Packages:fe,surveySticky:Pe.c});return Object(u.c)(s,e,t)},Ee='<p class="message error">An error occured, please try again later.</p>',Ce=e=>{if(void 0!==e&&("https://tpc.googlesyndication.com"===e.origin||e.origin.endsWith(".duproprio.com"))&&e.data.hasOwnProperty("action")&&"contact-advertiser"===e.data.action){var t=d()("form#mortgage-data__form-costs"),s=t.find("input.mortgage-data__form__field__loan-amount").val(),a=t.find("select.mortgage-data__form__field__amortization").val(),i=t.find("input.mortgage-data__form__field__interest-rate").val(),r=e.data.data.advertiser,n=e.data.data.client;d.a.ajax({type:"POST",url:"/webservice/advertiser/contact",dataType:"json",data:{"advertiser-langue":window.DP.lang,"advertiser-province":window.DP.province,"hab-code":window.DP.preloadedState.listing.code,"advertiser-price":window.DP.preloadedState.listing.price,"advertiser-name":n.name,"advertiser-phone":n.phone,"advertiser-email":n.email,"advertiser-comment":n.comments,"advertiser-client":"".concat(r.id,"|").concat(r.name),"advertiser-destinationEmail":r.email.main,"advertiser-destinationEmail2":r.email.secondary,"advertiser-loanAmount":s,"advertiser-amortization":a,"advertiser-interestRate":i},beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}}).done(t=>{var s={action:"contact-advertiser-reply",data:{message:t.hasOwnProperty("confirm")?t.confirm:Ee}};e.source.postMessage(s,e.origin)}).fail(()=>{var t={action:"contact-advertiser-reply",data:{message:Ee}};e.source.postMessage(t,e.origin)})}},Se=s(5),Re={value:window.DP.breakpoints.small,label:"xxsmall"},Ne={value:window.DP.breakpoints.small,label:"small"},ke={value:640,label:"small_medium"},Le={value:window.DP.breakpoints.medium,label:"medium"},qe=window.DP.breakpoints.regular,Oe="regular",xe=window.DP.breakpoints.large,De="large",Me=window.DP.breakpoints.xlarge,Ae="xlarge",Ie=()=>{var e,t,s,a=(e="body",t="width",window.getComputedStyle(document.querySelector(e)).getPropertyValue(t)),i=(s=parseInt(a,10))>=Me?Ae:s>=xe?De:s>=qe?Oe:s>=Le.value?Le.label:s>=ke.value?ke.label:s>=Ne.value?Ne.label:Re.label;Be(i),((e,t=null)=>{var s=new CustomEvent(e,{bubbles:!0,cancelable:!1,detail:t});document.dispatchEvent(s)})("viewport-size-change")},Be=e=>{document.querySelector("body").setAttribute("data-size",e)},Fe=()=>-1!==[Re.label,Ne.label,ke.label,Le.label].indexOf(document.querySelector("body").getAttribute("data-size")),je=s(1);class Ve extends r.a.Component{constructor(e){super(e),this.state={clickedText:!1}}handleTextClick(){var e=!this.state.clickedText;this.setState({clickedText:e})}render(){return r.a.createElement("div",{className:"message"},r.a.createElement("h1",{className:"message-title"},this.props.title),r.a.createElement("p",{className:"message-text",onClick:this.handleTextClick.bind(this)},this.props.text,this.state.clickedText?" (clicked!)":""),r.a.createElement("ul",{className:"message-items"},Array.from(this.props.items).map(e=>this.renderItem(e))),r.a.createElement("pre",{className:"message-dictionary"},JSON.stringify(this.props.dictionary)))}renderItem(e){return r.a.createElement(Ue,{key:"item:".concat(e.id),item:e})}}class Ue extends r.a.Component{handleClick(){console.log("Item has been clicked",this.props.item)}render(){return r.a.createElement("li",{className:"message-items-item",onClick:this.handleClick.bind(this)},this.props.item.name)}}Ue.propTypes={item:je.PropTypes.object.isRequired},Ve.propTypes={title:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired,items:je.PropTypes.array.isRequired,active:je.PropTypes.bool.isRequired,dictionary:je.PropTypes.object.isRequired};var $e=Ve,Ge=s(6),He=(e,t={})=>Object.keys(t).reduce((s,a)=>t[a]?s.concat(["".concat(e,"--").concat(a.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))]):s,[e]).join(" "),ze=()=>r.a.createElement("div",{className:"spinner"}),We=s(20),Ke=s.n(We),Ye=(e,t="full")=>new Promise((s,a)=>{var i=Ke()(window.DP.urls.proxyFreeTextSearch,e);"simple"===t&&(i=Ke()(window.DP.urls.proxyFreeTextSearchSimple,e)),d.a.ajax({url:i}).done(s).fail(a)}),Xe=(e,t)=>{var s;return function(){var a=this,i=arguments,r=()=>{s=null,e.apply(a,i)};clearTimeout(s),s=setTimeout(r,t)}},Ze=()=>{var e={enableHighAccuracy:!0,timeout:15e3,maximumAge:0};return new Promise((t,s)=>navigator.geolocation?navigator.geolocation.getCurrentPosition(t,s,e):s())},Je=e=>Object.keys(e).reduce((t,s)=>{var a=e[s];return("object"==typeof a&&null!==a&&a.length>0||"object"!=typeof a&&void 0!==a)&&(t[s]=a),t},{}),Qe=()=>window.$window.width()<window.DP.breakpoints.regular,et=()=>window.DP.isRental?"is_rental":"is_for_sale",tt=()=>Qe()?5:10,st=({searchOptions:e},t)=>{if(e.selected.find(e=>e===t))return 1},at=({searchFlags:e},t)=>{if(e.options.map(({id:e})=>e).includes(t))return e.selected.find(e=>e===t)?1:0},it=({searchFilters:e},t)=>{if(e.selected===t)return 1},rt=({searchLotSize:e},t)=>{if(e.selectedUnit===t&&"~"!==e.selected&&e.selectedMinimum!==e.selectedMaximum)return e.selected},nt=({searchLivingArea:e},t)=>{if(e.selectedUnit===t&&"~"!==e.selected&&e.selectedMinimum!==e.selectedMaximum)return e.selected},ot=(e,t)=>{var s=(({searchTerms:e})=>e.filter(e=>"regions"===e.typeOfResource).map(e=>e.id))(e),a=(({searchTerms:e})=>e.filter(e=>"cities"===e.typeOfResource).map(e=>e.id))(e),i=(({searchTerms:e},t)=>{var s=e.filter(e=>"position"===e.typeOfResource)[0],a=0===e.length,{latitude:i,longitude:r}=s?s.position.coords:{undefined:void 0},n=i&&r?[i,r].join(","):null;return a||t.position&&n!==t.position?t.position:n})(e,t),r=i?t.zoom:null,n=(({searchTerms:e})=>e.filter(e=>"position"===e.typeOfResource)[0]?1:null)(e),o=(({searchPriceRange:e})=>{if(e.selected[0])return e.selected[0].value})(e),l=(({searchPriceRange:e})=>{if(e.selected[1])return e.selected[1].value})(e),c=(({searchTypes:e})=>e.selected)(e),p=(({searchSubTypes:e})=>e.selected.map(({id:e})=>e))(e),d=(({searchRooms:e})=>{if("0"!==e.selected)return e.selected})(e),h=(({searchBathrooms:e})=>{if("0"!==e.selected)return e.selected})(e),u=rt(e,"foot"),m=rt(e,"meter"),g=nt(e,"foot"),_=nt(e,"meter"),b=(({searchOnlineSince:e})=>{if(0!==e.selected)return e.selected})(e),v=it(e,"is_featured_home"),y=it(e,"is_open_house"),f=it(e,"has_virtual_tour"),T=it(e,"is_sold"),P=it(e,"is_builder"),w=it(e,"is_for_sale"),E=it(e,"is_rental"),C=at(e,"with_builders"),S=at(e,"parent"),R=at(e,"with_external_listings"),N=st(e,"has_fireplace"),k=st(e,"has_pool"),L=st(e,"has_panoramic_view"),q=st(e,"has_parking_garage"),O=st(e,"has_parking_exterior"),x=st(e,"has_waterfront"),D=st(e,"has_no_back_neighbor"),M=st(e,"has_income"),A=(({searchPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e),I=(({searchSortOrder:e,searchTerms:t})=>{var s=t.filter(e=>"position"===e.typeOfResource)[0];return"distance"!==e.selected||s?"new_listings_first"!==e.selected?e.selected:void 0:"new_listings_first"})(e),B=st(e,"has_heated_included"),F=st(e,"has_lit_included"),j=st(e,"has_hot_water_included"),V=st(e,"has_furnished_included"),U=st(e,"has_parking"),$=st(e,"has_animals_accepted"),G=st(e,"has_washer_dryer_connection"),H=st(e,"has_elevator"),z=st(e,"has_new_rental"),W=st(e,"has_retired");return Je({search:!0,position:i,near_me:n,zoom:r,regions:s,cities:a,min_price:o,max_price:l,type:c,subtype:p,rooms:d,bathrooms:h,lot_dimension_sq_meter:m,lot_dimension_sq_feet:u,living_space_sq_feet:g,living_space_sq_meter:_,is_featured_home:v,online_since:b,is_sold:T,is_builder:P,is_for_sale:w,is_rental:E,is_open_house:y,has_virtual_tour:f,with_builders:C,parent:S,with_external_listings:R,has_fireplace:N,has_pool:k,has_panoramic_view:L,has_parking_garage:q,has_parking_exterior:O,has_waterfront:x,has_no_back_neighbor:D,has_income:M,pageNumber:A,sort:I,has_heated_included:B,has_lit_included:F,has_hot_water_included:j,has_furnished_included:V,has_parking:U,has_animals_accepted:$,has_washer_dryer_connection:G,has_elevator:H,has_new_rental:z,has_retired:W})},lt=(e=!1,{searchTerms:t})=>{var s=new URLSearchParams(window.location.search),a=t.filter(e=>"regions"===e.typeOfResource||"cities"===e.typeOfResource)[0],i=e||a?null:s.get("position"),r=e||a?null:s.get("zoom");return{position:i||null,zoom:r||null}},ct=(e,t=!1)=>{var s=ot(e,lt(t,e)),a=d.a.param(s),i=t?window.DP.urls.mapSearch:window.DP.urls.searchDispatch;window.location="".concat(i,"?").concat(a)},pt=()=>{var e=window.DP.store.getState(),t=ot(e,lt(!1,e)),s=d.a.param(t);return d.a.ajax({url:window.DP.urls.searchUpdateCriteria,type:"POST",data:s,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},dt=ot,ht=lt,ut=e=>({type:"ADD_SEARCH_TERM",term:e}),mt=e=>({type:"REMOVE_SEARCH_TERM",term:e}),gt=(e,t)=>({type:"ADD_POSITION_SEARCH_TERM",position:e,text:t}),_t=e=>({type:"SET_SEARCH_SELECTED_ROOMS_COUNT",value:e}),bt=e=>({type:"SET_SEARCH_SELECTED_BATHROOMS_COUNT",value:e}),vt=e=>({type:"SET_SEARCH_SELECTED_ONLINE_SINCE",count:e}),yt=e=>({type:"SET_SEARCH_SELECTED_PRICE_RANGE_MINIMUM",value:e}),ft=e=>({type:"SET_SEARCH_SELECTED_PRICE_RANGE_MAXIMUM",value:e}),Tt=e=>({type:"REMOVE_SEARCH_SELECTED_TYPE",searchType:e}),Pt=e=>({type:"ADD_SEARCH_SELECTED_TYPES",searchTypes:e}),wt=e=>({type:"REMOVE_SEARCH_SELECTED_TYPES",searchTypes:e}),Et=e=>({type:"REMOVE_SEARCH_SELECTED_SUBTYPE",subType:e}),Ct=e=>({type:"ADD_SEARCH_SELECTED_SUBTYPES",subTypes:e}),St=e=>({type:"REMOVE_SEARCH_SELECTED_SUBTYPES",subTypes:e}),Rt=e=>({type:"ADD_SEARCH_SELECTED_OPTION",option:e}),Nt=e=>({type:"REMOVE_SEARCH_SELECTED_OPTION",option:e}),kt=e=>({type:"SET_SEARCH_SELECTED_FILTER",filter:e}),Lt=e=>({type:"ADD_SEARCH_SELECTED_FLAG",flag:e}),qt=e=>({type:"SET_SEARCH_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e}),Ot=e=>(ct(window.DP.store.getState(),e),{type:"SUBMIT_SEARCH_BAR"}),xt=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE_MINIMUM",option:e}),Dt=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE_MAXIMUM",option:e}),Mt=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE",option:e}),At=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA_MINIMUM",option:e}),It=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA_MAXIMUM",option:e}),Bt=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA",option:e}),Ft=({checked:e,partial:t,partialCount:s})=>{var a=He("search-checkbox",{checked:e||t,unchecked:!e&&!t,partial:t});return r.a.createElement("span",{className:a},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0}),t?r.a.createElement("span",{className:"search-checkbox__partial-count"},s):null)};Ft.propTypes={checked:je.PropTypes.bool,partial:je.PropTypes.bool,partialCount:je.PropTypes.number};var jt=Ft;class Vt extends r.a.Component{constructor(e){super(e),this.state={regionCitiesId:null,fetchingNearMe:!1}}componentDidUpdate({searchSuggestedTerms:e}){var{highlightedIndex:t}=this.props.searchSuggestedTerms,s=e.highlightedIndex;if(null!==t&&s!==t&&this.refs.query){var a=Array.from(this.refs.query.querySelectorAll(".search-results__item")),i=a.slice(0,t).reduce((e,t)=>e+t.offsetHeight,0),r=a[t].offsetHeight,n=this.refs.query.offsetHeight,o=this.refs.query.scrollTop;null===s&&0===t||s<t?i>o+n-r&&(this.refs.query.scrollTop=i-n+r):i<o&&(this.refs.query.scrollTop=i)}}handleTermHighlight(e){this.props.dispatch((e=>({type:"HIGHLIGHT_SUGGESTED_TERM",index:e}))(e))}handleRegionToggleVisibilityClick(e){var t=this.state.regionCitiesId===e?null:e;this.setState({regionCitiesId:t})}handleInputNearMeClick(){Ze().then(e=>{this.props.dispatch(gt(e,this.props.searchBar.nearMeTermLabel)),this.setState({fetchingNearMe:!0}),this.props.dispatch(Ot(!0))}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})}),pt()}countCitiesCheckedInRegion(e){var t=0;return e.cities.map(e=>this.hasListTermsChecked(e)).map(e=>!0===e?t++:null),t}hasAtLeastOneCityChecked(e){return this.countCitiesCheckedInRegion(e)>0}hasListTermsChecked(e){if(void 0!==this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId))return!0}render(){var e=He("search-results",{dp:"qc"===window.DP.province,pb:"qc"!==window.DP.province});return r.a.createElement("div",{className:e},this.renderResultsQuery(),r.a.createElement("div",{className:"search-results__actions"},r.a.createElement("span",{className:"search-results__close-button",onClick:this.props.onHideResults},this.props.searchFieldResults.closeResultsText),this.renderSubmitButton()))}renderSubmitButton(){return this.props.onSubmit?this.props.searchBar.enabled?r.a.createElement("button",{className:"search-results__submit-button",onClick:this.props.onSubmit},r.a.createElement(Ge.a,{className:"search-results__submit-button-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):r.a.createElement("button",{className:"search-results__submit-button search-results__submit-button--inactive"},r.a.createElement(Ge.a,{className:"search-results__submit-button-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):null}renderResultsQuery(){return this.props.searchSuggestedTerms.status===O?this.renderFetchingResults():this.props.searchSuggestedTerms.status===A?this.renderRegionsAndCitiesResults():this.props.searchSuggestedTerms.payload.length?this.renderResultsSections():this.props.searchSuggestedTerms.status===x?this.renderEmptyResults():this.props.searchSuggestedTerms.status===D?this.renderError():this.props.searchBar.displayDropdownRegionsCities?this.renderRegionsAndCitiesResults():this.renderNotFetchedResults()}renderResultsSections(){return r.a.createElement("div",{className:"search-results__query",ref:"query"},r.a.createElement("div",{className:"search-results__section"},this.renderResultsByListLink(),this.props.searchSuggestedTerms.payload.map((e,t)=>this.renderResultsItem(e,t))))}renderResultsByListLink(){return this.props.searchBar.displayDropdownRegionsCities?r.a.createElement("div",{className:"search-results__section-link",onClick:this.props.handleByPassSelect.bind(this)},this.props.searchBar.dropdownRegionsLink):null}renderResultsItem(e,t){var s=e.isDirectLink,a=this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId);"cities"===e.typeOfResource&&(a=this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId||t.uniqueId===e.regionUniqueId));var i=this.props.searchSuggestedTerms.highlightedIndex===t,n=He("search-results__item",{selected:a,directLink:s,highlighted:i}),o=r.a.createElement(Ge.a,{className:"search-results__item__arrow",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0});return r.a.createElement("div",{key:"searchResultsSectionItem:".concat(e.uniqueId),className:n,onClick:this.props.handleTermSelect.bind(this,e,"click"),onMouseOver:this.handleTermHighlight.bind(this,t)},r.a.createElement("div",{className:"search-results__item__content"},r.a.createElement("span",{className:"search-results__item__name",dangerouslySetInnerHTML:{__html:e.name}}),r.a.createElement("span",{className:"search-results__item__details",dangerouslySetInnerHTML:{__html:e.details}})),s?o:null)}renderRegionsAndCitiesResults(){return r.a.createElement("div",{className:"search-results__query",ref:"query"},r.a.createElement("div",{className:"search-results__section"},r.a.createElement("div",{className:"search-results__section__regions"},this.renderRegionsAndCitiesGeolocalisation(),this.props.searchRegionsAndCitiesResults.map((e,t)=>this.renderRegionsAndCitiesResultsItem(e,t)))))}renderRegionsAndCitiesGeolocalisation(){return r.a.createElement("div",{className:"search-results__geolocalisation-container"},r.a.createElement("div",{className:"search-results__geolocalisation",onClick:this.handleInputNearMeClick.bind(this)},r.a.createElement("span",{className:"search-results__geolocalisation-icon"},this.state.fetchingNearMe?r.a.createElement(ze,null):r.a.createElement(Ge.a,{className:"search-field__near-me-icon is-no-events",src:"/build/img/svg/icn-pin.svg",cacheGetRequests:!0})),r.a.createElement("span",{className:"search-results__geolocalisation-label"},this.props.searchBar.nearMeTermLabel)),r.a.createElement("span",{className:"search-results__geolocalisation-line"}))}renderRegionsAndCitiesResultsItem(e,t){var s=this.hasListTermsChecked(e.region),a="".concat("search-results__section__region"," ").concat("search-results__section__region","-").concat(t),i=He("search-results__section__region-title",{selected:s||this.hasAtLeastOneCityChecked(e),open:this.state.regionCitiesId===t});return r.a.createElement("div",{className:a,key:t},r.a.createElement("span",{className:i,onClick:this.handleRegionToggleVisibilityClick.bind(this,t)},r.a.createElement(Ge.a,{className:"search-results__section__region-button__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}),r.a.createElement("h2",{className:"search-results__section__region-title-label"},e.region.name),this.renderCheckedRegionsAndCitiesCount(e,s)),this.renderSingleRegionCitiesList(e,s,t))}renderSelectAllRegionResults(e,t){var s=t,a=He("search-types-popover__option-label",{checked:s});return r.a.createElement("li",{key:e.region.uniqueId,className:"search-types-popover__option",onClick:this.props.handleTermSelectAllCities.bind(this,e)},r.a.createElement(jt,{key:e.region.uniqueId,checked:s}),r.a.createElement("span",{className:a},e.region.label))}renderCitiesResultsList(e,t){var s=this.hasListTermsChecked(e)||t,a=He("search-types-popover__option-label",{checked:s});return r.a.createElement("li",{key:e.uniqueId,className:"search-types-popover__option",onClick:this.props.handleTermSelect.bind(this,e,"click")},r.a.createElement(jt,{key:e.uniqueId,checked:s}),r.a.createElement("span",{className:a},e.name))}renderFetchingResults(){return r.a.createElement("div",{className:"search-results__query"},r.a.createElement("div",{className:"search-results__query__spinner"},r.a.createElement(ze,null)))}renderNotFetchedResults(){var e="simple"===this.props.suggestType?this.props.searchFieldResults.notFetchedGeoResults:this.props.searchFieldResults.notFetchedResults;return r.a.createElement("div",{className:"search-results__query search-results__query--empty"},this.renderRegionsAndCitiesGeolocalisation(),r.a.createElement("p",{className:"search-results__query__empty-text"},e.title),e.text?r.a.createElement("p",{className:"search-results__query__empty-text"},e.text):null)}renderEmptyResults(){var e="fr"===window.DP.locale?"--french":"--english",t="search-results__result-empty".concat(e);return r.a.createElement("div",{className:"search-results__query search-results__query--empty"},this.renderResultsByListLink(),r.a.createElement("div",{className:"search-results__query--empty-container"},r.a.createElement("p",{className:"search-results__query__empty-title"},this.props.searchFieldResults.emptyResultsTitle," ",r.a.createElement("span",{className:t},this.props.searchText),"."),r.a.createElement("p",{className:"search-results__query__empty-text"},this.props.searchFieldResults.emptyResultsText)))}renderError(){return r.a.createElement("div",{className:"search-results__query search-results__query--empty"},r.a.createElement("p",{className:"search-results__query__empty-title"},this.props.searchFieldResults.errorTitle),r.a.createElement("p",{className:"search-results__query__empty-text"},this.props.searchFieldResults.errorText))}renderCheckedRegionsAndCitiesCount(e,t){var s=t?this.props.searchBar.dropdownRegionsCitiesLabelAll:this.countCitiesCheckedInRegion(e),a=He("search-results__section__region-counter",{hidden:!s});return r.a.createElement("div",null,r.a.createElement("span",{className:a,onClick:this.props.handleTermRemoveAllCities.bind(this,e,!0)},r.a.createElement(Ge.a,{className:"search-results__section__region-counter__icon-check",src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0}),s,r.a.createElement(Ge.a,{className:"search-results__section__region-counter__icon-close",src:"/build/img/svg/icn-compare-no.svg",cacheGetRequests:!0})))}renderSingleRegionCitiesList(e,t,s){return this.state.regionCitiesId!==s?null:r.a.createElement("ul",{className:"search-types-popover__options"},this.renderSelectAllRegionResults(e,t),e.cities.map(e=>this.renderCitiesResultsList(e,t)))}}Vt.defaultProps={suggestType:"full"},Vt.propTypes={searchSuggestedTerms:je.PropTypes.shape({payload:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired,details:je.PropTypes.string.isRequired,typeOfResource:je.PropTypes.string.isRequired,source:je.PropTypes.string.isRequired,province:je.PropTypes.string.isRequired,regionId:je.PropTypes.number,uniqueId:je.PropTypes.string.isRequired})).isRequired,status:je.PropTypes.string.isRequired,highlightedIndex:je.PropTypes.number}).isRequired,handleTermSelect:je.PropTypes.func.isRequired,handleTermSelectAllCities:je.PropTypes.func.isRequired,handleTermRemoveAllCities:je.PropTypes.func.isRequired,handleByPassSelect:je.PropTypes.func.isRequired,searchTerms:je.PropTypes.array.isRequired,searchText:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired,onHideResults:je.PropTypes.func.isRequired,onSubmit:je.PropTypes.func,suggestType:je.PropTypes.string,searchFieldResults:je.PropTypes.shape({notFetchedGeoResults:je.PropTypes.shape({title:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired}).isRequired,notFetchedResults:je.PropTypes.shape({title:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired}).isRequired,emptyResultsTitle:je.PropTypes.string.isRequired,emptyResultsText:je.PropTypes.string.isRequired,closeResultsText:je.PropTypes.string.isRequired,errorTitle:je.PropTypes.string.isRequired,errorText:je.PropTypes.string.isRequired}).isRequired,searchBar:je.PropTypes.shape({button:je.PropTypes.string.isRequired,submitting:je.PropTypes.boolean,enabled:je.PropTypes.boolean,nearMeTermLabel:je.PropTypes.string.isRequired,advancedSearchLabel:je.PropTypes.string.isRequired,disabledFields:je.PropTypes.array.isRequired,displayDropdownRegionsCities:je.PropTypes.bool.isRequired,dropdownRegionsCitiesLabelAll:je.PropTypes.string.isRequired,dropdownRegionsLink:je.PropTypes.string.isRequired}).isRequired,searchRegionsAndCitiesResults:je.PropTypes.arrayOf(je.PropTypes.shape({region:je.PropTypes.shape({id:je.PropTypes.string.isRequired,uniqueId:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired,province:je.PropTypes.string.isRequired,source:je.PropTypes.string.isRequired,typeOfResource:je.PropTypes.string,isDirectLink:je.PropTypes.bool.isRequired}).isRequired,cities:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,uniqueId:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired,isDirectLink:je.PropTypes.bool.isRequired,province:je.PropTypes.string.isRequired,regionId:je.PropTypes.string.isRequired,source:je.PropTypes.string.isRequired,typeOfResource:je.PropTypes.string.isRequired})).isRequired}))};var Ut=Vt=Object(m.b)(({searchTerms:e,searchSuggestedTerms:t,searchFieldResults:s,searchBar:a,searchRegionsAndCitiesResults:i})=>({searchTerms:e,searchSuggestedTerms:t,searchFieldResults:s,searchBar:a,searchRegionsAndCitiesResults:i}))(Vt);class $t extends r.a.Component{handleKeyUp(e){if(38===e.keyCode&&this.props.dispatch({type:"HIGHLIGHT_PREVIOUS_SUGGESTED_TERM"}),40===e.keyCode&&this.props.dispatch({type:"HIGHLIGHT_NEXT_SUGGESTED_TERM"}),13===e.keyCode){var t=this.props.highlightedSearchTerm;if(!t)return;this.props.handleTermSelect(t,"enter")}}getPlaceholder(){var{placeholder:e,placeholderGeo:t,selectedLabel:s}=this.props.searchFieldInput,a=this.props.searchTerms.length;return"simple"===this.props.suggestType?a>0?"".concat(a," ").concat(s):t:e}render(){return r.a.createElement("label",{className:"search-field__form__label"},r.a.createElement("span",{className:"is-visually-hidden"},this.props.searchFieldInput.placeholder),r.a.createElement("input",{className:"search-field__form__input",placeholder:this.getPlaceholder(),type:"text",value:this.props.value,onKeyUp:this.handleKeyUp.bind(this),onFocus:this.props.handleFocus.bind(this),onChange:this.props.handleChange.bind(this)}))}}$t.defaultProps={suggestType:"full"},$t.propTypes={dispatch:je.PropTypes.func.isRequired,value:je.PropTypes.string.isRequired,handleTermSelect:je.PropTypes.func.isRequired,handleChange:je.PropTypes.func.isRequired,handleFocus:je.PropTypes.func.isRequired,searchFieldInput:je.PropTypes.shape({placeholder:je.PropTypes.string.isRequired,placeholderGeo:je.PropTypes.string.isRequired,selectedLabel:je.PropTypes.string.isRequired}).isRequired,searchTerms:je.PropTypes.array.isRequired,highlightedSearchTerm:je.PropTypes.object,suggestType:je.PropTypes.string};var Gt=$t=Object(m.b)(({searchFieldInput:e,searchTerms:t,searchSuggestedTerms:s})=>{var{payload:a,highlightedIndex:i}=s;return{searchFieldInput:e,searchTerms:t,highlightedSearchTerm:a[i]}})($t);class Ht extends r.a.Component{constructor(e){super(e),this.documentClick=this.handleDocumentClick.bind(this),this.submitEnabled=!0,this.handleSearch=Xe(this.handleSearch.bind(this),500),this.state={searchText:"",showResults:!1,inputIsFocused:!1,hiddenSearchTermsCount:0}}componentDidUpdate(e,{showResults:t}){t===this.state.showResults&&(!0===t?(document.addEventListener("click",this.documentClick),document.addEventListener("touchstart",this.documentClick)):(document.removeEventListener("click",this.documentClick),document.removeEventListener("touchstart",this.documentClick)))}componentDidMount(){document.addEventListener("mousedown",this.documentClick)}activateFormSubmit(){this.setState({searchText:""}),this.submitEnabled=!0,this.props.dispatch({type:"ENABLE_SEARCH"})}deactivateFormSubmit(){this.submitEnabled=!1,this.props.dispatch({type:"DISABLE_SEARCH"})}focusOutSearchInput(){this.refs.searchInput.querySelector(".search-field__form__input").blur()}handleDocumentClick(e){[this.refs.searchResults].every(t=>!t.contains(e.target))&&(this.focusOutSearchInput(),this.handleHideResults())}handleInputChange(e){var t=e.target.value,s=t.trim();this.state.searchText.trim()!==s&&(this.handleSearch(s),s.length>0?this.deactivateFormSubmit():this.activateFormSubmit()),this.setState({searchText:t})}handleSearch(e){var{suggestType:t}=this.props;e.length<=2?this.props.dispatch({type:"RESET_SUGGEST_TERMS"}):(this.state.showResults||this.setState({showResults:!0}),this.props.dispatch((({query:e})=>({type:"FETCH_SUGGEST_TERMS",query:e}))({query:e})),Ye(e,t).then(t=>{this.props.dispatch((({query:e,terms:t})=>({type:"COMPLETED_SUGGEST_TERMS",query:e,terms:t}))({terms:t,query:e}))}).catch(()=>{this.props.dispatch((({query:e})=>({type:"FAILED_SUGGEST_TERMS",query:e}))({query:e}))}))}handleInputFocus(){this.setState({showResults:!0}),d()(".mobile-header").addClass("mobile-header_search-focus"),d()(".know-more__bar").addClass("know-more__bar-focus")}handleHideResults(){this.setState({showResults:!1}),setTimeout(()=>this.activateFormSubmit(),500),d()(".mobile-header").removeClass("mobile-header_search-focus"),d()(".know-more__bar").removeClass("know-more__bar-focus")}handleFormSubmit(e){e.preventDefault(),this.submitEnabled&&null===this.props.highlightedSearchResultIndex&&this.props.dispatch(Ot())}handleTermSelect(e,t){if(e.isDirectLink)return this.handleTermDirectLink(e);if(this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)){if("enter"===t)return this.props.dispatch(Ot());this.handleTermRemove(e)}else"cities"===e.typeOfResource?this.handleCityAdd(e):this.handleTermAdd(e)}handleTermSelectAllCities(e){this.props.searchTerms.find(t=>t.uniqueId===e.region.uniqueId)?(e.cities.map(e=>this.props.dispatch(mt(e))),this.handleTermRemove(e.region)):(this.handleTermRemoveAllCities(e),this.handleTermAdd(e.region))}handleTermRemoveAllCities(e,t){var s=e.cities.map(e=>this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)),a=t?this.handleTermRemove(e.region):null;s.map(e=>void 0!==e?this.props.dispatch(mt(e)):a)}handleByPassSelect(){this.props.dispatch({type:"BYPASS_SUGGEST_TERMS"})}handleTermAdd(e){this.props.dispatch(ut(e)),this.activateFormSubmit(),pt()}handleTermRemove(e){this.props.dispatch(mt(e)),this.activateFormSubmit(),pt()}handleCityAdd(e){var t=this.props.searchRegionsAndCitiesResults.find(t=>t.region.id===String(e.regionId));t&&(this.props.searchTerms.find(t=>t.uniqueId===e.regionUniqueId)?(this.props.dispatch(mt(t.region)),t.cities.map(t=>{t.uniqueId!==e.uniqueId&&this.props.dispatch(ut(t))}),this.activateFormSubmit(),pt()):t.cities.map(e=>this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)).filter(e=>void 0!==e).length+1>=t.cities.length?(this.handleTermRemoveAllCities(t),this.handleTermAdd(t.region)):this.handleTermAdd(e))}handleTermDirectLink(e){window.location="/".concat(this.props.locale,"/").concat(e.id)}handleInputNearMeClick(){this.setState({fetchingNearMe:!0}),Ze().then(e=>{this.props.dispatch(gt(e,this.props.nearMeTermLabel)),this.setState({fetchingNearMe:!1}),this.props.dispatch(Ot(!0))}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})}),pt()}handleButtonClearValuesClick(){this.props.dispatch({type:"CLEAR_SEARCH_GEO"})}render(){var e=He("search-field",{["at".concat(this.props.location)]:!0,focus:this.state.showResults,"no-search-icon":!this.props.showSearchIcon});return r.a.createElement("div",{className:e,onFocus:this.handleInputFocus.bind(this),ref:"searchResults"},this.renderSearchIcon(),r.a.createElement("form",{onSubmit:this.handleFormSubmit.bind(this),className:"search-field__form",ref:"searchInput"},this.renderSearchInput()),this.renderNearMe(),this.renderClearValues(),this.renderSearchResults())}renderSearchIcon(){var{showSearchIcon:e}=this.props;return e?r.a.createElement("div",{className:"search-field__magnifier"},r.a.createElement(Ge.a,{className:"search-field__magnifier-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):null}renderNearMe(){var{locationText:e,nearMePush:t,showNearMe:s}=this.props,{fetchingNearMe:a}=this.state;if(!s)return null;var i=He("search-field__near-me",{fetching:a});return i=i.concat(" gtm-search-geolocalized"),r.a.createElement("div",{className:i},r.a.createElement("button",{onClick:this.handleInputNearMeClick.bind(this),className:"search-field__near-me-button gtm-search-geolocalized ".concat(t)},r.a.createElement("span",{className:"is-visually-hidden"},e),a?r.a.createElement(ze,null):this.renderNearMeIcon()))}renderNearMeIcon(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ge.a,{className:"search-field__near-me-icon is-no-events",src:"/build/img/svg/icn-pin.svg",cacheGetRequests:!0}),r.a.createElement(Ge.a,{className:"search-field__near-me-icon search-field__near-me-icon--hover is-no-events",src:"/build/img/svg/icn-pin-invert.svg",cacheGetRequests:!0}))}renderClearValues(){var{clearValuesText:e,showClearValues:t,searchTerms:s}=this.props;return!t||s.length<1?null:r.a.createElement("button",{onClick:this.handleButtonClearValuesClick.bind(this),className:"search-field__clear-values"},r.a.createElement("span",{className:"is-visually-hidden"},e),r.a.createElement(Ge.a,{className:"search-field__clear-values__icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderSearchInput(){return r.a.createElement(Gt,{value:this.state.searchText,handleTermSelect:this.handleTermSelect.bind(this),handleFocus:this.handleInputFocus.bind(this),handleChange:this.handleInputChange.bind(this),suggestType:this.props.suggestType})}renderSearchResults(){if(this.state.showResults)return r.a.createElement(Ut,{handleTermSelect:this.handleTermSelect.bind(this),handleTermSelectAllCities:this.handleTermSelectAllCities.bind(this),handleTermRemoveAllCities:this.handleTermRemoveAllCities.bind(this),handleByPassSelect:this.handleByPassSelect.bind(this),searchText:this.state.searchText,onSubmit:this.props.onSubmit,onHideResults:this.handleHideResults.bind(this),suggestType:this.props.suggestType})}}Ht.defaultProps={showClearValues:!1,showNearMe:!0,showSearchIcon:!0,suggestType:"full"},Ht.propTypes={clearValuesText:je.PropTypes.string,dispatch:je.PropTypes.func.isRequired,highlightedSearchResultIndex:je.PropTypes.number,locale:je.PropTypes.string.isRequired,location:je.PropTypes.string.isRequired,locationText:je.PropTypes.string.isRequired,nearMePush:je.PropTypes.string,nearMeTermLabel:je.PropTypes.string.isRequired,onSubmit:je.PropTypes.func,searchBathrooms:je.PropTypes.object,searchFilters:je.PropTypes.object,searchLandArea:je.PropTypes.object,searchOnlineSince:je.PropTypes.object,searchOptions:je.PropTypes.object,searchPriceRange:je.PropTypes.object,searchRegionsAndCitiesResults:je.PropTypes.array.isRequired,searchRooms:je.PropTypes.object,searchSubTypes:je.PropTypes.object,searchTerms:je.PropTypes.array.isRequired,searchTypes:je.PropTypes.object,showClearValues:je.PropTypes.bool,showSearchIcon:je.PropTypes.bool,showNearMe:je.PropTypes.bool,suggestType:je.PropTypes.string,searchLotSize:je.PropTypes.object,searchLivingArea:je.PropTypes.object};var zt=Ht=Object(m.b)(({searchRegionsAndCitiesResults:e,searchTerms:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchSuggestedTerms:d,searchLotSize:h,searchLivingArea:u})=>{var{highlightedIndex:m}=d;return{searchRegionsAndCitiesResults:e,searchTerms:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchLotSize:h,searchLivingArea:u,highlightedSearchResultIndex:m}})(Ht);class Wt extends r.a.Component{constructor(e){super(e),this.documentClick=this.handleDocumentClick.bind(this)}componentDidMount(){document.addEventListener("click",this.documentClick)}componentWillUnmount(){document.removeEventListener("click",this.documentClick)}handleDocumentClick(e){this.refs.popover.contains(e.target)||this.props.onOuterClick()}render(){return r.a.createElement("div",{ref:"popover"},this.props.children)}}Wt.propTypes={onOuterClick:je.PropTypes.func.isRequired,children:je.PropTypes.object.isRequired};var Kt=Wt;class Yt extends r.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleTogglePopover(){this.setState({showPopover:!this.state.showPopover})}getLabel(){var{selectedAsLabel:e,searchRooms:t}=this.props,s=t.title;if(e){var a=t.options.find((function(e){return e.value===t.selected}));a&&(s=a.label)}return s}render(){var e="search-rooms ".concat(this.props.extraClasses);return r.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=He("search-bar__options-button",{active:this.state.showPopover}),t=He("search-bar__options-button__arrow",{active:this.state.showPopover});return r.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:e},r.a.createElement("span",{className:"search-bar__options-button__label"},this.getLabel()),r.a.createElement(Ge.a,{className:t,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?r.a.createElement(Kt,{onOuterClick:this.handleTogglePopover.bind(this)},r.a.createElement(Xt,{dispatch:this.props.dispatch,label:this.props.searchRooms.label,options:this.props.searchRooms.options,selected:this.props.searchRooms.selected})):null}}class Xt extends r.a.Component{handleOptionClick(e){setTimeout(()=>{this.props.dispatch(_t(e)),pt()})}render(){return r.a.createElement("div",{className:"search-rooms-popover"},r.a.createElement("ul",{className:"search-rooms-popover__options"},this.props.options.map(e=>this.renderOption(e))))}renderOption(e){var t=e.value===this.props.selected,s=He("search-rooms-popover__content__option",{checked:t});return r.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchRoomsPopoverOption:".concat(e.value),className:s},r.a.createElement("span",{className:"search-rooms-popover__radio"}),e.label)}}var Zt=je.PropTypes.shape({title:je.PropTypes.string.isRequired,titleSingle:je.PropTypes.string.isRequired,label:je.PropTypes.string,options:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.string.isRequired});Xt.propTypes={dispatch:je.PropTypes.func.isRequired,label:je.PropTypes.string.isRequired,options:je.PropTypes.array.isRequired,selected:je.PropTypes.string.isRequired},Yt.defaultProps={extraClasses:"",selectedAsLabel:!1},Yt.propTypes={dispatch:je.PropTypes.func.isRequired,extraClasses:je.PropTypes.string,searchRooms:Zt.isRequired,selectedAsLabel:je.PropTypes.bool};var Jt=Yt=Object(m.b)(({searchRooms:e})=>({searchRooms:e}))(Yt),Qt=s(73),es=s.n(Qt);class ts extends r.a.Component{constructor(e){super(e),this.steps=e.searchPriceRangeSlider.stepsSlider,this.options=e.searchPriceRangeSlider.options;var t=[];for(var s in t[this.steps.min[0]]=null,t[this.steps.max[0]]=null,this.options)t[this.options[s].numericValue]=this.options[s];this.priceRange=t,this.state={minPosition:!1,maxPosition:!1,sliderRange:[null,null]}}componentDidMount(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];this.slider=es.a.create(this.refs.slider,{connect:!0,start:[e?e.numericValue:this.steps.min[0],t?t.numericValue:this.steps.max[0]],range:this.steps,format:{to:Number,from:Number}}),this.slider.on("update",this.handleSliderUpdate.bind(this)),this.handleSliderChange=Xe(this.handleSliderChange.bind(this),1e3),this.slider.on("change",this.handleSliderChange.bind(this)),this.handleSliderSet=Xe(this.handleSliderSet.bind(this),1e3),this.slider.on("set",this.handleSliderSet.bind(this))}componentDidUpdate(e){this.props.provider!==this.props.searchPriceRangeSlider.sliderProvider&&this.handleChangeSliderPosition(),e.searchReset!==this.props.searchReset&&this.slider.set([this.steps.min[0],this.steps.max[0]])}componentWillUnmount(){this.slider.off("update"),this.slider.off("change"),this.slider.off("set")}handleSliderChange(){this.setState({minPosition:!1,maxPosition:!1})}handleSliderUpdate(e){var[t,s]=e,a=this.priceRange[t],i=this.priceRange[s];if(i=i&&i.numericValue!==this.steps.max[0]?i:null,this.setState({sliderRange:[a?a.value:this.steps.min[0],i?i.value:this.steps.max[0]]}),t===s)return null;this.props.dispatch(yt(a)),this.props.dispatch(ft(i)),this.props.dispatch({type:"SET_SEARCH_SELECTED_PRICE_RANGE_PROVIDER",value:this.props.provider})}handleSliderSet(){this.props.provider===this.props.searchPriceRangeSlider.sliderProvider&&pt()}handleChangeSliderPosition(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];e=e?e.numericValue:this.steps.min[0],t=t?t.numericValue:this.steps.max[0],this.state.sliderRange.toString()!==[e,t].toString()&&(this.slider.set([e,t]),this.setState({sliderRange:[e,t]}))}nextRange(e){var t=Object.values(this.options).map(e=>e.numericValue),s=t.indexOf(e)+1;return t[s]}render(){var e="search-price-range ".concat(this.props.extraClasses);return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"search-price-range__slider"},r.a.createElement("div",{ref:"slider"})),this.renderLabel())}renderLabel(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];e=e?e.value:this.steps.min[0],t=t&&t.numericValue!==this.steps.max[0]?t.value:null;var s=h.a.encodeCurrencyValue(e,{noDecimal:!0}),a=t?h.a.encodeCurrencyValue(t,{noDecimal:!0}):this.props.searchPriceRangeSlider.noMaximumLabel,i=window.DP.isRental&&t?this.props.searchPriceRangeSlider.precisionLabel:"";return r.a.createElement("div",{className:"search-price-range__label"},r.a.createElement("span",null,s),r.a.createElement("span",null,a,i))}}ts.defaultProps={extraClasses:""},ts.propTypes={dispatch:je.PropTypes.func.isRequired,searchReset:je.PropTypes.number,searchPriceRangeSlider:je.PropTypes.shape({stepsSlider:je.PropTypes.object.isRequired,options:je.PropTypes.array.isRequired,selected:je.PropTypes.array.isRequired,noMaximumLabel:je.PropTypes.string.isRequired,noMinimumLabel:je.PropTypes.string.isRequired,precisionLabel:je.PropTypes.string.isRequired,sliderProvider:je.PropTypes.string.isRequired}).isRequired,provider:je.PropTypes.string.isRequired,extraClasses:je.PropTypes.string};var ss=ts=Object(m.b)(({searchPriceRange:e,searchReset:t})=>({searchPriceRangeSlider:e,searchReset:t}))(ts),as=({selected:e})=>e[0]||e[1],is=(e,t)=>{var s=0;return e.length&&e.map(e=>{s+=e.typeId===t}),s},rs=(e,t)=>{var s=0;return e.options.map(e=>{var a=is(t.options,e.id),i=is(t.selected,e.id);s+=i===a?1:i}),s},ns=e=>{var t=0,{searchTerms:s,searchTypes:a,searchSubTypes:i,searchOptions:r,searchRooms:n,searchBathrooms:o,searchPriceRange:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u}=e;return t+=s.length,t+=rs(a,i),t+=r.selected.length,n.selected>n.defaultValue&&(t+=1),o.selected>o.defaultValue&&(t+=1),as(l)&&(t+=1),c.selected!==c.defaultValue&&(t+=1),p.selected!==p.defaultValue&&(t+=1),h.selected!==h.defaultValue&&(t+=1),u.selected!==u.defaultValue&&(t+=1),d.defaultValue.forEach(e=>{d.selected.includes(e)||(t+=1)}),t},os=e=>{var t=0,{searchTerms:s,searchTypes:a,searchSubTypes:i,searchRooms:r,searchBathrooms:n,searchPriceRange:o}=e;return t+=s.length,r.selected>r.defaultValue&&(t+=1),n.selected>n.defaultValue&&(t+=1),as(o)&&(t+=1),rs(a,i)&&(t+=1),t},ls=is;class cs extends r.a.Component{handleOptionClick(e){var t=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{t.length===e?(this.props.dispatch(St(t)),this.props.dispatch(wt(this.props.type.id))):(this.props.dispatch(Ct(t)),this.props.dispatch(Pt(this.props.type.id))),pt()})}render(){if(!this.props.subTypeOpened)return null;var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id)),a=e.length===s.length,i=He("search-subtypes-popover__type-name",{checked:a});return r.a.createElement("div",{className:"search-subtypes-popover__type"},r.a.createElement("div",{onClick:this.handleOptionClick.bind(this,s.length),className:i},r.a.createElement(jt,{checked:a}),this.props.searchSubTypes.checkAllLabel),r.a.createElement("div",{className:"search-subtypes-popover__subtypes"},e.map(e=>this.renderSubTypeOption(e))))}renderSubTypeOption(e){return r.a.createElement(ps,{key:"additionalCriteriaSubtype:".concat(e.id),subType:e})}}class ps extends r.a.Component{handleOptionClick(e){setTimeout(()=>{var t=e?Et(this.props.subType):{type:"ADD_SEARCH_SELECTED_SUBTYPE",subType:this.props.subType};this.props.dispatch(t),this.updateTypeBasedOnSelectedSubtypes(),pt()})}updateTypeBasedOnSelectedSubtypes(){var{searchSubTypes:e,subType:t}=this.props,s=ls(e.options,t.typeId);ls(e.selected,t.typeId)!==s?-1!==this.props.searchTypes.selected.indexOf(t.typeId)&&this.props.dispatch(Tt(t.typeId)):this.props.dispatch({type:"ADD_SEARCH_SELECTED_TYPE",searchType:t.typeId})}render(){var e=!!this.props.searchSubTypes.selected.find(({id:e})=>e===this.props.subType.id),t=He("search-subtypes-popover__subtype",{checked:e});return r.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},r.a.createElement(jt,{checked:e}),this.props.subType.name)}}var ds=je.PropTypes.shape({checkAllLabel:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,typeId:je.PropTypes.string.isRequired})).isRequired}),hs=je.PropTypes.shape({options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.array.isRequired});cs.propTypes={dispatch:je.PropTypes.func.isRequired,searchSubTypes:ds.isRequired,searchTypes:hs.isRequired,type:je.PropTypes.object.isRequired,subTypeOpened:je.PropTypes.bool.isRequired},ps.propTypes={dispatch:je.PropTypes.func.isRequired,searchSubTypes:ds.isRequired,searchTypes:hs.isRequired,subType:je.PropTypes.object.isRequired},cs=Object(m.b)(({searchSubTypes:e,searchTypes:t})=>({searchSubTypes:e,searchTypes:t}))(cs),ps=Object(m.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(ps);var us=cs;class ms extends r.a.Component{constructor(e){super(e),this.state={subTypeOpened:!1}}handleToggleClick(){this.setState({subTypeOpened:!this.state.subTypeOpened})}handleOptionClick(){var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{this.props.dispatch(St(e)),this.props.dispatch(wt(this.props.type.id)),pt()})}render(){var e=He("search-types-popover__type-button",{opened:this.state.subTypeOpened});return r.a.createElement("li",{className:"search-types-popover__option search-types-popover__option--types"},r.a.createElement("div",{className:e},r.a.createElement("span",{onClick:this.handleToggleClick.bind(this)},r.a.createElement(Ge.a,{className:"search-types-popover__type-button__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}),this.props.type.name),this.renderCheckbox()),r.a.createElement(us,{type:this.props.type,subTypeOpened:this.state.subTypeOpened}))}renderCheckbox(){var e=this.props.searchSubTypes.options.filter(e=>this.props.type.id===e.typeId),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id));return s.length?r.a.createElement("div",{onClick:this.handleOptionClick.bind(this),className:"search-types-popover__type-button-unchecked"},r.a.createElement(Ge.a,{className:"search-types-popover__type-button-unchecked__checked",src:"/build/img/svg/icn-check.svg"}),e.length===s.length?this.props.searchTypes.checkedAllLabel:s.length,r.a.createElement(Ge.a,{className:"search-types-popover__type-button-unchecked__close",src:"/build/img/svg/icn-close.svg"})):null}}ms.propTypes={dispatch:je.PropTypes.func.isRequired,selectedTypes:je.PropTypes.array.isRequired,searchTypes:je.PropTypes.object.isRequired,searchSubTypes:je.PropTypes.object.isRequired,type:je.PropTypes.object.isRequired};var gs=ms=Object(m.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(ms);class _s extends r.a.Component{constructor(e){super(e)}handleOptionClick(e){var t=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{t.length===e||0!==e?(this.props.dispatch(St(t)),this.props.dispatch(wt(this.props.type.id))):(this.props.dispatch(Ct(t)),this.props.dispatch(Pt(this.props.type.id))),pt()})}render(){var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id)),a=0!==s.length,i=He("search-types-popover__type-button",{opened:a});return r.a.createElement("li",{className:"search-types-popover__option search-types-popover__option--types",onClick:this.handleOptionClick.bind(this,s.length)},r.a.createElement("div",{className:i},r.a.createElement(jt,{checked:a}),r.a.createElement("span",null,this.props.type.name)))}}_s.propTypes={dispatch:je.PropTypes.func.isRequired,selectedTypes:je.PropTypes.array.isRequired,searchTypes:je.PropTypes.object.isRequired,searchSubTypes:je.PropTypes.object.isRequired,type:je.PropTypes.object.isRequired};var bs=_s=Object(m.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(_s),vs=je.PropTypes.shape({options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.array.isRequired});class ys extends r.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleTogglePopover(){this.setState({showPopover:!this.state.showPopover})}render(){var e="search-types ".concat(this.props.extraClasses);return r.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=He("search-bar__options-button",{active:this.state.showPopover});return r.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:e},this.renderButtonLabel())}renderLabel(){var{selectedAsLabel:e,searchTypes:t,selectedLabel:s}=this.props,a=t.placeholder,i=t.placeholderShort;if(e)if(1===t.selected.length){var n=t.options.find((function(e){return e.id===t.selected[0]}));n&&(a=i=n.name)}else t.selected.length>1&&(a=i="".concat(t.selected.length," ").concat(s));return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"search-bar__options-button__label-long"},a),r.a.createElement("span",{className:"search-bar__options-button__label-short"},i))}renderButtonLabel(){var e=He("search-bar__options-button__arrow",{active:this.state.showPopover});return r.a.createElement("span",{className:"search-bar__options-button__label"},this.renderLabel(),r.a.createElement(Ge.a,{className:e,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?r.a.createElement(Kt,{onOuterClick:this.handleTogglePopover.bind(this)},r.a.createElement(fs,{dispatch:this.props.dispatch,searchTypes:this.props.searchTypes})):null}}class fs extends r.a.Component{render(){return r.a.createElement("div",{className:"search-types-popover"},r.a.createElement("ul",{className:"search-types-popover__options"},this.props.searchTypes.options.map(e=>this.renderOption(e))))}renderOption(e){return"qc"!==window.DP.province?r.a.createElement(bs,{type:e,key:"searchTypesPopoverOption:".concat(e.id),selectedTypes:this.props.searchTypes.selected,dispatch:this.props.dispatch}):r.a.createElement(gs,{type:e,key:"searchTypesPopoverOption:".concat(e.id),selectedTypes:this.props.searchTypes.selected,dispatch:this.props.dispatch})}}fs.propTypes={dispatch:je.PropTypes.func.isRequired,searchTypes:vs.isRequired},ys.defaultProps={extraClasses:"",selectedAsLabel:!1,selectedLabel:""},ys.propTypes={dispatch:je.PropTypes.func.isRequired,extraClasses:je.PropTypes.string,searchTypes:vs.isRequired,selectedAsLabel:je.PropTypes.bool,selectedLabel:je.PropTypes.string};var Ts=ys=Object(m.b)(({searchTypes:e})=>({searchTypes:e}))(ys);class Ps extends r.a.Component{handleOptionClick(e){this.props.dispatch(kt(e.id)),pt()}render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--filter"},this.props.searchFilters.title),r.a.createElement("div",{className:"search-additional-criteria-popover__content"},r.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchFilters.options.map(e=>this.renderOption(e)))))}renderOption(e){var t=this.props.searchFilters.selected===e.id,s=He("search-additional-criteria-popover__content__option",{checked:t});return r.a.createElement("li",{key:"search-additional-criteriaFilter:".concat(e.id),onClick:this.handleOptionClick.bind(this,e),className:"".concat(s," ").concat(e.id)},r.a.createElement("span",{className:"search-additional-criteria-popover__radio"}),e.name)}}var ws=je.PropTypes.shape({title:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.string.isRequired});Ps.propTypes={dispatch:je.PropTypes.func.isRequired,searchFilters:ws.isRequired};var Es=Ps=Object(m.b)(({searchFilters:e})=>({searchFilters:e}))(Ps),Cs=je.PropTypes.shape({title:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired,nameWithoutText:je.PropTypes.string.isRequired,help:je.PropTypes.string,invisible:je.PropTypes.bool})).isRequired,selected:je.PropTypes.array.isRequired});class Ss extends r.a.Component{render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--flags"},this.props.searchFlags.title),r.a.createElement("div",{className:"search-additional-criteria-popover__content"},r.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchFlags.options.map(e=>{var t=!!this.props.searchFlags.selected.find(t=>t===e.id);return r.a.createElement(Rs,{key:"search-additional-criteriaFlag:".concat(e.id),dispatch:this.props.dispatch,option:e,checked:t})}))))}}class Rs extends r.a.Component{handleOptionClick(){var e=this.props.checked?{type:"REMOVE_SEARCH_SELECTED_FLAG",flag:this.props.option.id}:Lt(this.props.option.id);this.props.dispatch(e),pt()}render(){var e=He("search-additional-criteria-popover__content__option",{checked:this.props.checked});return r.a.createElement("div",{className:"search-additional-criteria-popover__content__option-wrapper".concat(this.props.option.invisible?" is-visually-hidden":"")},r.a.createElement("li",{onClick:this.handleOptionClick.bind(this),className:e},r.a.createElement(jt,{checked:this.props.checked}),this.props.option.name),this.renderHelp())}renderHelp(){if(this.props.option.help&&""!==this.props.option.help)return r.a.createElement("div",{className:"search-additional-criteria-popover__content__option-help"},r.a.createElement(Ge.a,{className:"search-additional-criteria-popover__content__option-help-toggle",src:"/build/img/svg/icn-navbar-contact.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"search-additional-criteria-popover__content__option-help-content"},r.a.createElement("div",{className:"popover-arrow"}),this.props.option.help))}}Ss.propTypes={dispatch:je.PropTypes.func.isRequired,searchFlags:Cs.isRequired},Rs.propTypes={dispatch:je.PropTypes.func.isRequired,checked:je.PropTypes.bool.isRequired,option:je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired,nameWithoutText:je.PropTypes.string.isRequired,help:je.PropTypes.string,invisible:je.PropTypes.bool}).isRequired};var Ns=Ss=Object(m.b)(({searchFlags:e})=>({searchFlags:e}))(Ss);class ks extends r.a.Component{render(){var e=this.props.searchOptions.options;return r.a.createElement("div",{id:this.props.dropDownId,className:"select-dropdown__options jq-dropdown"},r.a.createElement("div",{className:"search-subtypes-popover__subtypes"},e.map(e=>this.renderSubOption(e))))}renderSubOption(e){return this.props.searchOptions.showEmptyChoice||"0"!==e.id?r.a.createElement(Ls,{key:"additionalCriteriaOption:".concat(e.id),option:e}):null}}class Ls extends r.a.Component{handleOptionClick(e){var t=e?Nt(this.props.option.id):Rt(this.props.option.id);this.props.dispatch(t),pt()}render(){var e=!!this.props.searchOptions.selected.find(e=>e===this.props.option.id),t=He("search-subtypes-popover__subtype",{checked:e});return r.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},r.a.createElement(jt,{checked:e}),this.props.option.name)}}var qs=je.PropTypes.shape({title:je.PropTypes.string.isRequired,actionTitle:je.PropTypes.string.isRequired,actionSelectAll:je.PropTypes.string.isRequired,actionUnselectAll:je.PropTypes.string.isRequired,multipleValueText:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.array.isRequired,showEmptyChoice:je.PropTypes.bool.isRequired});ks.propTypes={dispatch:je.PropTypes.func.isRequired,searchOptions:qs.isRequired,dropDownId:je.PropTypes.string},Ls.propTypes={dispatch:je.PropTypes.func.isRequired,searchOptions:qs.isRequired,option:je.PropTypes.object.isRequired},ks=Object(m.b)(({searchOptions:e})=>({searchOptions:e}))(ks),Ls=Object(m.b)(({searchOptions:e})=>({searchOptions:e}))(Ls);var Os=ks;class xs extends r.a.Component{render(){return r.a.createElement(r.a.Fragment,null,this.props.searchBar.isRental?this.renderRentalSection():this.renderSellSection())}renderSellSection(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOptions.title),r.a.createElement("div",{className:"select-dropdown"},r.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("characteristics-dropdown")},r.a.createElement("span",{className:"select-dropdown__placeholder"},this.renderLabel()),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),r.a.createElement(Os,{dropDownId:"characteristics-dropdown"})))}renderRentalSection(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOptions.title),r.a.createElement("div",{className:"search-additional-criteria-popover__content"},r.a.createElement("div",{className:"search-additional-criteria-popover__content__options"},this.props.searchOptions.options.map(e=>this.renderRentalOption(e)))))}renderRentalOption(e){return"0"===e.id?null:r.a.createElement(Ds,{key:"additionalCriteriaOption:".concat(e.id),option:e})}renderLabel(){var e=this.props.searchOptions.options,t=this.props.searchOptions.selected.map(e=>e),s=e.filter(e=>t.includes(e.id)),a=this.props.searchOptions.title;return s.length&&!Qe()&&(a=this.renderSelectedCountText(s)),a}renderSelectedCountText(e){var t=e.length>1?this.props.searchOptions.selectedCountText[1]:this.props.searchOptions.selectedCountText[0];return"".concat(e.length," ").concat(t)}}class Ds extends r.a.Component{handleOptionClick(e){var t=e?Nt(this.props.option.id):Rt(this.props.option.id);this.props.dispatch(t),pt()}render(){var e=!!this.props.searchOptions.selected.find(e=>e===this.props.option.id),t=He("search-additional-criteria-popover__content__option",{checked:e});return r.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},r.a.createElement(jt,{checked:e}),this.props.option.name)}}var Ms=je.PropTypes.shape({title:je.PropTypes.string.isRequired,actionTitle:je.PropTypes.string.isRequired,actionSelectAll:je.PropTypes.string.isRequired,actionUnselectAll:je.PropTypes.string.isRequired,multipleValueText:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({id:je.PropTypes.string.isRequired,name:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.array.isRequired,selectedCountText:je.PropTypes.array}),As=je.PropTypes.shape({isRental:je.PropTypes.boolean});xs.propTypes={dispatch:je.PropTypes.func.isRequired,searchOptions:Ms.isRequired,searchBar:As.isRequired},Ds.propTypes={dispatch:je.PropTypes.func.isRequired,searchOptions:Ms.isRequired,option:je.PropTypes.object.isRequired},xs=Object(m.b)(({searchOptions:e,searchBar:t})=>({searchOptions:e,searchBar:t}))(xs),Ds=Object(m.b)(({searchOptions:e})=>({searchOptions:e}))(Ds);var Is=xs;class Bs extends r.a.Component{handleOptionClick(e){setTimeout(()=>{this.props.dispatch(bt(e)),pt()})}renderPlaceholder(){var{searchBathrooms:e}=this.props,t=e.options.find(t=>t.value===e.selected);return Fe()?e.title:t.label}render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchBathrooms.title),r.a.createElement("div",{className:"select-dropdown"},r.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("bathrooms-dropdown")},r.a.createElement("span",{className:"select-dropdown__placeholder"},this.renderPlaceholder()),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:"search-bathrooms-popover jq-dropdown",id:"bathrooms-dropdown"},r.a.createElement("ul",{className:"search-bathrooms-popover__content__options"},this.props.searchBathrooms.options.map(e=>this.renderOption(e))))))}renderOption(e){var t=e.value===this.props.searchBathrooms.selected,s=He("search-bathrooms-popover__content__option",{checked:t});return r.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchBathRoomsPopoverOption:".concat(e.value),className:s},r.a.createElement("span",{className:"search-bathrooms-popover__radio"}),e.label)}}var Fs=je.PropTypes.shape({title:je.PropTypes.string.isRequired,titleSingle:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.string.isRequired});Bs.propTypes={dispatch:je.PropTypes.func.isRequired,searchBathrooms:Fs.isRequired};var js=Bs=Object(m.b)(({searchBathrooms:e})=>({searchBathrooms:e}))(Bs);var Vs=class{constructor(e){this.$elementCollection=e,this.$costsTable=d()(".mortgage-data__table.mortgage-data__table--costs"),this.$incomeTable=d()(".mortgage-data__table.mortgage-data__table--income"),this.$interestRate=this.$elementCollection.find("#interest"),this.$currencyFields={downPayement:this.$elementCollection.find("#downPayment"),loanAmount:this.$elementCollection.find("#price")},this.$data={monthlyMortgage:d()("#js-trigger-countup-Costs-2 .listing-mortgage-calculator__result__amount").attr("data-amount"),tableMonthlyMortgage:this.$costsTable.find(".mortgage-data__table__row__monthly-mortgage"),tableYearlyMortgage:this.$costsTable.find(".mortgage-data__table__row__yearly-mortgage"),tableMonthlyIncomeRows:this.$incomeTable.find(".mortgage-data__table__row__item--monthly-income"),tableMonthlyRows:this.$costsTable.find(".mortgage-data__table__row__item--monthly-costs"),tableMonthlyCostsTotal:this.$costsTable.find(".mortgage-data__table__row__item--monthly-costs-total"),tableYearlyCostsTotal:this.$costsTable.find(".mortgage-data__table__row__item--yearly-costs-total"),tableMonthlyIncomeTotal:this.$incomeTable.find(".mortgage-data__table__row__item--monthly-income-total"),tableYearlyIncomeTotal:this.$incomeTable.find(".mortgage-data__table__row__item--yearly-income-total")},this.originalLoanAmount=h.a.decodeValue(this.$currencyFields.loanAmount.val()),this.monthlyCostsRows=Array.from(this.$data.tableMonthlyRows).map(e=>e.innerText).map(e=>h.a.decodeValue(e)),this.monthlyIncomeRows=Array.from(this.$data.tableMonthlyIncomeRows).map(e=>e.innerText).map(e=>h.a.decodeValue(e)),this.validDownPayment=ge(h.a.decodeValue(this.$currencyFields.downPayement.val()),this.originalLoanAmount),this.componentDidMount()}componentDidMount(){this.update()}updateIncomeTable(e){var t=this.encodeCurrencyValueDisplay(e.monthlyTotalIncomeNet),s=this.encodeCurrencyValueDisplay(e.yearlyTotalIncomeNet);this.$data.tableMonthlyIncomeTotal.html(t),this.$data.tableYearlyIncomeTotal.html(s)}updateCostsTable(e){if(0!==e.monthlyMortgage&&this.validDownPayment){var t=this.encodeCurrencyValueDisplay(e.monthlyMortgage),s=this.encodeCurrencyValueDisplay(e.yearlyMortgage);this.$data.tableMonthlyMortgage.html(t),this.$data.tableYearlyMortgage.html(s)}else this.$data.tableMonthlyMortgage.html("—"),this.$data.tableYearlyMortgage.html("—");var a=this.encodeCurrencyValueDisplay(e.monthlyTotalCosts),i=this.encodeCurrencyValueDisplay(e.yearlyTotalCosts);this.$data.tableMonthlyCostsTotal.html(a),this.$data.tableYearlyCostsTotal.html(i)}updateMonthlyMortgage(e){0!==e.monthlyMortgage&&this.validDownPayment||(this.$data.tableMonthlyMortgage.html("—"),this.$data.tableYearlyMortgage.html("—"))}update(){var e=Object.assign({},h.a.decodeValues(this.$currencyFields),{interestRate:h.a.decodeFloat(this.$interestRate.val()),amortization:d()("#amortization .select-dropdown__option--selected").attr("data-value"),monthlyCostsRows:this.monthlyCostsRows,monthlyIncomeRows:this.monthlyIncomeRows});this.validDownPayment&&(e.loanAmount=this.originalLoanAmount-h.a.decodeValue(this.$currencyFields.downPayement.val())),e=pe(e),this.updateMonthlyMortgage(e),this.updateCostsTable(e),this.updateIncomeTable(e)}calculate(){this.$interestRate.removeClass("mortgage-data__form__input--error"),this.update()}encodeCurrencyValueDisplay(e){return h.a.encodeCurrencyValue(e,{noDecimal:!1})}};function Us(){return(Us=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class $s extends r.a.Component{handleSelect(e){this.props.onSelect(e),"amortization"===this.props.dropdownId&&setTimeout(()=>{new Vs(d()(".listing-mortgage-calculator__content")).calculate(d()(".mortgage-data__table__row__monthly-mortgage"))})}render(){return r.a.createElement("div",{className:"select-dropdown"},this.renderLabel(),this.renderPopover())}renderLabel(){var e=this.props.options.find(e=>e.value===this.props.selected),t=!!this.props.isDisabled,s=He("select-dropdown__label",{disabled:t}),a={};return t||(a["data-jq-dropdown"]="#".concat(this.props.dropdownId)),r.a.createElement("div",Us({className:s},a),e&&!Qe()?this.renderSelectedValue(e):this.renderPlaceHolder(),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderSelectedValue(e){return r.a.createElement("span",{className:"select-dropdown__selected-value"},e.label)}renderPlaceHolder(){return r.a.createElement("span",{className:"select-dropdown__placeholder"},this.props.placeholder)}renderPopover(){return r.a.createElement("div",{id:this.props.dropdownId,className:"select-dropdown__options jq-dropdown"},this.props.options.map(e=>this.renderOption(e)))}renderOption(e){var t=this.props.selected===e.value,s=He("select-dropdown__option",{selected:t});return r.a.createElement("div",{key:e.value,className:s,"data-value":e.value,onClick:this.handleSelect.bind(this,e)},e.label)}}$s.propTypes={onSelect:je.PropTypes.func.isRequired,dropdownId:je.PropTypes.string.isRequired,selected:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number]),isDisabled:je.PropTypes.bool,placeholder:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number]),options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number])})).isRequired};var Gs=$s;class Hs extends r.a.Component{handleOptionChange(e){setTimeout(()=>{this.props.dispatch(vt(e.value)),pt(),window.Dropdown("hide")})}handleOptionClick(e){setTimeout(()=>{this.props.dispatch(vt(e)),pt()})}render(){return r.a.createElement(r.a.Fragment,null,this.props.searchBar.isRental?this.renderRentalSection():this.renderSellSection())}renderSellSection(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOnlineSince.title),r.a.createElement(Gs,{dropdownId:"online-since-dropdown",options:this.props.searchOnlineSince.options,placeholder:this.props.searchOnlineSince.title,selected:this.props.searchOnlineSince.selected,onSelect:this.handleOptionChange.bind(this)}))}renderRentalSection(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOnlineSince.title),r.a.createElement("div",{className:"search-additional-criteria-popover__content"},r.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchOnlineSince.options.map(e=>this.renderRentalOption(e)))))}renderRentalOption(e){var t=e.value===this.props.searchOnlineSince.selected,s=He("search-additional-criteria-popover__content__option",{checked:t});return r.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchAdditionalCriteriaOption:".concat(e.value),className:s},r.a.createElement("span",{className:"search-additional-criteria-popover__radio"}),e.label)}}var zs=je.PropTypes.shape({title:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.number.isRequired,label:je.PropTypes.string.isRequired})).isRequired,selected:je.PropTypes.number.isRequired}),Ws=je.PropTypes.shape({isRental:je.PropTypes.boolean});Hs.propTypes={dispatch:je.PropTypes.func.isRequired,searchOnlineSince:zs.isRequired,searchBar:Ws.isRequired};var Ks=Hs=Object(m.b)(({searchOnlineSince:e,searchBar:t})=>({searchOnlineSince:e,searchBar:t}))(Hs);class Ys extends r.a.Component{handleUnitClick(e){this.props.dispatch((e=>({type:"SET_SEARCH_SELECTED_LAND_AREA_UNIT",unit:e}))(e)),this.props.dispatch(xt("")),this.props.dispatch(Dt("")),this.props.dispatch(Mt("~")),this.props.dispatch(At("")),this.props.dispatch(It("")),this.props.dispatch(Bt("~"))}render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section search-additional-criteria-popover__section--land-area"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--land-area"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__label"},this.props.searchLandArea.title),this.renderActions()))}renderActions(){var e=He("search-additional-criteria-popover__actions__unit",{selected:"foot"===this.props.searchLandArea.selectedUnit}),t=He("search-additional-criteria-popover__actions__unit",{selected:"meter"===this.props.searchLandArea.selectedUnit});return r.a.createElement("div",{className:"search-additional-criteria-popover__actions"},r.a.createElement("span",{className:"search-additional-criteria-popover__actions__units"},r.a.createElement("span",{className:e,onClick:this.handleUnitClick.bind(this,"foot")},this.props.searchLandArea.footTitle),r.a.createElement("span",{className:t,onClick:this.handleUnitClick.bind(this,"meter")},this.props.searchLandArea.meterTitle)))}}var Xs=je.PropTypes.shape({title:je.PropTypes.string.isRequired,meterTitle:je.PropTypes.string.isRequired,footTitle:je.PropTypes.string.isRequired,selectedUnit:je.PropTypes.string.isRequired,selected:je.PropTypes.string.isRequired});Ys.propTypes={dispatch:je.PropTypes.func.isRequired,searchLandArea:Xs.isRequired};var Zs=Ys=Object(m.b)(({searchSelectedLandAreaUnit:e,searchLandArea:t,setSearchSelectedLotSizeMinimum:s,setSearchSelectedLotSizeMaximum:a,setSearchSelectedLotSize:i})=>({selectedLandAreaUnit:e,searchLandArea:t,setSearchSelectedLotSizeMinimum:s,setSearchSelectedLotSizeMaximum:a,setSearchSelectedLotSize:i}))(Ys);function Js(){return(Js=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}var Qs=/\D/;class ea extends r.a.Component{constructor(e){super(e),this.state={inputOption:{label:this.props.options[0].label,value:this.props.options[0].value},inputTextCleaned:""},this.handleChange=this.handleChange.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}handleSelect(e,t){t||(this.props.onSelect(e),this.setState({inputTextCleaned:"",inputOption:{label:"",value:""}}))}handleChange(e){var t=e.target.value.replace(Qs,"").trim(),s=Number(t),a={label:this.props.options[0].label,value:this.props.options[0].value};if("undefined"!==s&&Number.isInteger(s)){var i=this.handleInvertedMinimumValue(this.props.selectedMinimum,s);!this.handleInvertedMaximumValue(this.props.selectedMaximum,s)&&!i&&s<99999999&&(a={label:t,value:t},this.setState({inputTextCleaned:""})),this.setState({inputOption:a}),this.setState({inputTextCleaned:t})}}handleInvertedMinimumValue(e,t){return void 0!==e&&""!==e&&e>=t}handleInvertedMaximumValue(e,t){return void 0!==e&&""!==e&&e<=t}handleBlur(){""!==this.state.inputOption.value&&this.state.inputOption.value!==this.props.selected&&this.props.onSelect(this.state.inputOption)}handleKeyDown(e){13===e.keyCode&&this.props.onSelect(this.state.inputOption)}render(){return r.a.createElement("div",{className:"select-dropdown"},this.renderMobileLabel(),this.renderLabel(),this.renderPopover())}renderMobileLabel(){var e=void 0!==this.props.mobileMinimumLabel,t=void 0!==this.props.mobileMaximumLabel;if(e||t)return null;var s=e?this.props.mobileMinimumLabel:this.props.mobileMaximumLabel;return r.a.createElement("div",{className:"select-dropdown__label--mobile"},s)}renderLabel(){var e=""===this.props.selected||void 0===this.props.selected?{label:this.props.options[0].label,value:this.props.options[0].value}:{label:h.a.formatNumbers(this.props.selected),value:this.props.selected},t=!!this.props.isDisabled,s=He("select-dropdown__label",{disabled:t}),a={};return t||(a["data-jq-dropdown-children"]="#".concat(this.props.dropdownId)),r.a.createElement("div",Js({className:s},a),e?this.renderSelectedValue(e):this.renderPlaceHolder(),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderSelectedValue(e){return r.a.createElement("span",{className:"select-dropdown__selected-value"},e.label)}renderPlaceHolder(){return r.a.createElement("span",{className:"select-dropdown__placeholder"},this.props.placeholder)}renderPopover(){return r.a.createElement("div",{id:this.props.dropdownId,className:"select-dropdown__options jq-dropdown-children"},this.renderInput(),this.props.options.map(e=>this.renderOption(e)))}renderOption(e){var t=this.props.selected===e.value,s=""!==e.value&&(""!==this.props.selectedMaximum&&Number(e.value)>=Number(this.props.selectedMaximum)||""!==this.props.selectedMinimum&&Number(e.value)<=Number(this.props.selectedMinimum)),a=He("select-dropdown__option",{selected:t,disabled:s});return r.a.createElement("div",{key:e.value,className:a,onClick:this.handleSelect.bind(this,e,s)},e.label)}renderInput(){if(this.props.inputAvailable)return r.a.createElement("input",{type:"text",value:this.state.inputTextCleaned,className:"select-dropdown__input",onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown})}}ea.propTypes={onSelect:je.PropTypes.func.isRequired,dropdownId:je.PropTypes.string.isRequired,selected:je.PropTypes.string,selectedMinimum:je.PropTypes.string,selectedMaximum:je.PropTypes.string,isDisabled:je.PropTypes.bool,placeholder:je.PropTypes.string,inputAvailable:je.PropTypes.bool,mobileMinimumLabel:je.PropTypes.string,mobileMaximumLabel:je.PropTypes.string,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string})).isRequired};var ta=ea;class sa extends r.a.Component{constructor(e){super(e),this.selectMinimum=this.handleSelectMinimum.bind(this),this.selectMaximum=this.handleSelectMaximum.bind(this)}handleSelectMinimum(e){setTimeout(()=>{this.props.dispatch(xt(e.value));var t="".concat(this.props.searchLotSize.selectedMinimum,"~").concat(this.props.searchLotSize.selectedMaximum);this.props.dispatch(Mt(t)),pt(),window.DropdownChildren("hide")})}handleSelectMaximum(e){setTimeout(()=>{this.props.dispatch(Dt(e.value));var t="".concat(this.props.searchLotSize.selectedMinimum,"~").concat(this.props.searchLotSize.selectedMaximum);this.props.dispatch(Mt(t)),pt(),window.DropdownChildren("hide")})}isInFeet(){return"foot"===this.props.searchLotSize.selectedUnit}render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section search-lot-size"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit()}}),r.a.createElement(ta,{dropdownId:"lot-size-minimum-dropdown",placeholder:this.props.searchLotSize.defaultMinimumValue,options:this.handleUnitMinimumOption(),selected:this.props.searchLotSize.selectedMinimum,selectedMaximum:this.props.searchLotSize.selectedMaximum,inputAvailable:!0,onSelect:this.selectMinimum,mobileMinimumLabel:this.props.searchLotSize.mobileMinimumLabel}),r.a.createElement(ta,{dropdownId:"lot-size-maximum-dropdown",placeholder:this.props.searchLotSize.defaultMaximumValue,options:this.handleUnitMaximumOption(),selected:this.props.searchLotSize.selectedMaximum,selectedMinimum:this.props.searchLotSize.selectedMinimum,inputAvailable:!0,onSelect:this.selectMaximum,mobileMaximumLabel:this.props.searchLotSize.mobileMaximumLabel}))}handleUnitMinimumOption(){return this.isInFeet()?this.props.searchLotSize.optionsMinimumFooter:this.props.searchLotSize.optionsMinimumMeter}handleUnitMaximumOption(){return this.isInFeet()?this.props.searchLotSize.optionsMaximumFooter:this.props.searchLotSize.optionsMaximumMeter}handleTitleBasedOnUnit(){var e=this.isInFeet()?this.props.searchLotSize.titleUnit.footer:this.props.searchLotSize.titleUnit.meter;return"".concat(this.props.searchLotSize.title," <span>").concat(e,"</span>")}}var aa=je.PropTypes.shape({title:je.PropTypes.string.isRequired,titleUnit:je.PropTypes.object.isRequired,optionsMinimumFooter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMinimumMeter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMaximumFooter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMaximumMeter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,selectedUnit:je.PropTypes.string.isRequired,selectedMinimum:je.PropTypes.string,selectedMaximum:je.PropTypes.string,defaultMinimumValue:je.PropTypes.string.isRequired,defaultMaximumValue:je.PropTypes.string.isRequired});sa.propTypes={dispatch:je.PropTypes.func.isRequired,searchLotSize:aa.isRequired};var ia=sa=Object(m.b)(({searchSelectedLotSize:e,setSearchSelectedLotSizeMinimum:t,setSearchSelectedLotSizeMaximum:s,searchLotSize:a})=>({selectedLotSize:e,setSearchSelectedLotSizeMinimum:t,setSearchSelectedLotSizeMaximum:s,searchLotSize:a}))(sa);class ra extends r.a.Component{constructor(e){super(e),this.selectMinimum=this.handleSelectMinimum.bind(this),this.selectMaximum=this.handleSelectMaximum.bind(this)}handleSelectMinimum(e){setTimeout(()=>{this.props.dispatch(At(e.value));var t="".concat(this.props.searchLivingArea.selectedMinimum,"~").concat(this.props.searchLivingArea.selectedMaximum);this.props.dispatch(Bt(t)),pt(),window.DropdownChildren("hide")})}handleSelectMaximum(e){setTimeout(()=>{this.props.dispatch(It(e.value));var t="".concat(this.props.searchLivingArea.selectedMinimum,"~").concat(this.props.searchLivingArea.selectedMaximum);this.props.dispatch(Bt(t)),pt(),window.DropdownChildren("hide")})}isInFeet(){return"foot"===this.props.searchLivingArea.selectedUnit}render(){return r.a.createElement("div",{className:"search-additional-criteria-popover__section search-living-area"},r.a.createElement("div",{className:"search-additional-criteria-popover__section__title",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit()}}),r.a.createElement(ta,{dropdownId:"living-area-minimum-dropdown",placeholder:this.props.searchLivingArea.defaultMinimumValue,options:this.handleUnitMinimumOption(),selected:this.props.searchLivingArea.selectedMinimum,selectedMaximum:this.props.searchLivingArea.selectedMaximum,inputAvailable:!0,onSelect:this.selectMinimum,mobileMinimumLabel:this.props.searchLivingArea.mobileMinimumLabel}),r.a.createElement(ta,{dropdownId:"living-area-maximum-dropdown",placeholder:this.props.searchLivingArea.defaultMaximumValue,options:this.handleUnitMaximumOption(),selected:this.props.searchLivingArea.selectedMaximum,selectedMinimum:this.props.searchLivingArea.selectedMinimum,inputAvailable:!0,onSelect:this.selectMaximum,mobileMaximumLabel:this.props.searchLivingArea.mobileMaximumLabel}))}handleUnitMinimumOption(){return this.isInFeet()?this.props.searchLivingArea.optionsMinimumFooter:this.props.searchLivingArea.optionsMinimumMeter}handleUnitMaximumOption(){return this.isInFeet()?this.props.searchLivingArea.optionsMaximumFooter:this.props.searchLivingArea.optionsMaximumMeter}handleTitleBasedOnUnit(){var e=this.isInFeet()?this.props.searchLivingArea.titleUnit.footer:this.props.searchLivingArea.titleUnit.meter;return"".concat(this.props.searchLivingArea.title," <span>").concat(e,"</span>")}}var na=je.PropTypes.shape({title:je.PropTypes.string.isRequired,titleUnit:je.PropTypes.object.isRequired,optionsMinimumFooter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMinimumMeter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMaximumFooter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,optionsMaximumMeter:je.PropTypes.arrayOf(je.PropTypes.shape({value:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired})).isRequired,selectedUnit:je.PropTypes.string.isRequired,selectedMinimum:je.PropTypes.string,selectedMaximum:je.PropTypes.string,defaultMinimumValue:je.PropTypes.string.isRequired,defaultMaximumValue:je.PropTypes.string.isRequired});ra.propTypes={dispatch:je.PropTypes.func.isRequired,searchLivingArea:na.isRequired};var oa=ra=Object(m.b)(({searchSelectedLivingArea:e,setSearchSelectedLivingAreaMinimum:t,setSearchSelectedLivingAreaMaximum:s,searchLivingArea:a})=>({selectedLivingArea:e,setSearchSelectedLivingAreaMinimum:t,setSearchSelectedLivingAreaMaximum:s,searchLivingArea:a}))(ra);class la extends r.a.Component{constructor(e){super(e),this.state={filterClick:!1,layoutClassName:Fe()?"mobile":"desktop"},this.windowResize=this.handleWindowResize.bind(this)}componentDidMount(){window.addEventListener("viewport-size-change",this.windowResize)}componentWillUnmount(){window.removeEventListener("viewport-size-change",this.windowResize)}handleWindowResize(){this.setState({layoutClassName:Fe()?"mobile":"desktop"})}handleButtonClick(){this.props.dispatch(qt("1")),this.props.dispatch(Ot()),this.setState({filterClick:!0}),Se.a.pushDynamicEvent("apply-filter-button-click",window.DP.context.pageType)}render(){var e=He("search-additional-criteria-popover",{rental:this.props.searchBar.isRental,sell:!this.props.searchBar.isRental}),t=He("search-additional-criteria-popover__column",{desktop:"desktop"===this.state.layoutClassName,mobile:"mobile"===this.state.layoutClassName});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"search-additional-criteria-popover__columns"},this.renderFirstColumn(),r.a.createElement("div",{className:"".concat(t," search-additional-criteria-popover__column--last")},r.a.createElement(Es,null),this.props.searchBar.isRental?r.a.createElement(Ks,null):null,r.a.createElement(Ns,null),this.renderButton())))}renderButton(){return this.props.searchBar.isRental?null:this.props.searchBar.submitting&&this.state.filterClick?r.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter search-bar__input-wrapper__button--loading"},r.a.createElement(ze,null)):this.props.searchBar.enabled?r.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter",onClick:this.handleButtonClick.bind(this)},this.props.searchBar.filter):r.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter search-bar__input-wrapper__button--inactive"},this.props.searchBar.filter)}renderFirstColumn(){return"desktop"===this.state.layoutClassName&&this.renderDesktopFirstColumn()||this.renderMobileFirstColumn()}renderMobileFirstColumn(){return r.a.createElement("div",{className:"search-additional-criteria-popover__column search-additional-criteria-popover__column--mobile search-additional-criteria-popover__column--first"},this.props.searchBar.isRental?null:r.a.createElement(js,null),r.a.createElement(Is,null),this.renderMobileLivingAreaDropdown(),this.renderMobileLotSizeDropdown(),this.props.searchBar.isRental?null:r.a.createElement(Ks,null),this.props.disabledFields.includes("land_area")?null:r.a.createElement(Zs,null))}renderMobileLotSizeDropdown(){return this.props.disabledFields.includes("land_area")||this.props.searchBar.isRental?null:r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"select-dropdown"},r.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("lot-size-dropdown")},r.a.createElement("span",{className:"select-dropdown__placeholder",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit(this.props.lotSizeLabel)}}),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),r.a.createElement("div",{id:"lot-size-dropdown",className:"select-dropdown__options jq-dropdown"},r.a.createElement(ia,null))))}renderMobileLivingAreaDropdown(){return this.props.searchBar.isRental?null:r.a.createElement("div",{className:"search-additional-criteria-popover__section"},r.a.createElement("div",{className:"select-dropdown"},r.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("living-area-dropdown")},r.a.createElement("span",{className:"select-dropdown__placeholder",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit(this.props.livingAreaLabel)}}),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),r.a.createElement("div",{id:"living-area-dropdown",className:"select-dropdown__options jq-dropdown"},r.a.createElement(oa,null))))}renderDesktopFirstColumn(){return r.a.createElement("div",{className:"search-additional-criteria-popover__column search-additional-criteria-popover__column--desktop search-additional-criteria-popover__column--first"},r.a.createElement(Is,null),this.props.searchBar.isRental?null:r.a.createElement(js,null),this.props.searchBar.isRental?null:r.a.createElement(oa,null),this.props.disabledFields.includes("land_area")?null:r.a.createElement(ia,null),this.props.searchBar.isRental?null:r.a.createElement(Ks,null),this.props.disabledFields.includes("land_area")?null:r.a.createElement(Zs,null))}handleTitleBasedOnUnit(e){var t="foot"===this.props.selectedUnit?this.props.titleUnit.footer:this.props.titleUnit.meter;return"".concat(e,"&nbsp;<span>").concat(t,"</span>")}}la.propTypes={disabledFields:je.PropTypes.array.isRequired,lotSizeLabel:je.PropTypes.string.isRequired,selectedUnit:je.PropTypes.string.isRequired,titleUnit:je.PropTypes.object.isRequired,livingAreaLabel:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired,searchBar:je.PropTypes.shape({submitting:je.PropTypes.boolean,enabled:je.PropTypes.boolean,filter:je.PropTypes.string.isRequired,isRental:je.PropTypes.boolean}).isRequired};var ca=la=Object(m.b)(({searchBar:e})=>({searchBar:e}))(la);class pa extends r.a.Component{constructor(e){super(e),this.state={showPopover:(!Fe()||!this.props.searchBar.isRental)&&Fe()},this.gtmClassName=this.fetchGtmClassName()}handleTogglePopover(){Fe()?this.props.searchBar.isRental?this.setState({showPopover:!this.state.showPopover}):this.setState({showPopover:!0}):this.setState({showPopover:!this.state.showPopover})}handleWindowResize(){window.innerWidth<=window.DP.breakpoints.regular&&!this.props.searchBar.isRental&&this.setState({showPopover:!0})}fetchGtmClassName(){return Fe()?"gtm-search-link-more-criterias-mob":"gtm-search-link-more-criterias"}render(){var e=He("search-additional-criteria",{rental:this.props.searchBar.isRental});return r.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=He("search-bar__options-button",{"additional-criteria":!0,active:this.state.showPopover}),t=He("search-bar__options-button__arrow",{active:this.state.showPopover}),s="search-bar__options-button__label search-bar__options-button__label--additional-criteria ".concat(this.props.moreCriteriaPush);return t="".concat(t," is-no-events ").concat(this.props.moreCriteriaPush),r.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:"".concat(e," ").concat(this.gtmClassName)},r.a.createElement("span",{className:s},this.props.searchAdditionalCriteria.title),r.a.createElement(Ge.a,{className:t,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?r.a.createElement(Kt,{onOuterClick:this.handleTogglePopover.bind(this)},r.a.createElement("div",{ref:"root"},r.a.createElement(ca,{title:this.props.searchAdditionalCriteria.title,disabledFields:this.props.disabledFields,lotSizeLabel:this.props.lotSizeLabel,selectedUnit:this.props.selectedUnit,titleUnit:this.props.titleUnit,livingAreaLabel:this.props.livingAreaLabel}))):null}}pa.propTypes={moreCriteriaPush:je.PropTypes.string,disabledFields:je.PropTypes.array.isRequired,lotSizeLabel:je.PropTypes.string.isRequired,selectedUnit:je.PropTypes.string.isRequired,titleUnit:je.PropTypes.object.isRequired,livingAreaLabel:je.PropTypes.string.isRequired,searchAdditionalCriteria:je.PropTypes.shape({title:je.PropTypes.string.isRequired,smallTitle:je.PropTypes.string.isRequired}).isRequired,searchBar:je.PropTypes.shape({isRental:je.PropTypes.boolean}).isRequired};var da=pa=Object(m.b)(({searchAdditionalCriteria:e,searchBar:t})=>({searchAdditionalCriteria:e,searchBar:t}))(pa);class ha extends r.a.Component{handleReset(){confirm(this.props.searchBar.resetConfirmAlert)?(this.props.dispatch(xt("")),this.props.dispatch(Dt("")),this.props.dispatch(At("")),this.props.dispatch(It("")),this.props.dispatch({type:"RESET_SEARCH_BAR"}),pt(),this.handleGtmPushOnClick(),this.props.onHandleButtonClick()):this.handleGtmPushOnClick()}handleGtmPushOnClick(){"purplebricks"===window.DP.theme&&Qe()&&Se.a.pushDynamicEvent("header-reset-button-mobile","".concat(window.DP.context.pageType,"_Mobile"))}render(){return r.a.createElement("button",{className:"search-bar__button search-bar__reset-button",onClick:this.handleReset.bind(this)},this.props.searchBar.resetButton)}}ha.propTypes={onHandleButtonClick:je.PropTypes.func.isRequired,dispatch:je.PropTypes.func.isRequired,searchBar:je.PropTypes.shape({resetButton:je.PropTypes.string.isRequired,resetConfirmAlert:je.PropTypes.string.isRequired}).isRequired};var ua=ha=Object(m.b)(({searchBar:e})=>({searchBar:e}))(ha);class ma extends r.a.Component{constructor(e){super(e);var t=window.DP.store.getState(),s=dt(t,ht(!1,t));delete s.position,delete s.zoom,this.activeCriteria=JSON.stringify(s)}handleApplyChanges(){this.props.onHandleButtonClick()}isModifiedCriteria(){var e=window.DP.store.getState(),t=dt(e,ht(!1,e));delete t.position,delete t.zoom;var s=JSON.stringify(t);return this.activeCriteria!==s&&(window.location.pathname.indexOf("search")>-1||window.location.pathname.indexOf("recherche")>-1)}render(){var e="modified_criteria";return this.isModifiedCriteria()&&!this.props.searchClick||(e+=" modified_criteria--hidden"),r.a.createElement("div",{className:e},this.props.searchBar.searchModifiedCriteria.oneOrMoreCriteriaChange,r.a.createElement("button",{className:"search-bar__input-wrapper__button",onClick:this.handleApplyChanges.bind(this)},this.props.searchBar.searchModifiedCriteria.applyChanges))}}ma.propTypes={searchClick:je.PropTypes.bool.isRequired,onHandleButtonClick:je.PropTypes.func.isRequired,dispatch:je.PropTypes.func.isRequired,searchBar:je.PropTypes.shape({resetButton:je.PropTypes.string.isRequired,resetConfirmAlert:je.PropTypes.string.isRequired,searchModifiedCriteria:je.PropTypes.shape({oneOrMoreCriteriaChange:je.PropTypes.string.isRequired,applyChanges:je.PropTypes.string.isRequired}).isRequired}).isRequired};var ga=ma=Object(m.b)(({searchBar:e})=>({searchBar:e}))(ma);class _a extends r.a.Component{handleToggle(){this.props.searchBar.tagsCollapsed?this.props.dispatch({type:"EXPAND_TAGS"}):this.props.dispatch({type:"COLLAPSE_TAGS"})}displayContentBasedOnContext(){return"tags"===this.props.context?this.displayTagButtonContent():this.displayLeftButtonContent()}displayTagButtonContent(){return r.a.createElement("div",null,r.a.createElement("div",{className:"search-bar__button-show-extra-tags__name"},"..."),r.a.createElement("div",{className:"search-bar__button-show-extra-tags__remove-button"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})))}displayLeftButtonContent(){var e=He("search-bar__button-show-extra-tags__arrow",{active:!this.props.searchBar.tagsCollapsed});return r.a.createElement(Ge.a,{className:e,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})}render(){if(this.props.totalTagsCount<=tt())return null;var e=He("search-bar__button-show-extra-tags",{left:"left"===this.props.context,tags:"tags"===this.props.context});return r.a.createElement("button",{className:e,onClick:this.handleToggle.bind(this)},this.displayContentBasedOnContext())}}_a.propTypes={totalTagsCount:je.PropTypes.number,context:je.PropTypes.string,dispatch:je.PropTypes.func.isRequired,searchBar:je.PropTypes.shape({tagsCollapsed:je.PropTypes.boolean}).isRequired};var ba=_a=Object(m.b)(({searchBar:e})=>({searchBar:e}))(_a),va=(e,t)=>{for(var s,a,i,r,n,o,l=e.replace(/</g,"\n<").replace(/>/g,">\n").replace(/\n\n/g,"\n").replace(/^\n/g,"").replace(/\n$/g,"").split("\n"),c=[],p=0,d=!1,h=0;h<l.length;h++)if(s=(a=l[h]).replace(/[ ]+/g," "),a.length){if("<"!==a[0])if(p>=t)a="";else if(p+s.length>=t){if(" "===a[(i=t-p)-1])for(;i&&" "===a[(i-=1)-1];);else-1!==(r=a.substring(i).split("").indexOf(" "))?i+=r:i=a.length;a="".concat(a.substring(0,i),"…"),p=t,d=!0}else p+=s.length;else if(p>=t)if(o=(n=a.match(/[a-zA-Z]+/))?n[0]:"")if("</"!==a.substring(0,2))c.push(o),a="";else{for(;c[c.length-1]!==o&&c.length;)c.pop();c.length&&(a=""),c.pop()}else a="";l[h]=a}return{html:l.join("\n").replace(/\n/g,""),more:d}},ya=e=>e.replace(/<\/?[^>]+(>|$)/g,""),fa=e=>{var t="";if("fr"===document.getElementsByTagName("html")[0].getAttribute("lang")){var s=e.toString().split(",");t="".concat(s[0],"<sup>").concat(s[1],"$</sup>")}else{var a=e.toString().split(".");t="$".concat(a[0],"<sup>").concat(a[1],"</sup>")}return t};class Ta extends r.a.Component{handleTermDelete(e){setTimeout(()=>{this.props.dispatch(mt(e)),this.props.dispatch({type:"ENABLE_SEARCH"}),pt()})}render(){var{term:e}=this.props,t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return r.a.createElement("div",{className:s.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},ya(e.name)),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTermDelete.bind(this,e)},"×"))}}Ta.propTypes={term:je.PropTypes.object.isRequired,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Pa=Ta=Object(m.b)()(Ta);class wa extends r.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(_t("0")),pt()})}render(){var{searchRooms:e}=this.props;if("0"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t),a=e.options.find(t=>t.value===e.selected),i="1~1"!==a.value?e.title:e.titleSingle;return r.a.createElement("div",{className:s.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},a.label," ",i.toLowerCase()),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"×"))}}wa.propTypes={searchRooms:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Ea=wa=Object(m.b)(({searchRooms:e})=>({searchRooms:e}))(wa);class Ca extends r.a.Component{handleTypeDelete(e){this.props.searchSubTypes&&setTimeout(()=>{this.props.searchSubTypes.selected.map(t=>t.typeId===e?this.props.dispatch(Et(t)):null),this.props.dispatch(Tt(e)),pt()})}render(){var{searchSubTypes:e,optionType:t}=this.props,s=ls(e.options,t.id);if(ls(e.selected,t.id)!==s)return null;var a=this.props.extraClassNames?this.props.extraClassNames:[],i=["search-terms-item"].concat(a);return r.a.createElement("div",{className:i.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},t.name),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,t.id)},"×"))}}Ca.propTypes={searchSubTypes:je.PropTypes.object,optionType:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Sa=Ca=Object(m.b)(({searchSubTypes:e})=>({searchSubTypes:e}))(Ca);class Ra extends r.a.Component{handleSubTypeDelete(e){setTimeout(()=>{this.props.dispatch(Et(e)),this.props.dispatch(wt(e.typeId)),pt()})}render(){var{searchSubTypes:e,selectedSubType:t}=this.props,s=ls(e.options,t.typeId),a=ls(e.selected,t.typeId);if(0!==a&&a===s)return null;var i=this.props.extraClassNames?this.props.extraClassNames:[],n=["search-terms-item"].concat(i);return r.a.createElement("div",{className:n.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},t.name),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleSubTypeDelete.bind(this,t)},"×"))}}Ra.propTypes={searchSubTypes:je.PropTypes.object,selectedSubType:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Na=Ra=Object(m.b)(({searchSubTypes:e})=>({searchSubTypes:e}))(Ra);class ka extends r.a.Component{handlePriceRangeReset(){setTimeout(()=>{this.props.dispatch(yt(null)),this.props.dispatch(ft(null)),pt()})}buildPriceRangeString(e){var t=null===e.selected[0]?"".concat(e.minimumToggleLabel," ").concat(e.noMinimumLabel):h.a.encodeCurrencyValue(e.selected[0].value,{noDecimal:!0});return t+=" — ",t+=null===e.selected[1]?e.maximumToggleLabel:h.a.encodeCurrencyValue(e.selected[1].value,{noDecimal:!0})}render(){var{searchPriceRange:e}=this.props;if(!e.selected[0]&&!e.selected[1])return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return r.a.createElement("div",{className:s.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},this.buildPriceRangeString(e)),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handlePriceRangeReset.bind(this)},"×"))}}ka.propTypes={searchPriceRange:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var La=ka=Object(m.b)(({searchPriceRange:e})=>({searchPriceRange:e}))(ka);class qa extends r.a.Component{handleTypeDelete(e){setTimeout(()=>{this.props.dispatch(Nt(e)),pt()})}render(){var{searchOptions:e}=this.props,t=e.options.find(e=>e.id===this.props.selectedOption);if(!e.selected.length||"0"===t.id)return null;var s=this.props.extraClassNames?this.props.extraClassNames:[],a=["search-terms-item"].concat(s);return r.a.createElement("div",{className:a.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},t.name),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,t.id)},"×"))}}qa.propTypes={searchOptions:je.PropTypes.object,selectedOption:je.PropTypes.string,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Oa=qa=Object(m.b)(({searchOptions:e})=>({searchOptions:e}))(qa);class xa extends r.a.Component{handleLotSizeReset(){setTimeout(()=>{this.props.dispatch(xt("")),this.props.dispatch(Dt("")),this.props.dispatch(Mt("~")),pt()})}renderLotSize(){var{searchLotSize:e}=this.props,t=e.label.tag,s=e.label.minimumOf,a=e.label.maximumOf,i="",r="",n=e.optionsMinimumMeter,o=e.optionsMaximumMeter,l=e.meterTitle;"foot"===e.selectedUnit&&(n=e.optionsMinimumFooter,o=e.optionsMaximumFooter,l=e.footTitle);var c=this.renderMinimumSelection(n),p=this.renderMaximumSelection(o);return c!==p&&(r=p===o[0].label?"".concat(s," ").concat(c):c===n[0].label?"".concat(a," ").concat(p):"".concat(c," - ").concat(p),i="".concat(r," ").concat(l," ").concat(t)),i}renderMinimumSelection(e){var{searchLotSize:t}=this.props;return t.selectedMinimum!==t.selectedMaximum&&""!==t.selectedMinimum&&void 0!==t.selectedMinimum&&"undefined"!==t.selectedMinimum?h.a.formatNumbers(t.selectedMinimum):e[0].label}renderMaximumSelection(e){var{searchLotSize:t}=this.props;return t.selectedMaximum!==t.selectedMinimum&&""!==t.selectedMaximum&&void 0!==t.selectedMaximum&&"undefined"!==t.selectedMaximum?h.a.formatNumbers(t.selectedMaximum):e[0].label}render(){var{searchLotSize:e}=this.props;if("~"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return r.a.createElement("div",{className:s.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},this.renderLotSize()),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleLotSizeReset.bind(this)},"×"))}}xa.propTypes={searchLotSize:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Da=xa=Object(m.b)(({searchLotSize:e})=>({searchLotSize:e}))(xa);class Ma extends r.a.Component{handleLivingAreaReset(){setTimeout(()=>{this.props.dispatch(At("")),this.props.dispatch(It("")),this.props.dispatch(Bt("~")),pt()})}renderLivingArea(){var{searchLivingArea:e}=this.props,t=e.label.tag,s=e.label.minimumOf,a=e.label.maximumOf,i="",r="",n=e.optionsMinimumMeter,o=e.optionsMaximumMeter,l=e.meterTitle;"foot"===e.selectedUnit&&(n=e.optionsMinimumFooter,o=e.optionsMaximumFooter,l=e.footTitle);var c=this.renderMinimumSelection(n),p=this.renderMaximumSelection(o);return c!==p&&(r=p===o[0].label?"".concat(s," ").concat(c):c===n[0].label?"".concat(a," ").concat(p):"".concat(c," - ").concat(p),i="".concat(r," ").concat(l," ").concat(t)),i}renderMinimumSelection(e){var{searchLivingArea:t}=this.props;return t.selectedMinimum!==t.selectedMaximum&&""!==t.selectedMinimum&&void 0!==t.selectedMinimum&&"undefined"!==t.selectedMinimum?h.a.formatNumbers(t.selectedMinimum):e[0].label}renderMaximumSelection(e){var{searchLivingArea:t}=this.props;return t.selectedMaximum!==t.selectedMinimum&&""!==t.selectedMaximum&&void 0!==t.selectedMaximum&&"undefined"!==t.selectedMaximum?h.a.formatNumbers(t.selectedMaximum):e[0].label}render(){var{searchLivingArea:e}=this.props;if("~"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return r.a.createElement("div",{className:s.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},this.renderLivingArea()),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleLivingAreaReset.bind(this)},"×"))}}Ma.propTypes={searchLivingArea:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Aa=Ma=Object(m.b)(({searchLivingArea:e})=>({searchLivingArea:e}))(Ma);class Ia extends r.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(bt("0")),pt()})}render(){var{searchBathrooms:e}=this.props;if("0"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=e.options.find(t=>t.value===e.selected),a=["search-terms-item"].concat(t),i="1~1"!==s.value?e.title:e.titleSingle;return r.a.createElement("div",{className:a.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},s.label," ",i.toLowerCase()),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"×"))}}Ia.propTypes={searchBathrooms:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Ba=Ia=Object(m.b)(({searchBathrooms:e})=>({searchBathrooms:e}))(Ia);class Fa extends r.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(vt(0)),pt()})}render(){var{searchOnlineSince:e}=this.props;if(0===e.selected)return null;var t=e.options.find(t=>t.value===e.selected),s=this.props.extraClassNames?this.props.extraClassNames:[],a=["search-terms-item"].concat(s);return r.a.createElement("div",{className:a.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},e.title," ",t.label),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"×"))}}Fa.propTypes={searchOnlineSince:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var ja=Fa=Object(m.b)(({searchOnlineSince:e})=>({searchOnlineSince:e}))(Fa);class Va extends r.a.Component{handleFiltersReset(){setTimeout(()=>{this.props.dispatch(kt(et())),pt()})}render(){var{searchFilters:e}=this.props;if("is_builder"===e.selected&&"qc"===window.DP.province||e.selected===et())return null;var t=e.options.find(t=>t.id===e.selected);if(void 0===t)return null;var s=this.props.extraClassNames?this.props.extraClassNames:[],a=["search-terms-item"].concat(s);return r.a.createElement("div",{className:a.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},t.name),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleFiltersReset.bind(this)},"×"))}}Va.propTypes={searchFilters:je.PropTypes.object,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Ua=Va=Object(m.b)(({searchFilters:e})=>({searchFilters:e}))(Va);class $a extends r.a.Component{handleTypeDelete(e){setTimeout(()=>{this.props.dispatch(Lt(e)),pt()})}render(){var e="purplebricks"===window.DP.theme,{searchFlags:t}=this.props,s=[...t.options];e&&(s=t.options.filter(e=>"with_builders"!==e.id));var a=s.filter(e=>e.id!==this.props.selectedOption);0===a.length&&(a=s);var i=s.find(e=>e.id===a[0].id),n=this.props.extraClassNames?this.props.extraClassNames:[],o=["search-terms-item"].concat(n);return r.a.createElement("div",{className:o.join(" ")},r.a.createElement("div",{className:"search-terms-item__name"},i.nameWithoutText),r.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,i.id)},"×"))}}$a.propTypes={searchFlags:je.PropTypes.object,selectedOption:je.PropTypes.string,extraClassNames:je.PropTypes.array,dispatch:je.PropTypes.func.isRequired};var Ga=$a=Object(m.b)(({searchFlags:e})=>({searchFlags:e}))($a);class Ha extends r.a.Component{render(){var e,t,s="purplebricks"===window.DP.theme,a=He("search-bar__tags",{active:!this.props.searchBar.tagsCollapsed});this.visibleTags=1,s?(e=this.props.searchFlags.selected.filter(e=>"with_builders"!==e),t=this.props.searchFlags.defaultValue.filter(e=>"with_builders"!==e)):(e=this.props.searchFlags.selected,t=this.props.searchFlags.defaultValue);var i=e.map(e=>this.renderFlags(e));return 0===i.length&&(i=t.map(e=>this.renderFlags(e))),r.a.createElement("div",{className:a},this.props.searchTerms.map(this.renderTerm.bind(this)),this.props.searchTypes.options.map(e=>this.renderType(e)),this.props.searchSubTypes.selected.map(e=>this.renderSubType(e)),this.renderNumberOfRooms(),this.renderPriceRange(),this.props.searchOptions.selected.map(e=>this.renderOptions(e)),this.renderLivingArea(),this.renderLotSize(),this.renderBathrooms(),this.renderOnlineSince(),this.renderFilters(),i,this.renderShowExtraTags())}renderTerm(e){if(!(this.props.searchBar.tagsCollapsed&&this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Pa,{key:"searchTermsItem:".concat(e.uniqueId),term:e})}renderType(e){var{searchSubTypes:t}=this.props;if(this.props.searchBar.tagsCollapsed){var s=ls(t.options,e.id);if(ls(t.selected,e.id)!==s||this.visibleTags>tt())return}return++this.visibleTags,r.a.createElement(Sa,{key:"searchTypesPopoverOption:".concat(e.id),optionType:e,searchSubTypes:t})}renderSubType(e){if(this.props.searchBar.tagsCollapsed){var{searchSubTypes:t}=this.props,s=ls(t.options,e.typeId),a=ls(t.selected,e.typeId);if(0!==a&&a===s||this.visibleTags>tt())return}return++this.visibleTags,r.a.createElement(Na,{key:"searchSubTypesPopoverOption:".concat(e.typeId).concat(e.id),selectedSubType:e})}renderFlags(e){var t,s,{searchFlags:a}=this.props;if("purplebricks"===window.DP.theme?(t=a.selected.filter(e=>"with_builders"!==e),s=a.defaultValue.filter(e=>"with_builders"!==e)):(t=a.selected,s=a.defaultValue),!(t.length===s.length||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Ga,{key:"flagsOption:".concat(e),selectedOption:e})}renderOptions(e){if(this.props.searchBar.tagsCollapsed){var{searchOptions:t}=this.props,s=t.options.find(t=>t.id===e);if(!t.selected.length||0===s.id||this.visibleTags>tt())return}return++this.visibleTags,r.a.createElement(Oa,{key:"characteristicsOption:".concat(e),selectedOption:e})}renderNumberOfRooms(){if(!this.props.searchBar.tagsCollapsed||!("0"===this.props.searchRooms.selected||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Ea,null)}renderPriceRange(){if(!this.props.searchBar.tagsCollapsed||!(!this.props.searchPriceRange.selected[0]&&!this.props.searchPriceRange.selected[1]||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(La,null)}renderLotSize(){if(!this.props.searchBar.tagsCollapsed||!("~"===this.props.searchLotSize.selected||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Da,null)}renderLivingArea(){if(!this.props.searchBar.tagsCollapsed||!("~"===this.props.searchLivingArea.selected||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Aa,null)}renderBathrooms(){if(!this.props.searchBar.tagsCollapsed||!("0"===this.props.searchBathrooms.selected||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Ba,null)}renderOnlineSince(){if(!this.props.searchBar.tagsCollapsed||!(0===this.props.searchOnlineSince.selected||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(ja,null)}renderFilters(){if(!this.props.searchBar.tagsCollapsed||!(this.props.searchFilters.selected===et()||this.visibleTags>tt()))return++this.visibleTags,r.a.createElement(Ua,null)}renderShowExtraTags(){return r.a.createElement(ba,{context:"tags",totalTagsCount:this.props.totalTagsCount})}}Ha.propTypes={dispatch:je.PropTypes.func.isRequired,searchBar:je.PropTypes.shape({tagsCollapsed:je.PropTypes.boolean}).isRequired,searchTerms:je.PropTypes.array.isRequired,searchRooms:je.PropTypes.object,searchTypes:je.PropTypes.object,searchSubTypes:je.PropTypes.object,searchPriceRange:je.PropTypes.object,searchOptions:je.PropTypes.object,searchLandArea:je.PropTypes.object,searchBathrooms:je.PropTypes.object,searchOnlineSince:je.PropTypes.object,searchFilters:je.PropTypes.object,searchFlags:je.PropTypes.object,totalTagsCount:je.PropTypes.number,searchLotSize:je.PropTypes.object,searchLivingArea:je.PropTypes.object};var za=Ha=Object(m.b)(({searchBar:e,searchTerms:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u})=>({searchBar:e,searchTerms:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u}))(Ha);class Wa extends r.a.Component{render(){if(!window.DP.configSwitch.SearchBarTabs)return null;var e=this.props.items,t=[];for(var s in e)t.push(this.renderItem(e[s]));return r.a.createElement("nav",{className:"header-searchbar-nav__list-container"},r.a.createElement("ul",{className:"header-searchbar-nav__list"},t))}renderItem(e){var t=He("header-searchbar-nav__item",{highlighted:e.active});return r.a.createElement("li",{className:t,key:e.key},r.a.createElement("a",{href:e.url,className:"header-searchbar-nav__link",onClick:this.triggerGtmPush.bind(this,e.key)},e.label))}triggerGtmPush(e){Se.a.pushToDataLayer("gtm-event","Search_Navigation","Inventory_Tab",this.renderGTMEventLabel(e))}renderGTMEventLabel(e){var t="";switch(e){case"newly_built":t="NewHomes";break;case"for_rent":t="Rental";break;default:case"for_sale":t="Resale"}return t}}Wa.propTypes={items:je.PropTypes.arrayOf(je.PropTypes.shape({key:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired,url:je.PropTypes.string.isRequired,active:je.PropTypes.bool.isRequired})).isRequired};var Ka=Wa;class Ya extends r.a.Component{render(){return r.a.createElement("div",{className:"warning-message-bar"},r.a.createElement("div",{className:"warning-message-bar__text"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-warning.svg",cacheGetRequests:!0}),this.props.message))}}Ya.propTypes={message:je.PropTypes.string.isRequired};var Xa=Ya;class Za extends r.a.Component{constructor(e){super(e),this.state={searchTermsTotalCount:0,searchClick:!1}}componentDidMount(){this.calculateTotalSearchTerms(),this.openIntroFirstLoad(),Se.a.registerElements()}componentDidUpdate(){this.calculateTotalSearchTerms()}calculateTotalSearchTerms(){var e=ns(this.props);e!==this.state.searchTermsTotalCount&&this.setState({searchTermsTotalCount:e})}openIntroFirstLoad(){return"qc"===window.DP.province?null:(c.a.setBucket("firstimer_intro"),c.a.get("_has_been_shown")?null:!(this.state.searchTermsTotalCount&&!c.a.get("_has_been_shown"))||(c.a.setBucket("firstimer_intro"),c.a.set("_has_been_shown",!0),!1))}handleButtonClick(){this.props.dispatch(qt("1")),this.props.dispatch(Ot()),this.setState({searchClick:!0})}handleButtonClose(){d()(".mobile-menu").removeClass("mobile-menu--active"),d()(".mobile-header__item").removeClass("mobile-header__item--active"),d()("#chat-widget-container").show()}fetchGtmClassName(){return d()(".mobile-header").is(":visible")?"search-bar__input-wrapper__button gtm-header-mobile-link-search-bar-button":"search-bar__input-wrapper__button gtm-header-link-search-bar-button"}selectedFilters(){return void 0!==this.props.searchFilters.options.find(e=>e.id===this.props.searchFilters.selected)}render(){var e=He("search-bar__input-wrapper__background",{"visible-tags":this.state.searchTermsTotalCount}),t=He("search-bar",{"tabs-visible":window.DP.configSwitch.SearchBarTabs});return r.a.createElement("div",{className:t},r.a.createElement(Ka,{items:this.props.searchBar.headerNav.items}),this.renderHeader(),this.renderIntro(),!this.props.warningMessageBar.showWarningMessage||r.a.createElement(Xa,{message:this.props.geoWarningMessage}),r.a.createElement("div",{className:"search-bar__input-wrapper"},r.a.createElement("div",{className:"search-bar__input-wrapper__fields"},r.a.createElement(zt,{location:"SearchBar",onSubmit:this.handleButtonClick.bind(this),nearMeTermLabel:this.props.searchBar.nearMeTermLabel,locale:this.props.searchBar.locale,nearMePush:this.props.searchBarPushEvents.nearMe,locationText:this.props.searchBar.locationText}),r.a.createElement("div",{className:"search-bar__input-wrapper__separator"}," "),r.a.createElement("div",{className:"search-bar__input-wrapper__item"},r.a.createElement(ss,{provider:"searchBar"})),r.a.createElement("div",{className:"search-bar__input-wrapper__item"},r.a.createElement(Ts,null)),this.renderRooms(),r.a.createElement("div",{className:"search-bar__input-wrapper__item"},r.a.createElement(da,{moreCriteriaPush:this.props.searchBarPushEvents.moreCriteria,disabledFields:this.props.searchBar.disabledFields,lotSizeLabel:this.props.searchLotSize.title,selectedUnit:this.props.searchLandArea.selectedUnit,titleUnit:this.props.searchLotSize.titleUnit,livingAreaLabel:this.props.searchLivingArea.title})),this.renderButton(),r.a.createElement("div",{className:e}," "),this.renderTags()),r.a.createElement("div",{className:"search-bar__input-wrapper__actions"},r.a.createElement(ua,{onHandleButtonClick:this.handleButtonClick.bind(this)}),this.renderButton())),r.a.createElement(ga,{onHandleButtonClick:this.handleButtonClick.bind(this),searchClick:this.state.searchClick}))}renderHeader(){return r.a.createElement("div",{className:"search-bar__header-mobile"},r.a.createElement("span",{className:"search-bar__header-mobile-title"},this.props.searchBar.headerTitle),r.a.createElement("div",{onClick:this.handleButtonClose.bind(this),className:"search-bar__header-mobile-close"},r.a.createElement(Ge.a,{className:"search-bar__header-mobile-close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})))}renderRooms(){return this.props.searchBar.disabledFields.includes("rooms")?null:r.a.createElement("div",{className:"search-bar__input-wrapper__item"},r.a.createElement(Jt,null))}renderTags(){var e=He("search-bar__input-wrapper__tags",{hidden:!this.state.searchTermsTotalCount||1===this.state.searchTermsTotalCount&&!this.selectedFilters()});return r.a.createElement("div",{className:e,ref:"searchTerms"},r.a.createElement("div",{className:"search-bar__input-wrapper__tags-leftside"},r.a.createElement("span",{className:"search-bar__input-wrapper__tags-label"},this.props.searchBar.labelTags),r.a.createElement(ba,{context:"left",totalTagsCount:this.state.searchTermsTotalCount})),r.a.createElement(za,{totalTagsCount:this.state.searchTermsTotalCount}),r.a.createElement(ua,{onHandleButtonClick:this.handleButtonClick.bind(this)}))}renderIntro(){return this.openIntroFirstLoad()?r.a.createElement("div",{className:"search-bar__first-timer-intro"},r.a.createElement("h4",{className:"search-bar__first-timer-intro-title"},this.props.searchBar.firstTimerIntro),r.a.createElement(Ge.a,{className:"search-bar__first-timer-intro-arrow",src:"/build/img/svg/icn-arrow-long-down.svg",cacheGetRequests:!0})):null}renderButton(){var e=this.fetchGtmClassName();return e="".concat(e," ").concat(this.props.searchBarPushEvents.findHomeButton),this.props.searchBar.submitting&&this.state.searchClick?r.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button--loading ".concat(this.props.searchBarPushEvents.findHomeButton)},r.a.createElement(ze,null)):this.props.searchBar.enabled?r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.searchBar.button):r.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button--inactive"},this.props.searchBar.button)}}Za.propTypes={dispatch:je.PropTypes.func.isRequired,searchBarPushEvents:je.PropTypes.object,searchBar:je.PropTypes.shape({firstTimerIntro:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,submitting:je.PropTypes.boolean,enabled:je.PropTypes.boolean,searchModifiedCriteria:je.PropTypes.object.isRequired,tagsCollapsed:je.PropTypes.boolean,nearMeTermLabel:je.PropTypes.string.isRequired,disabledFields:je.PropTypes.array.isRequired,locale:je.PropTypes.string.isRequired,labelTags:je.PropTypes.string.isRequired,headerNav:je.PropTypes.object.isRequired,headerTitle:je.PropTypes.string.isRequired,locationText:je.PropTypes.string.isRequired}).isRequired,searchRooms:je.PropTypes.object,searchTerms:je.PropTypes.array,searchTypes:je.PropTypes.object,searchSubTypes:je.PropTypes.object,searchPriceRange:je.PropTypes.object,searchOptions:je.PropTypes.object,searchLandArea:je.PropTypes.object,searchBathrooms:je.PropTypes.object,searchOnlineSince:je.PropTypes.object,searchFilters:je.PropTypes.object,searchFlags:je.PropTypes.object,searchLotSize:je.PropTypes.object,searchLivingArea:je.PropTypes.object,geoWarningMessage:je.PropTypes.string.isRequired,warningMessageBar:je.PropTypes.shape({showWarningMessage:je.PropTypes.bool})};var Ja=Za=Object(m.b)(({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m,warningMessageBar:g})=>({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m,warningMessageBar:g}))(Za),Qa=g.createProviderWrappedComponent(e=>r.a.createElement(Ja,e));class ei extends r.a.Component{constructor(e){super(e);var t=e.items.find(e=>e.active),s=parseInt(t.value,10);this.previousLink=s-1,this.nextLink=s+1}handlePageChange(e){this.props.onPageChange(e)}render(){return this.props.items.length?r.a.createElement("nav",{className:"pagination"},this.renderPreviousLink(),r.a.createElement("ul",{className:"pagination__list"},this.renderPageNumbers(this.props.items)),this.renderNextLink()):null}urlForPage(e){return e>1?"?pageNumber=".concat(e):window.location.pathname}renderPageNumbers(e){if(window.innerWidth<=768){var t=e.findIndex(e=>e.active),s=e.length-1;return e.map((e,a)=>{if(e.id>=8&&a>=t-1&&a<=t+1||e.id<8&&a>=t-5&&a<=t+2||0===a||a===s||"gap"===e.type)return this.renderItem(e)})}return e.map(e=>this.renderItem(e))}renderItem(e){return r.a.createElement(ti,{key:"pagination:item:".concat(e.id),onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,e.value),href:this.props.useHref?this.urlForPage(e.value):void 0,item:e,pageNumbersGtmClass:this.props.pageNumbersGtmClass})}renderPreviousLink(){var e=He("pagination__arrow",{left:!0,disabled:!this.props.previousLinkActive}),t=r.a.createElement(Ge.a,{className:"pagination__icon--left is-no-events",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0});return this.props.previousLinkActive?r.a.createElement("div",{className:e},r.a.createElement("a",{onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,this.previousLink),href:this.props.useHref?this.urlForPage(this.previousLink):void 0,className:this.props.previousGtmClass},t,r.a.createElement("span",{className:"pagination__icon-label is-no-events"},this.props.prevLabel))):r.a.createElement("div",{className:e},t)}renderNextLink(){var e=He("pagination__arrow",{right:!0,disabled:!this.props.nextLinkActive}),t=r.a.createElement(Ge.a,{className:"pagination__icon--right is-no-events",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0});return this.props.nextLinkActive?r.a.createElement("div",{className:e},r.a.createElement("a",{onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,this.nextLink),href:this.props.useHref?this.urlForPage(this.nextLink):void 0,className:this.props.nextGtmClass},r.a.createElement("span",{className:"pagination__icon-label is-no-events"},this.props.nextLabel),t)):r.a.createElement("div",{className:e},t)}}var ti=({item:e,onClick:t,href:s,pageNumbersGtmClass:a})=>{var i=He("pagination__item",{active:e.active,gap:"gap"===e.type});return"gap"===e.type?r.a.createElement("li",{className:i},r.a.createElement("span",null,e.value)):r.a.createElement("li",{className:i},r.a.createElement("a",{onClick:t,href:s,className:a},e.value))};ti.propTypes={onClick:je.PropTypes.func,href:je.PropTypes.string,item:je.PropTypes.shape({type:je.PropTypes.string.isRequired,id:je.PropTypes.string,value:je.PropTypes.string,active:je.PropTypes.bool}).isRequired,pageNumbersGtmClass:je.PropTypes.string},ei.propTypes={onPageChange:je.PropTypes.func.isRequired,previousLinkActive:je.PropTypes.bool.isRequired,nextLinkActive:je.PropTypes.bool.isRequired,useHref:je.PropTypes.bool.isRequired,prevLabel:je.PropTypes.string,nextLabel:je.PropTypes.string,pageNumbersGtmClass:je.PropTypes.string,previousGtmClass:je.PropTypes.string,nextGtmClass:je.PropTypes.string,items:je.PropTypes.array.isRequired};var si=ei;class ai extends r.a.Component{handlePageChange(e){this.props.dispatch(qt(e.toString())),this.props.dispatch(Ot())}render(){return r.a.createElement(si,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,prevLabel:this.props.prevLabel,nextLabel:this.props.nextLabel,useHref:this.props.useHref,onPageChange:this.handlePageChange.bind(this),pageNumbersGtmClass:this.props.pageNumbersGtmClass,previousGtmClass:this.props.previousGtmClass,nextGtmClass:this.props.nextGtmClass})}}ai.propTypes={dispatch:je.PropTypes.func.isRequired,previousLinkActive:je.PropTypes.bool.isRequired,nextLinkActive:je.PropTypes.bool.isRequired,prevLabel:je.PropTypes.string.isRequired,nextLabel:je.PropTypes.string.isRequired,items:je.PropTypes.array.isRequired,useHref:je.PropTypes.bool.isRequired,currentPageNumber:je.PropTypes.string,pageNumbersGtmClass:je.PropTypes.string,previousGtmClass:je.PropTypes.string,nextGtmClass:je.PropTypes.string},ai=Object(m.b)(({searchPagination:e})=>{var{currentPageNumber:t}=e;return{currentPageNumber:t}})(ai);var ii=g.createProviderWrappedComponent(e=>r.a.createElement(ai,e)),ri=e=>{var t=(e=>{var t=(({testimonialsPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e),s=(({testimonialsRegion:e})=>e.regionId)(e);return Je({pageNumber:t,regionId:s})})(e),s=d.a.param(t);window.location="".concat(window.DP.urls.testimonials,"?").concat(s)},ni=e=>({type:"SET_TESTIMONIALS_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e}),oi=()=>(ri(window.DP.store.getState()),{type:"SUBMIT_TESTIMONIALS"});class li extends r.a.Component{handlePageChange(e){this.props.dispatch(ni(e.toString())),this.props.dispatch(oi())}render(){return r.a.createElement(si,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,onPageChange:this.handlePageChange.bind(this)})}}li.propTypes={dispatch:je.PropTypes.func.isRequired,previousLinkActive:je.PropTypes.bool.isRequired,nextLinkActive:je.PropTypes.bool.isRequired,items:je.PropTypes.array.isRequired,currentPageNumber:je.PropTypes.string},li=Object(m.b)(({testimonialsPagination:e})=>{var{currentPageNumber:t}=e;return{currentPageNumber:t}})(li);var ci=g.createProviderWrappedComponent(e=>r.a.createElement(li,e)),pi=s(30),di=s.n(pi);class hi extends r.a.Component{render(){var e=this.props.baseUrl,t=He("photo-viewer__slide",{"brokerage-sold":this.props.isPurplebricksSold,"3D_showcase":"3D showcase"===this.props.photo.type}),s="".concat(e).concat(this.props.photo.formats[this.props.size]);return r.a.createElement("div",{className:t,onClick:this.props.onSlideClick},this.renderBrokerageSold(),this.render3DShowcase(),r.a.createElement("div",{className:"photo-viewer__slide__image-container"},r.a.createElement("img",{className:"photo-viewer__image","data-lazy":s,alt:this.setPhotosAlternativeText()})))}render3DShowcase(){return"3D showcase"!==this.props.photo.type?null:r.a.createElement("div",{className:"photo-viewer__3dshowcase-container"},r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--showcase-3d-play-icon",src:"/build/img/svg/icn-play-button.svg",cacheGetRequests:!0}),r.a.createElement("p",{className:"photo-viewer__3dshowcase-container-text"}," ",this.props.showcase3DVisit))}renderBrokerageSold(){return this.props.isPurplebricksSold?r.a.createElement("div",{className:"photo-viewer__sold-container"},r.a.createElement("div",{className:"photo-viewer__sold"},this.props.iSoldLabel)):null}setPhotosAlternativeText(){var e=this.props.photo.alternative_text;return this.props.photo.type&&this.props.photo.description&&!this.props.isSold&&(e="".concat(this.props.photo.type," - ").concat(this.props.photo.description)),e}}hi.propTypes={photo:je.PropTypes.object.isRequired,baseUrl:je.PropTypes.string.isRequired,onSlideClick:je.PropTypes.func.isRequired,size:je.PropTypes.number.isRequired,isPurplebricksSold:je.PropTypes.bool.isRequired,iSoldLabel:je.PropTypes.string.isRequired,isSold:je.PropTypes.bool,showcase3DVisit:je.PropTypes.string.isRequired};var ui=hi,mi=()=>window.devicePixelRatio>1||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches,gi=()=>mi()?600:320,_i=()=>window.innerWidth<=window.DP.breakpoints.medium&&!mi()?600:window.innerWidth>window.DP.breakpoints.xlarge&&mi()?1600:1024,bi=()=>window.innerWidth<=window.DP.breakpoints.medium&&!mi()?1024:1600,vi={accessibility:!1,arrows:!1,lazyLoad:"ondemand",centerMode:!0,centerPadding:0,slidesToShow:1,speed:200,zIndex:1};class yi extends r.a.Component{constructor(e){super(e),this.state={showModal:!1},this.photoSize=bi()}componentDidMount(){this.photosElement=d()(this.refs.photos),this.modalElement=d()(this.refs.modal),this.$showcase3DButtonElement=d()(".".concat("photo-viewer")).find(".".concat("photo-viewer-3d-showcase__button"))}componentDidUpdate(e,{showModal:t}){!1===t&&!0===this.state.showModal&&(this.photosElement.is(".".concat("slick-initialized"))?(this.photosElement.slick("setPosition"),this.photosElement.slick("slickGoTo",this.props.activePhoto.index,!0)):this.initializeSlider())}handleOpenButtonClick(){this.setState({showModal:!0})}handleCloseButtonClick(){this.setState({showModal:!1})}handleNextButtonClick(){this.photosElement.slick("slickNext")}handlePreviousButtonClick(){this.photosElement.slick("slickPrev")}handleKeyUp(e){this.state.showModal&&(37===e.keyCode&&this.photosElement.slick("slickPrev"),39===e.keyCode&&this.photosElement.slick("slickNext"))}handle3DShowcaseClick(e){e.stopPropagation(),this.$showcase3DButtonElement.trigger("click")}renderTitleSeparator(e){return e.type&&e.description?r.a.createElement("span",{className:"photo-viewer-fullscreen__photo-separator"},"/"):null}renderSinglePhoto(e,t){return r.a.createElement("div",{key:"photoViewer:photo:".concat(t),className:"photo-viewer-fullscreen__photo"},this.render3DShowcase(e),this.renderPhoto(e))}render3DShowcase(e){var t="3D showcase"===e.type,s=He("photo-viewer-fullscreen__photo-image",{"3d-showcase":t});return t?r.a.createElement("div",{className:"photo-viewer-fullscreen__photo-wrapper"},r.a.createElement("img",{"data-lazy":"".concat(this.props.photoBaseUrl).concat(e.formats[this.photoSize]),className:s,alt:this.setPhotosAlternativeText(e)}),r.a.createElement("div",{className:"photo-viewer__3dshowcase-container photo-viewer-fullscreen__photo-image",onClick:this.handle3DShowcaseClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--showcase-3d-play-icon",src:"/build/img/svg/icn-play-button.svg",cacheGetRequests:!0}),r.a.createElement("p",{className:"photo-viewer__3dshowcase-container-text"}," ",this.props.showcase3DVisit))):null}renderPhoto(e){var t="3D showcase"===e.type,s=He("photo-viewer-fullscreen__photo-image");return t?null:r.a.createElement("div",{className:"photo-viewer-fullscreen__photo-wrapper"},r.a.createElement("img",{"data-lazy":"".concat(this.props.photoBaseUrl).concat(e.formats[this.photoSize]),className:s,alt:this.setPhotosAlternativeText(e)}),r.a.createElement("div",{className:"photo-viewer-fullscreen__photo-info "},r.a.createElement("span",{className:"photo-viewer-fullscreen__photo-type"},e.type),this.renderTitleSeparator(e),r.a.createElement("span",{className:"photo-viewer-fullscreen__photo-description"},e.description)))}setPhotosAlternativeText(e){var t=e.alternative_text;return e.type&&e.description&&!this.props.isSold&&(t="".concat(e.type," - ").concat(e.description)),t}render(){var e=He("photo-viewer-fullscreen__modal",{visible:this.state.showModal});return r.a.createElement("div",{className:"photo-viewer-fullscreen"},r.a.createElement("div",{className:"photo-viewer-fullscreen__button",onClick:this.handleOpenButtonClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer-fullscreen__button__icon",src:"/build/img/svg/icn-fullscreen.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:e,ref:"modal"},r.a.createElement("div",{onClick:this.handleCloseButtonClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer-fullscreen__modal-close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:"photo-viewer-fullscreen__viewport"},r.a.createElement(fi,{photoCount:this.props.photos.length,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),r.a.createElement("div",{className:"photo-viewer-fullscreen__viewport__photos",ref:"photos"},Array.from(this.props.photos).map((e,t)=>this.renderSinglePhoto(e,t))))))}initializeSlider(){window.$window.on("keyup.PhotoViewerFullscreen",this.handleKeyUp.bind(this));var e=Object.assign({},vi,{initialSlide:this.props.activePhoto.index});di()(this.photosElement,e)}}var fi=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:r.a.createElement("div",{className:"photo-viewer-fullscreen__viewport__navigation"},r.a.createElement("div",{onClick:t,className:"photo-viewer-fullscreen__viewport__navigation-button photo-viewer-fullscreen__viewport__navigation-button--prev"},r.a.createElement(Ge.a,{className:"photo-viewer-fullscreen__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{onClick:s,className:"photo-viewer-fullscreen__viewport__navigation-button photo-viewer-fullscreen__viewport__navigation-button--next"},r.a.createElement(Ge.a,{className:"photo-viewer-fullscreen__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})));yi.propTypes={photos:je.PropTypes.array.isRequired,activePhoto:je.PropTypes.object.isRequired,photoBaseUrl:je.PropTypes.string.isRequired,has3DShowcase:je.PropTypes.bool,showcaseUrl:je.PropTypes.string,listingCode:je.PropTypes.string.isRequired,isSold:je.PropTypes.bool,showcase3DVisit:je.PropTypes.string.isRequired},fi.propTypes={photoCount:je.PropTypes.number.isRequired,onPreviousButtonClick:je.PropTypes.func.isRequired,onNextButtonClick:je.PropTypes.func.isRequired};var Ti=yi,Pi=e=>'<krpano version="'.concat(1.19,'" onstart="loadscene(scene0);">\n        <include url="/build/vendor/krpano/skin/sphere.xml?nocache=%$random%" if="isSphere === true" />\n        <include url="/build/vendor/krpano/skin/cylinder.xml?nocache=%$random%" if="isSphere === false" />\n        <skin_settings webvr="').concat(e,'" title="').concat(!0,'" thumbs="').concat(!0,'" thumbs_width="').concat(100,'" thumbs_height="').concat(40,'" thumbs_padding="').concat(10,'" thumbs_crop="').concat("",'" />'),wi=(e,t,s,a)=>{var i=' <view hlookat="'.concat("0.0",'" vlookat="').concat("0.0",'" fovtype="').concat("HFOV",'" fov="').concat("110",'" fovmin="').concat("70",'" fovmax="').concat("140",'" limitview="').concat("range",'" />');return a&&(i='<view hlookat="'.concat("0.0",'" vlookat="').concat("0.0",'" fovtype="').concat("HFOV",'" fov="').concat("110",'" fovmin="').concat("70",'" fovmax="').concat("140",'" hlookatmin="').concat("-180",'" hlookatmax="').concat("+180",'" vlookatmin="').concat("-70",'" vlookatmax="').concat("+70",'" limitview="').concat("range",'" />')),'<scene name="scene'.concat(t,'" title="').concat(e[t].title,'" thumburl="').concat(s).concat(e[t].thumb,'" heading="').concat(0,'">\n    ').concat(i,'\n    <preview url="').concat(s).concat(e[t].thumb,'" />')},Ei=()=>"</scene>",Ci=(e,t,s)=>"<image><".concat(e,' url="').concat(s).concat(t,'" /></image>'),Si=()=>'<security cors="'.concat("",'"><crossdomainxml url="').concat("/crossdomain.xml",'" />\n    <allowdomain domain="').concat("duproprio.com",'" /></security></krpano>'),Ri=(e,t,s)=>{var a=Pi(t);for(var i of Object.keys(e))a+=wi(e,i,s,t),a+=Ci(e[i].type,e[i].photo,s),a+=Ei();return a+=Si()};class Ni extends r.a.Component{constructor(e){super(e),this.isSphere=e.panorama.some(e=>"sphere"===e.type),this.state={showModal:!1}}handleOpenClick(){var e,t,s;window.embedpano((e=this.props.panorama,t=this.isSphere,s=this.props.photoBaseUrl,{swf:"".concat("/build/vendor/krpano/","krpano.swf"),target:"panorama",xml:"",basepath:"/build/vendor/krpano/",html5:"prefer+webgl",initvars:{isSphere:t},mobilescale:1,passQueryParameters:!0,vars:{onstart:"loadxml(".concat(Ri(e,t,s),")")}})),this.setState({showModal:!0})}handleCloseClick(){this.setState({showModal:!1}),this.refs.viewer.innerHTML=""}render(){var e=He("photo-viewer-panorama-modal",{visible:this.state.showModal}),t=He("photo-viewer-panorama-content",{sphere:this.isSphere});return r.a.createElement("div",{className:"photo-viewer-panorama"},r.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"photo-viewer-panorama__button"}),r.a.createElement("div",{className:e},r.a.createElement("div",{className:t},r.a.createElement("div",{className:"photo-viewer-panorama-content__header"},r.a.createElement("div",{onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer-panorama-modal__close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),r.a.createElement("div",{className:"photo-viewer-panorama-content__viewer",id:"panorama",ref:"viewer"}))))}}Ni.propTypes={panorama:je.PropTypes.array,photoBaseUrl:je.PropTypes.string.isRequired};var ki=Ni,Li=(e,t)=>{var s=(e=>Ke()(window.DP.urls.proxyStats,e))(e),a={type:t};return d.a.ajax({method:"POST",url:s,data:a,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class qi extends r.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0}),Li(this.props.listingCode,"click_3d_virtual_tour")}handleCloseClick(){this.setState({showModal:!1})}renderMatterportIframe(){return this.state.showModal?r.a.createElement("iframe",{className:"photo-viewer-3d-showcase-content__viewer matterportIframe_vrmfu2",width:"853",height:"480",src:this.props.showcaseUrl,frameBorder:"0",allowFullScreen:!0}):null}renderLogoSVG(){return"qc"===window.DP.province?r.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__logo-dp"},r.a.createElement(Ge.a,{className:"photo-viewer-3d-showcase-modal__logo-dp-home",src:"/build/img/svg/logo-home.svg",cacheGetRequests:!0}),r.a.createElement(Ge.a,{className:"photo-viewer-3d-showcase-modal__logo-dp-text",src:"/build/img/svg/logo-duproprio-text.svg",cacheGetRequests:!0})):r.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__logo-pb"},r.a.createElement(Ge.a,{className:"photo-viewer-3d-showcase-modal__logo-pb-home",src:"/build/img/svg/purplebricks/logo-purplebricks.svg",cacheGetRequests:!0}))}render(){var e=He("photo-viewer-3d-showcase-modal",{visible:this.state.showModal});return r.a.createElement("div",{className:"photo-viewer-3d-showcase"},r.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"photo-viewer-3d-showcase__button"}),r.a.createElement("div",{className:e},r.a.createElement("div",{className:"photo-viewer-3d-showcase-content"},r.a.createElement("div",{className:"photo-viewer-3d-showcase-content__header"},this.renderLogoSVG(),r.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__close-button-container",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer-3d-showcase-modal__close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),this.renderMatterportIframe())))}}qi.propTypes={showcaseUrl:je.PropTypes.string.isRequired,listingCode:je.PropTypes.string.isRequired};var Oi=qi,xi=/TEXTAREA|INPUT|SELECT/,Di={accessibility:!1,arrows:!1,centerMode:!0,centerPadding:0,focusOnSelect:!0,responsive:[{breakpoint:4e3,settings:{lazyLoad:"ondemand"}},{breakpoint:window.DP.breakpoints.regular,settings:{variableWidth:!1}}],slidesToShow:1,variableWidth:!0,speed:200,zIndex:1};class Mi extends r.a.Component{constructor(e){super(e);var t=e.photos.map((e,t)=>Object.assign({},e,{index:t}));this.photoCount=t.length,this.hasSinglePhoto=1===this.photoCount,this.hasPanorama=e.panorama&&e.panorama.length>0,this.photoSize=_i(),this.isFixedHeightListing=e.fixedHeightListing,this.photos=1===t.length?t:t.concat(t),this.state={activePhoto:this.photos[0],fullScreenTriggered:!1}}componentDidMount(){this.$photosElement=d()(this.refs.photos),this.$fullscreenButtonElement=d()(this.refs.root).find(".".concat("photo-viewer-fullscreen__button")),this.$panoramaButtonElement=d()(this.refs.root).find(".".concat("photo-viewer-panorama__button")),this.$showcase3DButtonElement=d()(this.refs.root).find(".".concat("photo-viewer-3d-showcase__button")),this.$photosElement.on("afterChange",this.handleSliderAfterChange.bind(this)),this.$photosElement.on("lazyLoaded",this.handleSlideLazyLoaded.bind(this)),this.$photosElement.on("swipe",this.handleSwipe.bind(this)),di()(this.$photosElement,Di),window.$window.on("keyup.PhotoViewer",this.handleKeyUp.bind(this))}componentWillUnmount(){window.$window.off("keyup.PhotoViewer")}handleNextButtonClick(){this.state.fullScreenTriggered&&this.setState({fullScreenTriggered:!1}),this.$photosElement.slick("slickNext")}handlePreviousButtonClick(){this.state.fullScreenTriggered&&this.setState({fullScreenTriggered:!1}),this.$photosElement.slick("slickPrev")}handleSwipe(){this.setState({fullScreenTriggered:!1})}handleSliderAfterChange(e,t,s){var a=this.photos[s];this.setState({activePhoto:a},(function(){this.state.fullScreenTriggered&&this.$fullscreenButtonElement.trigger("click")}))}handleSlideLazyLoaded(){this.$photosElement.slick("setPosition")}handleKeyUp(e){e.target.tagName.match(xi)||(37===e.keyCode&&this.$photosElement.slick("slickPrev"),39===e.keyCode&&this.$photosElement.slick("slickNext"))}handlePhotoClick(){this.props.isPurplebricksSold||("3D showcase"===this.state.activePhoto.type?this.$showcase3DButtonElement.trigger("click"):this.shouldClickTriggerFullScreen()?this.$fullscreenButtonElement.trigger("click"):this.setState({fullScreenTriggered:!1}))}handleFullscreenClick(e){e.stopPropagation(),this.$fullscreenButtonElement.trigger("click")}handlePanoramaClick(e){Se.a.pushDynamicEvent("listing-photosection-360panorama","Listing"),e.stopPropagation(),this.$panoramaButtonElement.trigger("click")}handle3DShowcaseClick(e){e.stopPropagation(),this.$showcase3DButtonElement.trigger("click")}render(){if(!this.state.activePhoto)return null;var e=He("photo-viewer__viewport__slides",{single:this.hasSinglePhoto}),t=He("photo-viewer",{fixedHeight:this.isFixedHeightListing});return r.a.createElement("div",{className:t,ref:"root"},r.a.createElement("div",{className:"photo-viewer__viewport"},r.a.createElement(Ii,{photoCount:this.photoCount,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),r.a.createElement("div",{className:e,ref:"photos"},Array.from(this.photos).map(this.renderSlide.bind(this))),this.renderViewerCaption()),this.renderFullscreenViewer(),this.renderPanoramaViewer(),this.render3DShowcaseViewer())}renderSlide(e,t){return r.a.createElement(ui,{key:"photoViewer:slide:".concat(t),photo:e,size:this.photoSize,onSlideClick:this.handlePhotoClick.bind(this),baseUrl:this.props.photoBaseUrl,isPurplebricksSold:this.props.isPurplebricksSold,iSoldLabel:this.props.iSoldLabel,showcase3DVisit:this.props.showcase3DVisit,isSold:this.props.isSold})}renderFullscreenViewer(){return r.a.createElement(Ti,{photos:this.photos,activePhoto:this.state.activePhoto,photoBaseUrl:this.props.photoBaseUrl,has3DShowcase:this.props.has3DShowcase,showcaseUrl:this.props.showcaseUrl,listingCode:this.props.listingCode,isSold:this.props.isSold,showcase3DVisit:this.props.showcase3DVisit})}renderPanoramaViewer(){return this.hasPanorama?r.a.createElement(ki,{panorama:this.props.panorama,photoBaseUrl:this.props.photoBaseUrl}):null}render3DShowcaseViewer(){return this.props.has3DShowcase?r.a.createElement(Oi,{showcaseUrl:this.props.showcaseUrl,listingCode:this.props.listingCode}):null}shouldClickTriggerFullScreen(){var e=this.$photosElement.slick("slickCurrentSlide");return e>this.photoCount-1&&(e-=this.photoCount),this.state.activePhoto.index===e}renderViewerCaption(){return r.a.createElement("div",{className:"photo-viewer__caption"},r.a.createElement("div",{className:"photo-viewer__caption-informations"},r.a.createElement(Ai,{photoCount:this.photoCount,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),r.a.createElement("div",{className:"photo-viewer__caption-texts"},this.renderPhotoCount(),this.renderType(),this.renderSeparator(),this.renderDescription()),r.a.createElement("div",{className:"photo-viewer__caption-buttons"},this.renderPanoramaButton(),this.render3DShowcaseButton(),this.renderFullscreenButton())))}renderPhotoCount(){if(1===this.photoCount)return null;var e=this.state.activePhoto.index+1;return r.a.createElement("div",{className:"photo-viewer__caption-count"},e," / ",this.photoCount)}renderType(){return""===this.state.activePhoto?null:"3D showcase"===this.state.activePhoto.type?r.a.createElement("div",{className:"photo-viewer__caption-type"},this.state.activePhoto.alternative_text):r.a.createElement("div",{className:"photo-viewer__caption-type"},this.state.activePhoto.type)}renderSeparator(){return""===this.state.activePhoto.type||""===this.state.activePhoto.description?null:r.a.createElement("div",{className:"photo-viewer__caption-separator"},"–")}renderDescription(){return r.a.createElement("div",{className:"photo-viewer__caption-description"},this.state.activePhoto.description)}renderFullscreenButton(){return this.props.isPurplebricksSold?null:r.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--fullscreen",onClick:this.handleFullscreenClick.bind(this)},r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--fullscreen-icon",src:"/build/img/svg/icn-fullscreen.svg",cacheGetRequests:!0}))}renderPanoramaButton(){return this.hasPanorama?r.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--panorama gtm-listing-panorama-button",onClick:this.handlePanoramaClick.bind(this)},r.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-xlarge"},this.props.panorama360ShortLabel),r.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-small hidden-medium hidden-regular hidden-large"},this.props.panorama360Label),r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--panorama-button-icon hidden-small",src:"/build/img/svg/icn-visite-360.svg",cacheGetRequests:!0})):null}render3DShowcaseButton(){return this.props.has3DShowcase?r.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--showcase-3d gtm-listing-showcase-3d-button",onClick:this.handle3DShowcaseClick.bind(this)},r.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-xlarge"},this.props.showcase3DShortLabel),r.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-small hidden-medium hidden-regular hidden-large"},this.props.showcase3DLabel),r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--showcase-3d-button-icon hidden-small",src:"/build/img/svg/icn-visite-3d.svg",cacheGetRequests:!0})):null}}var Ai=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:r.a.createElement("div",{className:"photo-viewer__caption-navigation"},r.a.createElement("div",{onClick:t,className:"photo-viewer__caption-button photo-viewer__caption-button--navigation"},r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--navigation__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{onClick:s,className:"photo-viewer__caption-button photo-viewer__caption-button--navigation"},r.a.createElement(Ge.a,{className:"photo-viewer__caption-button--navigation__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0}))),Ii=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:r.a.createElement("div",{className:"photo-viewer__viewport__navigation"},r.a.createElement("div",{onClick:t,className:"photo-viewer__viewport__navigation-button photo-viewer__viewport__navigation-button--prev"},r.a.createElement(Ge.a,{className:"photo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{onClick:s,className:"photo-viewer__viewport__navigation-button photo-viewer__viewport__navigation-button--next"},r.a.createElement(Ge.a,{className:"photo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})));Ii.propTypes={photoCount:je.PropTypes.number.isRequired,onPreviousButtonClick:je.PropTypes.func.isRequired,onNextButtonClick:je.PropTypes.func.isRequired},Ai.propTypes={photoCount:je.PropTypes.number.isRequired,onPreviousButtonClick:je.PropTypes.func.isRequired,onNextButtonClick:je.PropTypes.func.isRequired},Ai.propTypes={photoCount:je.PropTypes.number.isRequired,onPreviousButtonClick:je.PropTypes.func.isRequired,onNextButtonClick:je.PropTypes.func.isRequired},Mi.propTypes={photoBaseUrl:je.PropTypes.string.isRequired,photos:je.PropTypes.array.isRequired,panorama:je.PropTypes.array,fixedHeightListing:je.PropTypes.bool,isPurplebricksSold:je.PropTypes.bool.isRequired,iSoldLabel:je.PropTypes.string.isRequired,showcaseUrl:je.PropTypes.string,showcase3DLabel:je.PropTypes.string,showcase3DShortLabel:je.PropTypes.string,panorama360Label:je.PropTypes.string,panorama360ShortLabel:je.PropTypes.string,has3DShowcase:je.PropTypes.bool,listingCode:je.PropTypes.string.isRequired,isSold:je.PropTypes.bool,showcase3DVisit:je.PropTypes.string.isRequired};var Bi=Mi;class Fi extends r.a.Component{constructor(e){super(e),this.state={searchTermsTotalCount:0,searchClick:!1}}componentDidMount(){this.calculateTotalSearchTerms()}componentDidUpdate(){this.calculateTotalSearchTerms()}calculateTotalSearchTerms(){var e=ns(this.props);e!==this.state.searchTermsTotalCount&&this.setState({searchTermsTotalCount:e})}handleOpenFullSearchClick(){d()(".".concat("mobile-header__item--search")).click(),d()(".".concat("search-bar__options-button--additional-criteria")).click()}render(){var e=He("mobile-search__button",{inactive:!this.props.searchBar.enabled});e=e.concat(" gtm-homepage-link-search-button",this.props.searchBarPushEvents.searchButton);var t=()=>{this.props.searchBar.enabled&&(this.props.dispatch(Ot()),e.includes(" gtm-homepage-link-search-bar")||(e=e.concat(" gtm-homepage-link-search-bar")))};return r.a.createElement("div",{className:"mobile-search-wrap"},r.a.createElement(Ka,{items:this.props.searchBar.headerNav.items}),r.a.createElement("div",{className:"mobile-search"},r.a.createElement(zt,{location:"HomeHero",onSubmit:t,nearMeTermLabel:this.props.nearMeTermLabel,locale:this.props.searchBar.locale,nearMePush:this.props.searchBarPushEvents.nearMe,locationText:this.props.searchBar.locationText})),r.a.createElement("div",{className:"search-bar__input-wrapper__tags",ref:"searchTerms"},r.a.createElement(za,{totalTagsCount:this.state.searchTermsTotalCount})),r.a.createElement(ss,{provider:"mobileSearch"}),r.a.createElement("div",{className:"mobile-search-wrapper__buttons"},r.a.createElement("button",{className:"mobile-search__button mobile-search__button--criteria ".concat(this.props.searchBarPushEvents.moreCriteria),onClick:this.handleOpenFullSearchClick},r.a.createElement("span",{className:"is-no-events"},this.props.searchBar.additionalCriteriaButtonText)),r.a.createElement("button",{className:e,onClick:t},r.a.createElement("span",{className:"mobile-search__button-text-label is-no-events"},this.props.searchBar.searchButtonText),r.a.createElement("span",{className:"mobile-search__button-icon-label is-no-events"},r.a.createElement(Ge.a,{className:"mobile-search__button-icon-label-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})))),r.a.createElement(ga,{onHandleButtonClick:t,searchClick:this.state.searchClick}))}}Fi.propTypes={dispatch:je.PropTypes.func.isRequired,searchBarPushEvents:je.PropTypes.object,nearMeTermLabel:je.PropTypes.string.isRequired,searchBar:je.PropTypes.shape({button:je.PropTypes.string.isRequired,submitting:je.PropTypes.boolean,enabled:je.PropTypes.boolean,tagsCollapsed:je.PropTypes.boolean,nearMeTermLabel:je.PropTypes.string.isRequired,advancedSearchLabel:je.PropTypes.string.isRequired,disabledFields:je.PropTypes.array.isRequired,locale:je.PropTypes.string.isRequired,headerNav:je.PropTypes.object.isRequired,additionalCriteriaButtonText:je.PropTypes.string.isRequired,searchButtonText:je.PropTypes.string.isRequired,locationText:je.PropTypes.string.isRequired}).isRequired};var ji=Fi=Object(m.b)(({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m})=>({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:a,searchSubTypes:i,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m}))(Fi),Vi=g.createProviderWrappedComponent(e=>r.a.createElement(ji,e)),Ui=(e,t,s)=>{s.alreadyCalled&&Gi(e),window.$window.scrollTop()+window.$window.height()>t.offset().top-300&&(s.alreadyCalled=!0,s())},$i=(e,t,s)=>{window.$window.on("scroll.".concat(e),Ui.bind(void 0,e,t,s))},Gi=e=>{window.$window.off("scroll.".concat(e))},Hi=(...e)=>{$i(...e)},zi={accessibility:!1,arrows:!0,autoplay:!0,autoplaySpeed:5e3,dots:!0,dotsClass:"".concat("auto-promo-viewer__dots"),slidesToShow:1,speed:200,zIndex:1,prevArrow:".".concat("auto-promo-viewer__viewport__navigation-button--prev"),nextArrow:".".concat("auto-promo-viewer__viewport__navigation-button--next")};class Wi extends r.a.Component{constructor(e){super(e);var t=e.promos[0],s=e.promos.length;this.state={activePromoIndex:0,activePromo:t,promoCount:s}}componentDidMount(){this.imagesElement=d()(this.refs.images),this.imagesElement.on("afterChange",this.handleSliderAfterChange.bind(this));var e=this.refs.content,t=Object.assign({},zi,{appendDots:e});d()(this.refs.content).find(".".concat("auto-promo-viewer__viewport__navigation-button--prev",", .").concat("auto-promo-viewer__viewport__navigation-button--next")).on("click",e=>{this.handleGtmPushOnClick,e.preventDefault()}),Hi("AutoPromoViewer",this.imagesElement,()=>{di()(this.imagesElement,t),d()(this.refs.content).find(".".concat("auto-promo-viewer__dots"," button")).off("click"),d()(this.refs.content).find(".".concat("auto-promo-viewer__dots"," button")).on("click",e=>{this.handleGtmPushOnClick,e.preventDefault()})})}handleSliderAfterChange(e,t,s){var a=this.props.promos[s];this.setState({activePromo:a,activePromoIndex:s})}handleGtmPushOnClick(){Se.a.pushToDataLayer("gtm-event","Homepage_Navigation","Click_ViewerFeatures","undefined")}render(){var e="#";return e=e.concat(this.props.anchor),r.a.createElement("a",{href:this.state.activePromo.actionUrl,className:"auto-promo-viewer",name:this.props.anchor},r.a.createElement("div",{className:"auto-promo-viewer__content js-auto-promo-viewer",ref:"content","data-label":e},r.a.createElement(Xi,{promoCount:this.state.promoCount}),r.a.createElement("div",{className:"auto-promo-viewer__infos"},r.a.createElement(Ki,{titleText:this.state.activePromo.title}),r.a.createElement(Yi,{subTitleText:this.state.activePromo.subtitle}),r.a.createElement("div",{className:"auto-promo-viewer__action"},r.a.createElement("span",{className:"auto-promo-viewer__action-link"},this.state.activePromo.action,r.a.createElement(Ge.a,{className:"auto-promo-viewer__action-link-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0}))))),r.a.createElement("div",{className:"auto-promo-viewer__images",ref:"images"},Array.from(this.props.promos).map((e,t)=>r.a.createElement("div",{key:"autoPromoViewer:promo:".concat(t),className:"auto-promo-viewer__promo"},r.a.createElement("img",{"data-lazy":e.imageUrl,alt:e.imageAlt})))))}}var Ki=({titleText:e})=>r.a.createElement("h4",{className:"auto-promo-viewer__title",dangerouslySetInnerHTML:{__html:e}}),Yi=({subTitleText:e})=>e?r.a.createElement("h5",{className:"auto-promo-viewer__subtitle",dangerouslySetInnerHTML:{__html:e}}):null,Xi=({promoCount:e})=>1===e?null:r.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation"},r.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation-button auto-promo-viewer__viewport__navigation-button--prev"},r.a.createElement(Ge.a,{className:"auto-promo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation-button auto-promo-viewer__viewport__navigation-button--next"},r.a.createElement(Ge.a,{className:"auto-promo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})));Ki.propTypes={titleText:je.PropTypes.string.isRequired},Yi.propTypes={subTitleText:je.PropTypes.string},Xi.propTypes={promoCount:je.PropTypes.number.isRequired},Wi.propTypes={promos:je.PropTypes.array.isRequired,anchor:je.PropTypes.string.isRequired};var Zi=Wi,Ji={accessibility:!1,arrows:!1,autoplay:!0,autoplaySpeed:1e4,slidesToShow:1,speed:200,zIndex:1};class Qi extends r.a.Component{constructor(e){super(e);var t=e.testimonials[0];this.state={activeTestimonialIndex:0,activeTestimonial:t}}componentDidMount(){this.imagesElement=d()(this.refs.images),this.imagesElement.on("afterChange",this.handleSliderAfterChange.bind(this)),Hi("TestimonialViewer",this.imagesElement,()=>{di()(this.imagesElement,Ji)})}handleSliderAfterChange(e,t,s){var a=this.props.testimonials[s];this.setState({activeTestimonial:a,activeTestimonialIndex:s})}getAnchorLabel(){return void 0===this.props.anchor?null:"#".concat(this.props.anchor)}render(){var e=this.getAnchorLabel()?"js-testimonial-viewer":"";return r.a.createElement("div",{className:"testimonial-viewer"},r.a.createElement("div",{className:"testimonial-viewer__viewport"},r.a.createElement("div",{className:"testimonial-viewer__images ".concat(e),ref:"images","data-label":this.getAnchorLabel()},Array.from(this.props.testimonials).map((e,t)=>r.a.createElement("div",{key:"testimonialViewer:testimonial:".concat(t),className:"testimonial-viewer__testimonial"},r.a.createElement("img",{"data-lazy":e.imageUrl,alt:e.imageAlt}))))),r.a.createElement("div",{className:"testimonial-viewer__content"},this.renderTagline(),r.a.createElement("h3",{className:"testimonial-viewer__title"},this.state.activeTestimonial.title,this.renderLegalHelp()),r.a.createElement("div",{className:"testimonial-viewer__quote"},r.a.createElement("div",{className:"testimonial-viewer__quote-text"},this.state.activeTestimonial.quote)),this.props.action?r.a.createElement("div",{className:"testimonial-viewer__action"},r.a.createElement("a",{className:"testimonial-viewer__action-link gtm-homepage-link-testimonial-navigation",href:this.props.actionUrl},this.props.action,r.a.createElement(Ge.a,{className:"testimonial-viewer__action-link-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0}))):null))}renderLegalHelp(){return this.state.activeTestimonial.disableLegal?null:r.a.createElement("div",{className:"testimonial-viewer__legal"},r.a.createElement(Ge.a,{className:"testimonial-viewer__legal-icon",src:"/build/img/svg/icn-question-mark.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"testimonial-viewer__legal-content"},r.a.createElement("div",{className:"popover-arrow"}),this.props.legalMessage))}renderTagline(){return this.state.activeTestimonial.tagline?r.a.createElement("h2",{className:"testimonial-viewer__tagline"},this.state.activeTestimonial.tagline):null}}Qi.propTypes={action:je.PropTypes.string,actionUrl:je.PropTypes.string,testimonials:je.PropTypes.array.isRequired,legalMessage:je.PropTypes.string.isRequired,anchor:je.PropTypes.string};var er=Qi;function tr(){return(tr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class sr extends r.a.Component{handleSelect(e){this.props.onSelect(e),"amortization"===this.props.dropdownId&&"qc"!==window.DP.province&&setTimeout(()=>{new Vs(d()(".listing-mortgage-calculator__content")).calculate(d()(".mortgage-data__table__row__monthly-mortgage"))})}render(){return r.a.createElement("div",{className:"select-dropdown"},this.renderLabel(),this.renderPopover())}renderLabel(){var e=this.props.options.find(e=>e.value===this.props.selected),t=!!this.props.isDisabled,s=He("select-dropdown__label",{disabled:t}),a={};return t||(a["data-jq-dropdown"]="#".concat(this.props.dropdownId)),r.a.createElement("div",tr({className:s},a),e?this.renderSelectedValue(e):this.renderPlaceHolder(),r.a.createElement(Ge.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-triangle-down.svg",cacheGetRequests:!0}))}renderSelectedValue(e){return r.a.createElement("span",{className:"select-dropdown__selected-value"},e.label)}renderPlaceHolder(){return r.a.createElement("span",{className:"select-dropdown__placeholder"},this.props.placeholder)}renderPopover(){return r.a.createElement("div",{id:this.props.dropdownId,className:"select-dropdown__options jq-dropdown"},this.props.options.map(e=>this.renderOption(e)))}renderOption(e){var t=this.props.selected===e.value,s=He("select-dropdown__option",{selected:t}),a="amortization"===this.props.dropdownId&&"qc"===window.DP.province?"0":e.value;return r.a.createElement("div",{key:e.value,className:s,onClick:this.handleSelect.bind(this,e),"data-value":a,style:{"--background-color":e.bgColor}},e.label)}}sr.propTypes={onSelect:je.PropTypes.func.isRequired,dropdownId:je.PropTypes.string.isRequired,selected:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number]),isDisabled:je.PropTypes.bool,placeholder:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number]),options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.number]),bgColor:je.PropTypes.string})).isRequired};var ar=sr;class ir extends r.a.Component{handleSelect(e){this.props.dispatch((e=>({type:"SET_SEARCH_SORT_ORDER",option:e}))(e.value)),this.props.dispatch(qt("1")),this.props.dispatch(Ot()),window.Dropdown("hide")}render(){var e=this.props.searchSortOrder.options.filter(e=>!1===e.hidden);return r.a.createElement(ar,{dropdownId:"sort-order-dropdown",options:e,selected:this.props.searchSortOrder.selected,onSelect:this.handleSelect.bind(this)})}}ir.propTypes={dispatch:je.PropTypes.func.isRequired,searchSortOrder:je.PropTypes.shape({selected:je.PropTypes.string,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired}).isRequired},ir=Object(m.b)(({searchSortOrder:e})=>({searchSortOrder:e}))(ir);var rr=g.createProviderWrappedComponent(e=>r.a.createElement(ir,e));class nr extends r.a.Component{handleSelect(e){this.props.dispatch({type:"SET_TESTIMONIALS_REGION_ID",regionId:e.value}),this.props.dispatch(ni("1")),this.props.dispatch(oi()),window.Dropdown("hide")}render(){return r.a.createElement(ar,{dropdownId:"testimonials-region-dropdown",options:this.props.options,selected:this.props.regionId,onSelect:this.handleSelect.bind(this)})}}nr.propTypes={dispatch:je.PropTypes.func.isRequired,regionId:je.PropTypes.string,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string})).isRequired},nr=Object(m.b)(({testimonialsRegion:e})=>{var{regionId:t}=e;return{regionId:t}})(nr);var or=g.createProviderWrappedComponent(e=>r.a.createElement(nr,e)),lr=e=>new Promise((t,s)=>{var a="".concat(window.DP.urls.proxyFeaturedHomes);d.a.ajax({url:a,data:e}).done(e=>{e||s(),t(e.listings)}).fail(s)}),cr={accessibility:!1,arrows:!0,dots:!1,responsive:[{breakpoint:900,settings:{arrows:!1,slidesToShow:2,slidesToScroll:2}},{breakpoint:1100,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}},{breakpoint:1300,settings:{arrows:!1,slidesToShow:4,slidesToScroll:4}}],slidesToShow:6,slidesToScroll:6,infinite:!0,speed:200,zIndex:1,prevArrow:".featured-properties__viewport__navigation-button--prev",nextArrow:".featured-properties__viewport__navigation-button--next"};class pr extends r.a.Component{constructor(e){super(e),this.state={isFirstElement:!0,isLastElement:!1,loaded:!1,properties:[],title:window.DP.isRental?this.props.titleRental:this.props.title}}fetchFeaturedHomes(){this.setState({loaded:!1}),lr(this.props.params).then(e=>{this.setState({properties:e})})}componentDidMount(){this.fetchFeaturedHomes()}componentDidUpdate(){if(!this.state.loaded){this.elements=d()(this.refs.elements);var e=Object.assign({},cr);di()(this.elements,e),this.elements.on("afterChange",this.handleSliderAfterChange.bind(this))}}handleSliderAfterChange(e,t,s){var a=0===s,i=cr.slidesToShow+s>=this.state.properties.length;this.setState({isFirstElement:a,isLastElement:i,loaded:!0})}render(){return 0===this.state.properties.length?this.renderPlaceholder():r.a.createElement("div",{className:"search-results-feature-properties"},r.a.createElement("div",{className:"featured-properties__wrapper"},r.a.createElement("div",{className:"featured-properties"},r.a.createElement("h2",{className:"featured-properties__title"},this.state.title),r.a.createElement("div",{className:"featured-properties__viewport"},r.a.createElement(dr,{isFirstElement:this.state.isFirstElement,isLastElement:this.state.isLastElement}),r.a.createElement("div",{className:"featured-properties__viewport__elements",ref:"elements"},this.state.properties.map((e,t)=>this.renderFeaturedProperty(e,t)))))))}renderFeaturedProperty(e,t){return r.a.createElement("div",{key:"featuredProperties:property:".concat(t),className:"featured-properties__property"},r.a.createElement("a",{href:e.url,className:"featured-properties__property__link",onClick:()=>{Li(e.id,"view_from_featured_listing"),Se.a.pushDynamicEvent("listing-featuredhomes-view-property",window.DP.context.pageType)}},r.a.createElement("img",{className:"featured-properties__property__image","data-lazy":"".concat(e.photo),alt:""}),this.renderOpenHouse(e.open_house,e.show_big_open_house),r.a.createElement("div",{className:"featured-properties__property__infos"},r.a.createElement("span",{className:"featured-properties__property__title"},e.address.city),r.a.createElement("div",{className:"featured-properties__property__meta"},r.a.createElement("span",{className:"featured-properties__property__price"},e.price.display)))))}renderOpenHouse(e,t){if("object"!=typeof e)return null;var s=He("featured-properties__property-open-house-tag",{"big-open-house":t});return r.a.createElement("div",{className:s},this.props.openHouse,t?r.a.createElement(Ge.a,{className:"featured-properties__big-open-house-balloons",src:"/build/img/svg/big-open-house-balloons.svg",cacheGetRequests:!0}):null)}renderPlaceholder(){return r.a.createElement("div",{className:"search-results-feature-properties search-results-feature-properties--placeholder"},r.a.createElement("div",{className:"featured-properties__wrapper"},r.a.createElement("div",{className:"featured-properties"},r.a.createElement("h2",{className:"featured-properties__title"},this.state.title),r.a.createElement("div",{className:"featured-properties__loading loading-dots"},r.a.createElement("div",{className:"loading-dots__dot"}),r.a.createElement("div",{className:"loading-dots__dot"}),r.a.createElement("div",{className:"loading-dots__dot"})))))}}var dr=({isFirstElement:e,isLastElement:t})=>{var s=He("featured-properties__viewport__navigation-button",{prev:!0,hidden:e}),a=He("featured-properties__viewport__navigation-button",{next:!0,hidden:t});return r.a.createElement("div",{className:"featured-properties__viewport__navigation"},r.a.createElement("div",{className:s,onClick:()=>{Se.a.pushDynamicEvent("listing-featuredhomes-arrow-left",window.DP.context.pageType)}},r.a.createElement(Ge.a,{className:"featured-properties__viewport__navigation-button__icon is-no-events",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:a,onClick:()=>{Se.a.pushDynamicEvent("listing-featuredhomes-arrow-right",window.DP.context.pageType)}},r.a.createElement(Ge.a,{className:"featured-properties__viewport__navigation-button__icon is-no-events",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})))};dr.propTypes={isFirstElement:je.PropTypes.bool.isRequired,isLastElement:je.PropTypes.bool.isRequired},pr.propTypes={title:je.PropTypes.string.isRequired,titleRental:je.PropTypes.string.isRequired,openHouse:je.PropTypes.string.isRequired,priceOnRequest:je.PropTypes.string.isRequired,params:je.PropTypes.object.isRequired};var hr=pr,ur=e=>new Promise((t,s)=>{var a="".concat(window.DP.urls.proxySimilarHomes);d.a.ajax({url:a,data:e}).done(e=>{e||s(),t(e.listings)}).fail(s)}),mr={accessibility:!1,arrows:!1,dots:!1,responsive:[{breakpoint:900,settings:{arrows:!1,slidesToShow:2,slidesToScroll:2}},{breakpoint:1100,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}},{breakpoint:1300,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}}],slidesToShow:3,slidesToScroll:3,zIndex:1,swipe:!1};class gr extends r.a.Component{constructor(e){super(e),this.state={loaded:!1,properties:[]}}fetchSimilarHomes(){this.setState({loaded:!1});var e=this.props.listingId;ur({listingId:e}).then(e=>{this.setState({properties:e})})}componentDidMount(){this.fetchSimilarHomes()}componentDidUpdate(){if(!this.state.loaded){this.elements=d()(this.refs.elements);var e=Object.assign({},mr);di()(this.elements,e)}}render(){return void 0===this.state.properties||this.state.properties.length<3?null:r.a.createElement("div",{className:"search-results-similar-properties"},r.a.createElement("div",{className:"similar-properties__wrapper"},r.a.createElement("div",{className:"similar-properties"},r.a.createElement("h2",{className:"similar-properties__title"},this.props.title),r.a.createElement("div",{className:"similar-properties__viewport"},r.a.createElement("div",{className:"similar-properties__viewport__elements",ref:"elements"},this.state.properties.map((e,t)=>this.renderSimilarProperty(e,t)))))))}renderSimilarProperty(e,t){return r.a.createElement("div",{key:"similarProperties:property:".concat(t),className:"similar-properties__property"},r.a.createElement("a",{href:e.url,className:"".concat("gtm-search-results-link-similar-property"," similar-properties__property__link")},r.a.createElement("img",{className:"similar-properties__property__image","data-lazy":"".concat(e.photo),alt:e.photos[0].alternative_text}),this.renderOpenHouse(e.open_house),r.a.createElement("div",{className:"similar-properties__property__infos"},r.a.createElement("span",{className:"similar-properties__property__title"},e.address.city),r.a.createElement("div",{className:"similar-properties__property__meta"},r.a.createElement("span",{className:"similar-properties__property__price"},e.price.display)))))}renderOpenHouse(e){return"object"!=typeof e?null:r.a.createElement("div",null,this.props.openHouse)}}gr.propTypes={title:je.PropTypes.string.isRequired,openHouse:je.PropTypes.string.isRequired,priceOnRequest:je.PropTypes.string.isRequired,listingId:je.PropTypes.string.isRequired};var _r=gr,br=(e,t,s,a)=>{var i=void 0!==a?a:0,r=((e,t)=>{switch(e){case"ab":return((e,t)=>e<1e5?.07*e:1e5*.07+(e-1e5)*t)(t,.03);case"mb":case"on":return t*(.05-.02);default:return.05*t}})(e,t)-i;return r*s+r};class vr extends r.a.Component{constructor(e){super(e),this.state={sliderCurrentValue:e.slider.startingPrice}}componentDidMount(){var e={start:[this.props.slider.startingPrice],connect:"lower",range:this.getDefaultSteps(),pips:{mode:"positions",values:[0,100],density:2},format:{to:Number,from:Number}};this.slider=es.a.create(this.refs.slider,e),this.displayHandleIcons(),this.slider.on("slide",this.handleSliderSlide.bind(this)),this.props.slider.isGtmOn&&this.slider.on("change",this.handleSliderChange.bind(this)),this.formatPipsAmounts()}getDefaultSteps(){var e={min:[this.props.slider.minimumPrice,2e4],"35%":[5e5,5e4],"90%":[2e6,1e5],max:[this.props.slider.maximumPrice]};return 3e5===this.props.slider.startingPrice&&(e["70%"]=[5e5,5e4],delete e["35%"]),e}componentWillUnmount(){this.slider.off("update"),this.slider.off("slide")}handleSliderSlide(e){this.setState({sliderCurrentValue:e}),d()(".savings-calculator .noUi-handle").html("")}handleSliderChange(e){Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"Use_SavingsCalculator",Math.round(e))}formatPipsAmounts(){d()(".savings-calculator .noUi-value").each((e,t)=>{d()(t).text(h.a.encodeCurrencyValue(d()(t).text(),{noDecimal:!0}))})}renderAmount(){return h.a.encodeCurrencyValue(br(this.props.slider.province,this.state.sliderCurrentValue,this.props.slider.taxes,this.props.slider.fixedFeeAmount),{noDecimal:!0})}getAnchorLabel(){return void 0===this.props.slider.anchor?null:"#".concat(this.props.slider.anchor)}render(){var e="widget"===this.props.slider.type,t=e?"":"js-savings-calculator",s=He("savings-calculator__wrapper",{widget:e});return r.a.createElement("div",{className:"savings-calculator__container"},r.a.createElement("a",{name:this.props.slider.anchor,className:"savings-calculator-anchor"}),r.a.createElement("div",{className:s},r.a.createElement("div",{className:"savings-calculator"},r.a.createElement("h2",{className:"savings-calculator__title"},this.props.slider.title),r.a.createElement("div",{className:"savings-calculator__content ".concat(t),"data-label":this.getAnchorLabel()},r.a.createElement("div",{className:"savings-calculator__slider"},r.a.createElement("div",{className:"savings-calculator__tooltip"},r.a.createElement("div",{className:"savings-calculator__slider__title"},this.props.slider.titleSlider),r.a.createElement("div",null,h.a.encodeCurrencyValue(this.state.sliderCurrentValue,{noDecimal:!0})),r.a.createElement("div",{className:"savings-calculator__slider__icon"})),r.a.createElement("div",{ref:"slider"})),r.a.createElement("ul",{className:"savings-calculator__results"},r.a.createElement("li",{className:"savings-calculator__results__label"},this.props.slider.resultsLabel),r.a.createElement("li",{className:"savings-calculator__results__amount"},this.renderAmount(),this.props.slider.isPurplebricks?r.a.createElement("sup",{className:"savings-calculator__results__cross"},"†"):"*"))),this.props.slider.disclaimer?r.a.createElement("div",{className:"savings-calculator__disclaimer"},r.a.createElement("div",{className:"savings-calculator__disclaimer-line"},this.props.slider.disclaimer)):null)))}displayHandleIcons(){d()(".savings-calculator .noUi-handle").prepend('<span class="savings-calculator__handle__icon-left"></span>'),d()(".savings-calculator .noUi-handle").append('<span class="savings-calculator__handle__icon-right"></span>')}}vr.propTypes={slider:je.PropTypes.shape({title:je.PropTypes.string.isRequired,titleSlider:je.PropTypes.string.isRequired,resultsLabel:je.PropTypes.string.isRequired,minimumPrice:je.PropTypes.number.isRequired,maximumPrice:je.PropTypes.number.isRequired,startingPrice:je.PropTypes.number.isRequired,province:je.PropTypes.string.isRequired,taxes:je.PropTypes.number.isRequired,type:je.PropTypes.string,locale:je.PropTypes.string.isRequired,disclaimer:je.PropTypes.string,anchor:je.PropTypes.string,isGtmOn:je.PropTypes.bool,calculate:je.PropTypes.string,isPurplebricks:je.PropTypes.bool,fixedFeeAmount:je.PropTypes.string}).isRequired};var yr=vr,fr=(s(31),s(303),()=>Array.from(c.a.get("map-viewed-listing-ids")||[])),Tr=e=>{var t=new Set(fr());t.add(e.id),c.a.set("map-viewed-listing-ids",Array.from(t))},Pr=e=>fr().includes(e.id),wr=e=>[[e.min_latitude,e.min_longitude],[e.max_latitude,e.max_longitude]];var Er=class{search(e){return this.lastRequest&&this.lastRequest.abort(),new Promise((t,s)=>{this.lastRequest=(e=>{var t=window.DP.urls.proxyMapSearch,s=Je(e);return d.a.ajax({url:t,data:s})})(e).done(t).fail(s)})}};var Cr=class{fetch(e,t={}){return this.lastRequest&&this.lastRequest.abort(),new Promise((s,a)=>{this.lastRequest=((e,t)=>{var s=Ke()(window.DP.urls.proxyListing,e);return t&&t.light&&(s=Ke()(window.DP.urls.proxyListingLight,e)),d.a.ajax({url:s,opts:t})})(e,t).done(s).fail(a)})}},Sr=s(107),Rr=s.n(Sr),Nr=/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,kr=(e,t)=>{var s=(e=>Ke()(window.DP.urls.proxyStats,e))(e),a={type:t};return d.a.ajax({method:"POST",url:s,data:a,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Lr=e=>{c.a.setBucket("duproprio-");var t=window.DP.ip;if(!window.DP.is_dev_env){var s=c.a.get("ddf-analytics-uuid");null!==s&&Nr.test(s)||(s=Rr.a.v4(),c.a.set("ddf-analytics-uuid",s));var a={listingId:e,DestinationID:"17377",EventType:"view",UUID:s="".concat(s,"-").concat("17377"),IP:t};return d.a.ajax({method:"GET",url:"//analytics.crea.ca/LogEvents.svc/LogEvents",data:a,crossDomain:!0,dataType:"jsonp"})}},qr="purplebricks"===window.DP.theme?"purplebricks":"duproprio",Or="http://www.openstreetmap.org/copyright",xr=window.DP.map.url_tile_provider,Dr={type:"map",ext:"png",minZoom:6,maxZoom:19},Mr=6,Ar=49999,Ir={center:new L.LatLng(0,0),attributionControl:!1,maxZoom:19,keyboard:!1},Br=1e3,Fr=Br/2,jr={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-house.svg"),iconSize:[32,31],className:"map-icon map-icon--house"},Vr={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-multiplex.svg"),iconSize:[29,28],className:"map-icon map-icon--multiplex"},Ur={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-terrain.svg"),iconSize:[32,31],className:"map-icon map-icon--terrain"},$r={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-commercial.svg"),iconSize:[41,25],className:"map-icon map-icon--commercial"},Gr={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-builder.svg"),iconSize:[32,31],className:"map-icon map-icon--builder"},Hr={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-big-open-house.svg"),iconSize:[20,31],className:"map-icon map-icon--big-open-house"},zr={1:jr,2:Vr,3:$r,4:Ur,5:jr,6:$r},Wr="regions",Kr="cities",Yr="type",Xr=4,Zr="house",Jr="condo",Qr="dp",en="ddf",tn="idx_treb",sn="idx_rahb",an="idx_rae",rn="idx_creb",nn="idx_treb_sold",on={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-flag-new.svg"),iconSize:[13,13],className:"map-icon__new-flag"},ln={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-flag-viewed.svg"),iconSize:[13,13],className:"map-icon__viewed-flag"},cn=15,pn=10,dn=1e4,hn=19,un={disableClusteringAtZoom:20,spiderfyOnMaxZoom:!1,polygonOptions:{stroke:!0,color:"#333",weight:0,fillColor:"#333",fillOpacity:.35,dashArray:"2,2",className:"listing-cluster"}},mn={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-cluster.svg"),popupAnchor:[0,-20],iconSize:[32,39]},gn={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-big-open-house-cluster.svg"),popupAnchor:[0,-20],iconSize:[40,50]},_n={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-big-open-house-cluster.svg"),popupAnchor:[0,-20],iconSize:[50,70]},bn={iconUrl:"/build/img/svg/".concat(qr,"/map/icn-marker-group.svg"),popupAnchor:[0,-20],iconSize:[42,32]},vn=e=>({19:30,18:30,17:30,16:30,15:30,14:50,13:80,12:80,11:80,10:80,9:80,8:80,7:80,6:80,5:80,4:80,3:80,2:80,1:80}[e]),yn={position:"bottomright",prefix:!1},fn={maxWidth:300,minWidth:300,autoPan:!0,autoPanPaddingTopLeft:new L.Point(10,100),autoPanPaddingBottomRight:new L.Point(10,10),offset:new L.Point(-60,-18),closeButton:!1,className:"map-popup"},Tn={maxWidth:200,minWidth:200,autoPan:!0,autoPanPaddingTopLeft:new L.Point(10,100),autoPanPaddingBottomRight:new L.Point(10,10),offset:new L.Point(-11,-18),closeButton:!1,className:"map-popup-regions"},Pn=200,wn=e=>({6:.05,7:.05,8:.05,9:.05,10:.1,11:.15,12:.25,13:.51,14:1.55,15:3.6,16:7.55,17:16,18:31.6,19:64}[e]),En="search_result_map_click",Cn="search_result_map_hover",Sn="in",Rn="out",Nn="both",kn=9,Ln=e=>{var t={3:11,4:10,5:10,6:12,7:10,12:10,13:12,14:10,15:11,16:12,17:10,31:11,115:11,257:11,344:10,347:11,350:10,352:10,353:11,355:11,356:11,41:10,43:10,44:10,47:10,241:10,242:10,248:10}[e];return void 0===t&&(t=kn),t},qn=e=>-1!==["qc","on","ab"].indexOf(e),On=(e,t)=>!1!==t&&0!==t?e:e.replace(/\.svg/g,"-grayscale.svg"),xn=(e,t)=>Object.assign({},un,{animate:!1,chunkedLoading:!0,chunkInterval:500,chunkDelay:100,iconCreateFunction:s=>((e,t,s)=>{var a;if(s.getZoom()<cn){var i=e.getChildCount().toString();(a=s.options.isGvlMode?Object.assign({},_n):Object.assign({},mn)).html="".concat(An(a),' <div class="map-cluster__label">').concat(i,"</div>"),a.className=He("map-cluster",{"long-label":i.length>2,"big-open-house":s.options.isGvlMode})}else if((a=s.options.isGvlMode?Object.assign({},gn):Object.assign({},bn)).html=An(a),a.className=He("map-cluster",{group:!0}),!s.options.isGvlMode){var r=e.getAllChildMarkers();r.every(e=>Pr(e.options.listing))?a.html+=Mn("viewed"):r.find(e=>e.options.listing.is_new)&&(a.html+=Mn("new"))}return a.html=On(a.html,t),delete a.iconUrl,new L.DivIcon(a)})(s,t,e),maxClusterRadius:e=>vn(e)}),Dn=(e,t)=>{var s,a=e.isRental||e.is_rental;return s=t.options.isGvlMode?Hr:!a&&e.is_builder&&e.group!==Xr?Gr:zr[e.group]||jr,(s=Object.assign({},s)).html='<img src="'.concat(s.iconUrl,'" width="').concat(s.iconSize[0],'" height="').concat(s.iconSize[1],'" />'),delete s.iconUrl,t.options.isGvlMode||(Pr(e)?s.html+=Mn("viewed"):e.is_new&&(s.html+=Mn("new"))),s.html=On(s.html,e.in_search),new L.DivIcon(s)},Mn=(e,t)=>{var{className:s,iconUrl:i,iconSize:r}=a["LISTING_".concat(e.toUpperCase(),"_FLAG_OPTIONS")],[n,o]=r;return'<img class="'.concat(t||s,'" src="').concat(i,'" width="').concat(n,'" height="').concat(o,'" />')},An=e=>'<img src="'.concat(e.iconUrl,'" width="').concat(e.iconSize[0],'" height="').concat(e.iconSize[1],'" />'),In=(e,t,s,a,i,r,n)=>{var o=((e,t,s,a)=>{var i="";switch(e.source){case en:i=s;break;case tn:case sn:case an:case rn:case nn:i=a;break;default:i=t}return i=i.replace(/\/$/,""),"".concat(i,"/").concat(e.photo_primary.uri)})(e,t,s,a),l=e.is_sold?e.price_sold.display:((e,t)=>{if(!e.price)return null;var s=e.price.display;return e.is_sold?s=e.hasOwnProperty("price_sold")?e.price_sold.display:null:0!==e.price.raw&&null!==e.price.raw||(s=t),s})(e,i),c='\n        <div class="map-popup__listing">\n            <div class="map-popup__photo'.concat(e.is_sold?" sold-tag-container":"",'">\n                <img class="map-popup__photo-image" src="').concat(o,'" alt="').concat(e.photo_primary.alternative_text,'}">\n                ').concat(e.is_sold?'<div class="sold-tag sold-tag--small">'.concat(r,"</div>"):"",'\n            </div>\n\n            <div class="map-popup__infos">\n                <div class="map-popup__infos-content">\n                    ').concat(e.is_sold?'<span class="map-popup__price-label">'.concat(n,"</span>"):"",'\n                    <div class="map-popup__price">\n                        ').concat(l||"","\n                        ").concat(Pr(e)?Mn("viewed","map-popup__viewed-flag"):"","\n                    </div>\n                    ").concat((e=>{var t='<div class="map-popup__title">'.concat(e.type,"</div>");return"qc"!==window.DP.province&&(t=""),t})(e),'\n                    <div class="map-popup__address">').concat(e.address.street?e.address.street:e.address.city,"</div>\n                </div>\n            </div>\n        </div>\n    ");return d()(c).data("listing",e)[0]},Bn=()=>'\n        <div class="map-popup__listing map-popup__listing--loading">\n            <div class="loading-dots">\n                <div class="loading-dots__dot"></div>\n                <div class="loading-dots__dot"></div>\n                <div class="loading-dots__dot"></div>\n            </div>\n        </div>\n    ';var Fn=class{constructor(e,t,{attribution:s,photoBaseUrl:a,photoBaseUrlDdf:i,photoBaseUrlIdx:r,initialContext:n,regions:o,priceOnRequest:l,soldLabel:c=null,soldPriceLabel:p=null}){if(this.map=new L.Map(e,Object.assign({},Ir,t)),this.mapSearch=new Er,this.listingFetcher=new Cr,this.skipFirstListingFetchOnMapAjustment=!1,n&&(n.center&&n.zoomLevel&&(this.map.setView(n.center,n.zoomLevel),this.skipFirstListingFetchOnMapAjustment=!0),n.bounds)){var d=new L.LatLngBounds(n.bounds);this.map.setView(d.getCenter(),Mr)}this.mapInitializationComplete=!1,this.photoBaseUrl=a,this.photoBaseUrlDdf=i,this.photoBaseUrlIdx=r,this.priceOnRequest=l,this.hasTooManyListingsError=!1,this.isPopupBeingUsed=null,this.regions=o,this.soldLabel=c,this.soldPriceLabel=p,this.fetchedListings=[],this.trackedListingIds={},this.trackedListingIds[En]=[],this.trackedListingIds[Cn]=[],this.handleMapMoveEnd=Xe(this.handleMapMoveEnd.bind(this),Br),this.updateLastSearchBounds=Xe(this.updateLastSearchBounds.bind(this),Fr),this.configureTileProvider(),this.configureAttributionControl(s)}configureTileProvider(){new L.TileLayer(xr,Dr).addTo(this.map)}configureAttributionControl(e){this.attributionControl=new L.Control.Attribution(yn),this.attributionControl.addAttribution(e),this.attributionControl.addTo(this.map),this.map.whenReady(()=>this.updateAttributionLink())}getBounds(){return this.map.getBounds()}bindPopupEvents(e,t){var s=d()(e._container);this.isPopupBeingUsed=t,s.on("mouseover",this.handlePopupMouseOver.bind(this)),s.on("mouseout",this.handlePopupMouseOut.bind(this)),s.on("click",".map-popup__listing",this.handlePopupListingClick.bind(this))}bindMarkerClusterEvents(e){e.on("mouseover",e=>this.handleMarkerMouseOver(e)),e.on("mouseout",()=>this.handleMarkerMouseOut()),e.on("click",e=>this.handleMarkerClick(e)),e.on("clusterclick",e=>this.handleClusterMouseClick(e)),e.on("clustermouseover",e=>this.handleClusterMouseOver(e)),e.on("clustermouseout",()=>this.handleClusterMouseOut())}bindRegionMarkerEvents(e){e.on("mouseover",e=>this.handleRegionMarkerMouseOver(e)),e.on("mouseout",()=>this.handleRegionMarkerMouseOut()),e.on("click",e=>this.handleRegionMarkerClick(e))}handleMapZoomEnd(){this.map.closePopup(),this.isPopupBeingUsed=null}handleMapClick(){this.map.closePopup(),this.isPopupBeingUsed=null}handleMapMoveEnd(){if(this.updateAttributionLink(),this.onMapMoveEnd(this.map),void 0!==this.forceScope||this.mapInitializationComplete&&!this.guessAsTooManySearchResults(this.initialSearchCriteria)){var e=this.determineScopeToFetch();if(null!==e){var t=Object.assign({},this.initialSearchCriteria,this.getPaddedBounds());t.search_scope=e,this.fetchListings(t)}}this.countVisibleInSearchListings()}handlePopupClosingDelayTimeout(){this.isPopupBeingUsed||this.map.closePopup()}handlePopupMouseOver(){this.isPopupBeingUsed="marker-over"}handlePopupMouseOut(){this.isPopupBeingUsed=null,this.enqueuePopupClosingCheck()}handlePopupListingClick(e){var t=d()(e.currentTarget).data("listing");t&&this.selectListing(t)}initOpenListingPopup(e){var{listing:t}=e.layer.options,s=Object.assign({},fn,{listing:t.id}),a=new L.Rrose(s).setContent(Bn).setLatLng(e.latlng).openOn(this.map);this.bindPopupEvents(a,t.id),this.fetchedListings[t.id]?this.openListingPopup(this.fetchedListings[t.id],e,a,s):this.listingFetcher.fetch(t.id,{light:!0}).then(t=>{this.fetchedListings[t[0].id]=t[0],this.openListingPopup(t[0],e,a,s)}).catch(()=>{})}openListingPopup(e,t,s,a){if(this.isPopupBeingUsed){var i=In(e,this.photoBaseUrl,this.photoBaseUrlDdf,this.photoBaseUrlIdx,this.priceOnRequest,this.soldLabel,this.soldPriceLabel);s=new L.Rrose(a).setContent(i).setLatLng(t.latlng).openOn(this.map),this.bindPopupEvents(s,e.id),e.source===Qr&&this.trackListingView(e.id,Cn)}}openListingDrawer(e){var{listing:t}=e.layer.options;this.selectListing(t)}handleMarkerMouseOver(e){L.Browser.mobile||this.initOpenListingPopup(e)}handleMarkerMouseOut(){L.Browser.mobile||(this.enqueuePopupClosingCheck(),this.isPopupBeingUsed=null)}handleMarkerClick(e){L.Browser.mobile?this.isPopupBeingUsed===e.layer.options.listing.id?this.openListingDrawer(e):this.initOpenListingPopup(e):this.openListingDrawer(e),e.layer.options.listing.is_sold&&Se.a.pushDynamicEvent("sold-search-map-click-sold-listing","".concat(window.DP.context.pageType,"_Map"))}initCreateMultipleListingsClusterPopup(e){var t=e.layer.getAllChildMarkers().map(e=>e.options.listing),s=Object.assign({},fn,{listings:t}),a=new L.Rrose(s).setContent(Bn).setLatLng(e.latlng).openOn(this.map),i=[],r=[];for(var n of(this.bindPopupEvents(a,"listings-marker"),t))this.fetchedListings[n.id]?r.push(this.fetchedListings[n.id]):i.push(n.id);i.length>0?this.listingFetcher.fetch(i,{light:!0}).then(t=>{for(var i of t)this.fetchedListings[i.id]=i;r=r.concat(t),this.createMultipleListingsClusterPopup(r,e,a,s)}).catch(()=>{}):this.createMultipleListingsClusterPopup(r,e,a,s)}createMultipleListingsClusterPopup(e,t,s,a){if(this.isPopupBeingUsed){var i,r,n,o,l,c,p,h,u=(i=e,r=this.photoBaseUrl,n=this.photoBaseUrlDdf,o=this.photoBaseUrlIdx,l=this.priceOnRequest,c=this.soldLabel,p=this.soldPriceLabel,h=d()('<div class="map-popup__listings"></div>'),i.forEach(e=>{h.append(In(e,r,n,o,l,c,p))}),h[0]);s=new L.Rrose(a).setContent(u).setLatLng(t.latlng).openOn(this.map),this.bindPopupEvents(s,"listings-cluster");var m=e.filter(e=>e.source===Qr).map(e=>e.id);m.length>0&&this.trackListingView(m.join(","),Cn)}}handleClusterMouseClick(e){this.map.getZoom()>=hn&&this.initCreateMultipleListingsClusterPopup(e)}handleClusterMouseOver(e){this.map.getZoom()<cn||this.initCreateMultipleListingsClusterPopup(e)}handleClusterMouseOut(){this.enqueuePopupClosingCheck(),this.isPopupBeingUsed=null}handleRegionMarkerMouseOver(e){var{region:t}=e.target.options,s=(e=>{var t='<div class="map-popup__regions">\n        '.concat(e.name,"\n    </div>");return d()(t).data("listing",e)[0]})(t),a="region-".concat(t.id),i=new L.Rrose(Tn).setContent(s).setLatLng(e.latlng).openOn(this.map);this.bindPopupEvents(i,a)}handleRegionMarkerMouseOut(){this.enqueuePopupClosingCheck()}handleRegionMarkerClick(e){var t=this.map.getZoom(),s=Ln(e.target.options.region.id);t>=s&&(s=t+1),this.map.setView(e.latlng,s)}addMarkerAndCenter(e,t){var{latitude:s,longitude:a}=e,i=new L.LatLng(s,a),r=Dn(e,this.map),n=new L.Marker(i,{icon:r,listing:e});n.setZIndexOffset(dn),n.addTo(this.map),this.setPositionAndZoom(s,a,t)}setPositionAndZoom(e,t,s){var a=new L.LatLng(e,t);this.map.setView(a,s)}enqueuePopupClosingCheck(){this.popupClosingTimeout&&clearTimeout(this.popupClosingTimeout),this.popupClosingTimeout=setTimeout(this.handlePopupClosingDelayTimeout.bind(this),Pn)}hasMetaSearchBounds(e){return"object"==typeof e&&e.hasOwnProperty("search_bounds")&&e.search_bounds.hasOwnProperty("max_longitude")&&e.search_bounds.hasOwnProperty("min_longitude")&&e.search_bounds.hasOwnProperty("max_latitude")&&e.search_bounds.hasOwnProperty("min_latitude")}assignMapBoundsBasedOnMeta(e){if(!this.mapInitializationComplete&&this.hasMetaSearchBounds(e)){var{max_latitude:t,max_longitude:s,min_latitude:a,min_longitude:i}=e.search_bounds,r=new L.LatLng(a,s),n=new L.LatLng(t,i),o=new L.latLngBounds(r,n);this.map.fitBounds(o),this.skipFirstListingFetchOnMapAjustment=!0}}createRegionsLayer(e=!1){if(!this.regionLayer){var t=[];this.regions.forEach(e=>{var{latitude:s,longitude:a}=e,i=new L.LatLng(s,a),r=this.map.options.isGvlMode?Object.assign({},gn):Object.assign({},mn);r.html="".concat(An(r),' <div class="map-cluster__label"></div>'),r.className="map-cluster";var n=new L.DivIcon(r),o=new L.Marker(i,{icon:n,region:e});this.bindRegionMarkerEvents(o),t.push(o)}),this.regionLayer=new L.featureGroup(t)}this.regionLayer.addTo(this.map),e&&this.map.fitBounds(this.regionLayer.getBounds())}removeRegionMarkers(){this.regionLayer&&this.map.hasLayer(this.regionLayer)&&this.map.removeLayer(this.regionLayer)}addMarkers(e,t,s=!1){t.search_scope===Sn?(this.addInSearchMarkers(e,s),this.deactivateIsLoading()):t.search_scope===Rn&&this.addOutSearchMarkers(e)}addInSearchMarkers(e,t=!1){var s=[];this.inSearchMarkerClusterGroup?this.inSearchMarkerClusterGroup.clearLayers():(this.inSearchMarkerClusterGroup=new L.MarkerClusterGroup(xn(this.map,!0)),this.bindMarkerClusterEvents(this.inSearchMarkerClusterGroup),this.inSearchMarkerClusterGroup.addTo(this.map)),e.length>Ar?this.initHasTooManyMarkers():(this.hasTooManyListingsError=!1,e.forEach(e=>{var{latitude:t,longitude:a}=e,i=new L.LatLng(t,a),r=Dn(e,this.map),n=new L.Marker(i,{icon:r,listing:e});n.setZIndexOffset(dn),s.push(n)}),this.inSearchMarkerClusterGroup.addLayers(s),t&&this.inSearchMarkerClusterGroup.getBounds().isValid()&&this.inSearchMarkerClusterGroup.getLayers().length>0&&this.map.fitBounds(this.inSearchMarkerClusterGroup.getBounds()),this.updateLastSearchBounds(Sn),this.removeRegionMarkers(),this.handleMapMoveEnd(),this.countVisibleInSearchListings())}addOutSearchMarkers(e){var t=[];this.countVisibleInSearchListings()+e.length>Ar?this.outSearchMarkerClusterGroup&&this.outSearchMarkerClusterGroup.clearLayers():(this.outSearchMarkerClusterGroup?this.outSearchMarkerClusterGroup.clearLayers():(this.outSearchMarkerClusterGroup=new L.MarkerClusterGroup(xn(this.map,!1)),this.bindMarkerClusterEvents(this.outSearchMarkerClusterGroup),this.outSearchMarkerClusterGroup.addTo(this.map)),e.forEach(e=>{var{latitude:s,longitude:a}=e,i=new L.LatLng(s,a),r=Dn(e,this.map),n=new L.Marker(i,{icon:r,listing:e});t.push(n)}),(this.skipFirstListingFetchOnMapAjustment||this.mapInitializationComplete||0===this.inSearchMarkerClusterGroup.getLayers().length)&&this.outSearchMarkerClusterGroup.addLayers(t),this.updateLastSearchBounds(Rn),this.removeRegionMarkers())}initHasTooManyMarkers(e=!1){this.hasTooManyListingsError=!0,this.mapInitializationComplete=!0,this.lastInSearchBounds=null,this.deactivateIsLoading(),this.onMapMoveEnd(this.map),this.createRegionsLayer(e),this.countVisibleInSearchListings()}refresh(){this.map.invalidateSize(!1)}updateAttributionLink(){var e=this.attributionControl.getContainer().querySelector("a");e.setAttribute("target","_blank"),e.setAttribute("href","".concat(Or))}selectListing(e){this.onListingSelect&&(L.Browser.mobile&&this.activateIsLoading(),e.source===Qr&&this.trackListingView(e.id,En),this.listingFetcher.fetch(e.id).then(e=>{this.onListingSelect(e),this.refreshMapIcons(),L.Browser.mobile&&this.deactivateIsLoading(),this.isPopupBeingUsed=null}).catch(()=>{}))}refreshMapIcons(){this.map.eachLayer(e=>{e instanceof L.Marker&&e.options.listing&&e.setIcon(Dn(e.options.listing,this.map)),e instanceof L.MarkerCluster&&e._updateIcon()})}bindMoveEnd(){this.map.on("moveend",this.handleMapMoveEnd.bind(this)),this.map.on("zoomend",this.handleMapZoomEnd.bind(this)),this.map.on("click",this.handleMapClick.bind(this))}getPaddedBounds(){var e=wn(this.map.getZoom()),t=this.map.getBounds().pad(e);return{min_latitude:t.getSouth(),max_latitude:t.getNorth(),min_longitude:t.getWest(),max_longitude:t.getEast()}}fetchListings(e,t=!1){return e.search_scope===Sn&&this.activateIsLoading(),this.mapSearch.search(e).then(e=>{e.hasOwnProperty("data")&&e.data.length>0?this.addMarkers(e.data,e.meta,t):this.deactivateIsLoading(),this.mapInitializationComplete=!0},()=>{})}hasGeoCriterias(e){return e.hasOwnProperty(Wr)||e.hasOwnProperty(Kr)}consideredWideSearch(e){return!this.hasGeoCriterias(e)&&!e.hasOwnProperty("is_builder")&&!e.hasOwnProperty("is_featured_home")&&!e.hasOwnProperty("is_open_house")&&!e.hasOwnProperty("has_virtual_tour")&&(!e.hasOwnProperty(Yr)||e.hasOwnProperty(Yr)&&e.type.length>1||e.hasOwnProperty(Yr)&&(-1!==e.type.indexOf(Zr)||-1!==e.type.indexOf(Jr)))}determineScopeToFetch(){var e=this.map.getBounds(),t=this.map.getZoom(),s=null;return void 0===this.forceScope||-1===this.forceScope.indexOf(Sn)&&-1===this.forceScope.indexOf(Rn)||(s=this.forceScope),s&&s!==Sn||this.lastInSearchBounds&&this.lastInSearchBounds.contains(e)?s&&s!==Rn||!(t>kn)||!this.hasGeoCriterias(this.initialSearchCriteria)||this.lastOutSearchBounds&&this.lastOutSearchBounds.contains(e)||(s=Rn):s=Sn,s}guessAsTooManySearchResults(e){return qn(window.DP.province)&&this.map.getZoom()<kn&&(!this.inSearchMarkerClusterGroup||this.inSearchMarkerClusterGroup&&0===this.inSearchMarkerClusterGroup.getLayers().length)&&this.consideredWideSearch(e)}updateLastSearchBounds(e){var t=wn(this.map.getZoom()),s=this.map.getBounds().pad(t);e===Sn?this.lastInSearchBounds=s:this.lastOutSearchBounds=s}countVisibleInSearchListings(){var e;if(this.hasTooManyListingsError)e=Ar+1;else if(this.inSearchMarkerClusterGroup){var t=this.map.getBounds();e=this.inSearchMarkerClusterGroup.getLayers().reduce((e,s)=>t.contains(s.getLatLng())?e+1:e,0)}return this.onVisibleInSearchListingCountChange(e),e}trackListingView(e,t){this.trackedListingIds[t].includes(e)||(this.trackedListingIds[t].push(e),kr(e,t))}};class jn extends r.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleButtonClick(){this.setState({showPopover:!this.state.showPopover}),this.props.isSoldContext&&Se.a.pushDynamicEvent("sold-search-map-click-sold-legend","".concat(window.DP.context.pageType,"_Map"))}handlePopoverOuterClick(){this.setState({showPopover:!1})}render(){return r.a.createElement("div",{className:"map-legend"},this.renderButton(),this.renderPopover())}renderButton(){var e=He("map-legend__button",{active:this.state.showPopover});return r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.buttonLabel)}renderPopover(){if(!this.state.showPopover)return null;var{itemLabels:e}=this.props;return r.a.createElement(Kt,{onOuterClick:this.handlePopoverOuterClick.bind(this)},r.a.createElement("div",{className:"map-legend__popover"},r.a.createElement("div",{className:"map-legend__popover-content"},Object.keys(e).map(t=>this.renderItem(e,t))),r.a.createElement("div",{className:"map-legend__popover-arrow-container"},r.a.createElement("div",{className:"map-legend__popover-arrow"}))))}renderItem(e,t){if(!e[t].show)return null;var s="purplebricks"===window.DP.theme?"purplebricks":"duproprio";return r.a.createElement("div",{className:"map-legend__popover-content-item",key:t},r.a.createElement(Ge.a,{className:"map-legend__popover-content-item-icon",src:"/build/img/svg/".concat(s,"/map/").concat(e[t].icon),cacheGetRequests:!0}),r.a.createElement("span",{className:"map-legend__popover-content-item-label"},e[t].label))}}jn.propTypes={buttonLabel:je.PropTypes.string.isRequired,itemLabels:je.PropTypes.array.isRequired,isSoldContext:je.PropTypes.bool};var Vn=jn,Un=({listing:e,labels:t})=>{if(e.is_rental)return null;var{bedrooms:s,bathroomsAndHalfBaths:a,livingSpace:i,lotSize:n}=t;return r.a.createElement("div",{className:"map-drawer__characteristics"},((e,t)=>0===e.characteristics.main.bedrooms_display?null:r.a.createElement("span",{className:"map-drawer__characteristics__item"},r.a.createElement(Ge.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-bedrooms.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),e.characteristics.main.bedrooms_display))(e,s),((e,t)=>{if(0===e.characteristics.main.nb_bathrooms)return null;var s=[e.characteristics.main.nb_bathrooms];return 0!==e.characteristics.main.nb_half_bathrooms&&s.push(e.characteristics.main.nb_half_bathrooms),r.a.createElement("span",{className:"map-drawer__characteristics__item"},r.a.createElement(Ge.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-bathrooms.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),s.join(" + "))})(e,a),((e,t)=>e.characteristics.main.living_space?r.a.createElement("span",{className:"map-drawer__characteristics__item"},r.a.createElement(Ge.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-building-dimensions.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),r.a.createElement("span",{className:"map-drawer__characteristics-long-number-value"},e.characteristics.main.living_space.display_short)):null)(e,i),((e,t)=>e.characteristics.main.lot_size?r.a.createElement("span",{className:"map-drawer__characteristics__item"},r.a.createElement(Ge.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-lot-dimensions.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),r.a.createElement("span",{className:"map-drawer__characteristics-long-number-value"},e.characteristics.main.lot_size.display_short)):null)(e,n))};Un.propTypes={listing:je.PropTypes.object,labels:je.PropTypes.object.isRequired};var $n=Un,Gn={accessibility:!1,arrows:!1,lazyLoad:"ondemand",infinite:!1,slidesToShow:1,speed:200,zIndex:1};class Hn extends r.a.Component{constructor(e){super(e),this.photoSize=gi(),this.buildPhotos(e.photos),this.state={activePhotoIndex:0,listingId:e.listingId}}componentDidMount(){this.createSlider()}static getDerivedStateFromProps(e,t){var s=t;return e.listingId!==t.listingId&&(s.listingId=e.listingId,s.activePhotoIndex=0),s}componentDidUpdate(e){e.listingId!==this.props.listingId&&(this.buildPhotos(this.props.photos),this.createSlider())}handleNextButtonClick(){this.photosElement.slick("slickNext")}handlePreviousButtonClick(){this.photosElement.slick("slickPrev")}handleSliderAfterChange(e,t,s){this.setState({activePhotoIndex:s})}render(){var e=0!==this.state.activePhotoIndex,t=this.state.activePhotoIndex!==this.photos.length-1;return this.buildPhotos(this.props.photos),r.a.createElement("div",{className:"map-drawer__photo-viewer"},r.a.createElement(zn,{showPreviousButton:e,showNextButton:t,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),this.renderPhotos())}renderPhotos(){return r.a.createElement("div",{className:"map-drawer__photo-viewer-photos",key:"photoViewer:photos:".concat(this.props.listingId),ref:e=>this.photosElement=d()(e)},Array.from(this.photos).map((e,t)=>this.renderPhoto(e,t)))}renderPhoto(e,t){return r.a.createElement("div",{key:"drawerPhotoViewer:photo:".concat(t),className:"map-drawer__photo-viewer-slide"},this.renderAction(t),r.a.createElement("img",{"data-lazy":e.url,alt:e.alternative_text}))}renderAction(e){return this.photos.length<=3||e<this.photos.length-1?null:r.a.createElement("div",{className:"map-drawer__photo-viewer-action"},r.a.createElement("a",{className:"map-drawer__photo-viewer-action-link",href:this.props.url},this.viewAllPhotosLabel))}createSlider(){di()(this.photosElement,Gn),this.photosElement.on("afterChange",this.handleSliderAfterChange.bind(this))}buildPhotos(e){var t,s,a,i=this.props.photoBaseUrl.replace(/\/$/,"");this.photos=(t=e,s=t.find(e=>e.is_primary),a=t.filter(e=>!e.is_primary).slice(0,3),[s].concat(a)).map(e=>({alternative_text:e.alternative_text,url:"".concat(i,"/").concat(e.formats[this.photoSize])})),this.viewAllPhotosLabel=Ke()(this.props.viewAllPhotosLabel,e.length)}}var zn=({onPreviousButtonClick:e,onNextButtonClick:t,showPreviousButton:s,showNextButton:a})=>{var i=s?r.a.createElement("div",{onClick:e,className:"map-drawer__photo-viewer-navigation-button map-drawer__photo-viewer-navigation-button--prev"},r.a.createElement(Ge.a,{className:"map-drawer__photo-viewer-navigation-button-icon",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})):null,n=a?r.a.createElement("div",{onClick:t,className:"map-drawer__photo-viewer-navigation-button map-drawer__photo-viewer-navigation-button--next"},r.a.createElement(Ge.a,{className:"map-drawer__photo-viewer-navigation-button-icon",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})):null;return r.a.createElement("div",{className:"map-drawer__photo-viewer-navigation"},i,n)};zn.propTypes={showPreviousButton:je.PropTypes.bool.isRequired,showNextButton:je.PropTypes.bool.isRequired,onPreviousButtonClick:je.PropTypes.func.isRequired,onNextButtonClick:je.PropTypes.func.isRequired},Hn.propTypes={listingId:je.PropTypes.string.isRequired,photos:je.PropTypes.arrayOf(je.PropTypes.shape({formats:je.PropTypes.object.isRequired,is_primary:je.PropTypes.bool.isRequired,alternative_text:je.PropTypes.string.isRequired})).isRequired,viewAllPhotosLabel:je.PropTypes.string.isRequired,photoBaseUrl:je.PropTypes.string.isRequired,url:je.PropTypes.string.isRequired};var Wn=Hn,Kn=(e,t,s=null)=>{var a=(e=>Ke()(window.DP.urls.proxyListingFavourite,e))(t);return d.a.ajax({method:e,url:a,data:s,statusCode:{401:()=>{var a="PUT"===e&&s.hasOwnProperty("note")?"add-note":"add-favorite";((e,t)=>{var s=window.DP.urls.login,a=window.location.href.replace(window.location.hash,""),i="".concat(a,"#listing-").concat(e),r="do=".concat(t,"&code=").concat(e,"&listing=").concat(e,"&url-back=").concat(encodeURIComponent(i));window.location.href="".concat(s,"?").concat(r)})(t,a)}},beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Yn=e=>Kn("POST",e,{note:""}),Xn=e=>Kn("DELETE",e),Zn=(e,t)=>Kn("PUT",e,{note:t}),Jn=e=>({type:"TOGGLE_LISTING_FAVOURITE",listingId:e}),Qn=(e,t)=>({type:"UPDATE_LISTING_FAVOURITE_NOTE",listingId:e,note:t});class eo extends r.a.Component{constructor(e){super(e),this.handleCreateFavourite=Xe(this.handleCreateFavourite.bind(this),400),this.handleRemoveFavourite=Xe(this.handleRemoveFavourite.bind(this),400),this.state={disabled:!1,hover:!1}}handleClick(){this.props.dispatch(Jn(this.props.listingId)),this.props.active?this.handleRemoveFavourite():(this.handleCreateFavourite(),Li(this.props.listingId,"add_to_favourites")),this.setState({hover:!1})}handleCreateFavourite(){Yn(this.props.listingId).catch(this.handleFavouriteFailed.bind(this)),Se.a.pushDynamicEvent("listing-clickfavourite-add",window.DP.context.pageType)}handleRemoveFavourite(){Xn(this.props.listingId).catch(this.handleFavouriteFailed.bind(this)),Se.a.pushDynamicEvent("listing-clickfavourite-remove",window.DP.context.pageType)}handleFavouriteFailed(){this.setState({disabled:!0}),this.props.dispatch(Jn(this.props.listingId))}handleMouseEnter(){this.setState({hover:!0})}handleMouseLeave(){this.setState({hover:!1})}render(){var e,t,s=this.props.active,a=this.state.hover,i=this.state.disabled,n=this.props.boxShadow,o=s?this.props.labelRemoveFromFavourites:this.props.labelAddToFavourites,l=He("favourite-toggle-button",{active:s,hover:a,disabled:i,withBoxShadow:n,["at".concat(this.props.location)]:!0}),c="gtm-listing-link-favorite";return"SearchResultsListings"===this.props.location&&(c="gtm-search-results-link-favorite"),r.a.createElement("button",{className:"".concat(l," ").concat(c),onClick:this.handleClick.bind(this),onMouseEnter:this.handleMouseEnter.bind(this),onMouseLeave:this.handleMouseLeave.bind(this),"aria-label":"".concat(o)},r.a.createElement(Ge.a,{className:"favourite-toggle-button__icon",src:(e=this.props.boxShadow,t="/build/img/svg/icn-heart","".concat(t,e?"-shadow.svg":".svg")),cacheGetRequests:!0}))}}eo.propTypes={dispatch:je.PropTypes.func.isRequired,favouriteListingIds:je.PropTypes.arrayOf(je.PropTypes.string).isRequired,listingId:je.PropTypes.string.isRequired,active:je.PropTypes.bool,boxShadow:je.PropTypes.bool,location:je.PropTypes.string.isRequired,labelAddToFavourites:je.PropTypes.string.isRequired,labelRemoveFromFavourites:je.PropTypes.string.isRequired};var to=eo=Object(m.b)(({listingsFavourites:e},{listingId:t})=>{var{favouriteListingIds:s}=e,a=s.includes(t);return{favouriteListingIds:s,active:a}})(eo),so=g.createProviderWrappedComponent(e=>r.a.createElement(to,e)),ao=(e,t,s)=>{var a="",i="fr"===window.DP.lang?0:1,r=t.getDate(),n=t.getMonth(),o=t.getFullYear(),l=[["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["January","February","March","April","May","June","July","August","September","October","November","December"]];switch(e){case"day_number":a=r;break;case"month":a=[["janv.","févr.","mars","avr.","mai","juin","juill.","août","sept.","oct.","nov.","déc."],["Jan.","Feb.","March","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."]][i][n];break;case"year":a=o;break;case"hour":a=s;break;case"full_date":a="fr"===window.DP.lang?r.toString().concat(" ",l[i][n]," ",o):l[i][n].concat(" ",ro(r)," ",o)}return a},io=e=>(e<10?0:"").toString().concat(e.toString()),ro=e=>{var t=e.toString();return e+(t=["th","st","nd","rd","th","th","th","th","th","th"][t.slice(-1)])},no=e=>{var t=e,s=(t=t.concat("Z")).split(/[^0-9]/);return new Date(s[0],s[1]-1,s[2],s[3],s[4],s[5])},oo={formatDate:(e,t,s=":")=>{if(!e)return null;var a="",i=no(e),r=io(i.getHours()),n=io(i.getMinutes());if("fr"===window.DP.lang)a="".concat(r).concat(s).concat(n);else{var o=r>=12?"pm":"am",l=r%12;a="".concat(l=l||12,":").concat(n," ").concat(o)}return ao(t,i,a)},reformatDate:no},lo=["AB","ON"],co=({listing:e,onCloseButtonClick:t,photoBaseUrl:s,photoBaseUrlDdf:a,photoBaseUrlIdx:i,titleLabel:n,viewLabel:o,characteristicLabels:l,viewAllPhotosLabel:c,queryString:p,openHouseLabel:d,isNewHomes:h,availabilityLabel:u,availabilityNow:m,soldLabel:g,soldPriceLabel:_})=>{var b=Ke()("/listing/%s%s",e.id,p),v=He("map-drawer",{newHomes:h}),y=po(e.source,s,a,i);return r.a.createElement("div",{className:v},r.a.createElement("div",{className:"map-drawer__header"},r.a.createElement("div",{className:"map-drawer__header-title"},n),r.a.createElement("div",{onClick:t,className:"map-drawer__header-close"},r.a.createElement(Ge.a,{className:"map-drawer__header-close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),r.a.createElement("div",{className:e.is_sold?"map-drawer__photo sold-tag-container":"map-drawer__photo"},r.a.createElement(Wn,{photos:e.photos,listingId:e.id,viewAllPhotosLabel:c,url:b,photoBaseUrl:y}),e.price_precision?r.a.createElement("div",{className:"map-drawer__precision"},e.price_precision):null,e.open_house&&e.open_house.next?r.a.createElement(ho,{next:e.open_house.next,openHouseLabel:d,showBigOpenHouse:e.show_big_open_house}):null,e.is_sold?r.a.createElement(uo,{soldLabel:g}):null,e.is_sold||-1!==lo.indexOf(e.address.province)?null:r.a.createElement("div",{className:"map-drawer__favourite-button"},r.a.createElement(so,{listingId:e.id,location:"SearchMapDrawer",boxShadow:!0}))),"ab"===window.DP.province?r.a.createElement(mo,{brokerName:e.broker_name,className:"map-drawer__brokerage map-drawer__brokerage--alberta"}):null,r.a.createElement(go,{listing:e,soldPriceLabel:_}),e.is_sold?null:r.a.createElement(_o,{availabilityValue:e.characteristics.main.availability,availabilityLabel:u,availabilityNow:m}),r.a.createElement("div",{className:"map-drawer__address"},r.a.createElement("div",{className:"map-drawer__address-city"},e.address.city),r.a.createElement("div",{className:"map-drawer__address-street"},e.address.street)),e.broker_name?r.a.createElement(mo,{brokerName:e.broker_name,className:"map-drawer__brokerage"}):null,r.a.createElement($n,{listing:e,labels:l}),r.a.createElement("a",{className:"map-drawer__view-button",href:b,onClick:()=>{e.is_sold&&Se.a.pushDynamicEvent("sold-search-map-click-sold-preview-listing","".concat(window.DP.context.pageType,"_Map"))}},r.a.createElement("span",{className:"map-drawer__view-button-label"},o),r.a.createElement(Ge.a,{className:"map-drawer__view-button-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0})))},po=(e,t,s,a)=>{var i="";switch(e){case"ddf":i=s;break;case"idx_creb":case"idx_rae":case"idx_rahb":case"idx_treb_sold":case"idx_treb":i=a;break;default:i=t}return i},ho=({next:e,openHouseLabel:t,showBigOpenHouse:s})=>r.a.createElement("div",{className:"open-house-tag open-house-tag--map"},r.a.createElement("div",{className:"open-house-tag__date"},e),r.a.createElement("div",{className:"open-house-tag__label"},t),s?r.a.createElement(Ge.a,{className:"big-open-house-balloons",src:"/build/img/svg/big-open-house-balloons.svg",cacheGetRequests:!0}):null),uo=({soldLabel:e})=>r.a.createElement("div",{className:"sold-tag sold-tag--drawer"},e),mo=({brokerName:e})=>r.a.createElement("div",{className:"map-drawer__brokerage"},r.a.createElement("div",{className:"map-drawer__brokerage-name"},e)),go=({listing:e,soldPriceLabel:t})=>r.a.createElement("div",{className:"map-drawer__infos"},r.a.createElement("div",{className:"map-drawer__title"},e.is_sold?t:e.title.display_long),e.price?r.a.createElement("div",{className:"map-drawer__price"},e.price.display):null,e.price_sold?r.a.createElement("div",{className:"map-drawer__price"},e.price_sold.display):null),_o=({availabilityValue:e,availabilityLabel:t,availabilityNow:s})=>{if(void 0===e)return null;var a=new Date,i=e.concat("T00:00:00"),n=oo.reformatDate(i);return e=a.getTime()>n.getTime()?s:oo.formatDate(i,"full_date"),r.a.createElement("div",{className:"map-drawer__availability"},r.a.createElement("div",{className:"map-drawer__availability-label"},t)," ",r.a.createElement("div",{className:"map-drawer__availability-value"},e))};co.propTypes={onCloseButtonClick:je.PropTypes.func.isRequired,photoBaseUrl:je.PropTypes.string.isRequired,photoBaseUrlDdf:je.PropTypes.string.isRequired,photoBaseUrlIdx:je.PropTypes.string.isRequired,titleLabel:je.PropTypes.string.isRequired,viewLabel:je.PropTypes.string.isRequired,soldLabel:je.PropTypes.string.isRequired,soldPriceLabel:je.PropTypes.string.isRequired,viewAllPhotosLabel:je.PropTypes.string.isRequired,openHouseLabel:je.PropTypes.string.isRequired,characteristicLabels:je.PropTypes.object.isRequired,queryString:je.PropTypes.string.isRequired,listing:je.PropTypes.shape({id:je.PropTypes.string.isRequired,type:je.PropTypes.string.isRequired,photos:je.PropTypes.array.isRequired,price_precision:je.PropTypes.string,price:je.PropTypes.shape({display:je.PropTypes.string}),show_big_open_house:je.PropTypes.bool.isRequired,address:je.PropTypes.shape({street:je.PropTypes.string,city:je.PropTypes.string}),source:je.PropTypes.string.isRequired,broker_name:je.PropTypes.string.isRequired,title:je.PropTypes.shape({display_short:je.PropTypes.string.isRequired,display_long:je.PropTypes.string.isRequired}).isRequired,characteristics:je.PropTypes.shape({main:je.PropTypes.shape({availability:je.PropTypes.string})})}).isRequired,isNewHomes:je.PropTypes.bool.isRequired,availabilityLabel:je.PropTypes.string.isRequired,availabilityNow:je.PropTypes.string.isRequired},ho.propTypes={next:je.PropTypes.string.isRequired,openHouseLabel:je.PropTypes.string.isRequired,showBigOpenHouse:je.PropTypes.bool.isRequired,bigOpenHouse:je.PropTypes.object},uo.propTypes={soldLabel:je.PropTypes.string.isRequired},mo.propTypes={brokerName:je.PropTypes.string.isRequired,className:je.PropTypes.string.isRequired},_o.propTypes={availabilityLabel:je.PropTypes.string.isRequired,availabilityNow:je.PropTypes.string.isRequired,availabilityValue:je.PropTypes.string},go.propTypes={listing:je.PropTypes.shape({id:je.PropTypes.string.isRequired,type:je.PropTypes.string.isRequired,photos:je.PropTypes.array.isRequired,price_precision:je.PropTypes.string,price:je.PropTypes.shape({display:je.PropTypes.string}),show_big_open_house:je.PropTypes.bool.isRequired,address:je.PropTypes.shape({street:je.PropTypes.string,city:je.PropTypes.string}),source:je.PropTypes.string.isRequired,broker_name:je.PropTypes.string.isRequired,title:je.PropTypes.shape({display_short:je.PropTypes.string.isRequired,display_long:je.PropTypes.string.isRequired}).isRequired,characteristics:je.PropTypes.shape({main:je.PropTypes.shape({availability:je.PropTypes.string})})}).isRequired,soldPriceLabel:je.PropTypes.string.isRequired};var bo=co;function vo(){return(vo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class yo extends r.a.Component{constructor(e){super(e);var t=window.innerWidth<=768;this.state={activeListing:null,mobile:t}}componentDidMount(){var{photoBaseUrl:e,photoBaseUrlDdf:t,photoBaseUrlIdx:s,searchCriteria:a,regions:i,priceOnRequest:r,listing:n}=this.props,{latitude:o,longitude:l}=n,c={maxBounds:wr(a),scrollWheelZoom:!0,center:new L.LatLng(o,l)};this.map=new Fn(this.refs.map,c,{attribution:this.props.attribution,photoBaseUrl:e,photoBaseUrlDdf:t,photoBaseUrlIdx:s,regions:i,priceOnRequest:r}),this.map.onListingSelect=this.handleListingSelect.bind(this),this.map.onVisibleInSearchListingCountChange=()=>{},this.map.activateIsLoading=()=>{},this.map.deactivateIsLoading=()=>{},this.map.onMapMoveEnd=()=>{},this.map.forceScope=Rn,this.map.mapInitializationComplete=!0,this.map.initialSearchCriteria=a,this.map.addMarkerAndCenter(this.props.listing,15),this.props.activeListingTab!==this.props.listing.tabName||this.state.mobile||this.map.handleMapMoveEnd()}componentDidUpdate({activeListingTab:e},t){e!==this.props.activeListingTab&&this.props.activeListingTab===this.props.listing.tabName&&(setTimeout(()=>this.map.refresh(),0),this.state.mobile||this.map.bindMoveEnd())}handleDrawerCloseButtonClick(){this.setState({activeListing:null})}handleListingSelect(e){this.setState({activeListing:e})}render(){return r.a.createElement("div",{className:"listing-map"},r.a.createElement("div",{ref:"map",className:"listing-map__map"}),this.renderLegend(),this.renderDrawer())}renderLegend(){return this.state.mobile?null:r.a.createElement("div",{className:"listing-map__legend"},r.a.createElement(Vn,{buttonLabel:this.props.legend.buttonLabel,itemLabels:this.props.legend.itemLabels}))}renderDrawer(){return!this.state.activeListing||this.state.mobile?null:r.a.createElement("div",{className:"listing-map__drawer"},r.a.createElement(bo,vo({},this.props.drawer,{listing:this.state.activeListing,queryString:"",onCloseButtonClick:this.handleDrawerCloseButtonClick.bind(this),photoBaseUrl:this.props.photoBaseUrl,photoBaseUrlDdf:this.props.photoBaseUrlDdf,photoBaseUrlIdx:this.props.photoBaseUrlIdx})))}}yo.propTypes={attribution:je.PropTypes.string,photoBaseUrl:je.PropTypes.string.isRequired,photoBaseUrlDdf:je.PropTypes.string.isRequired,photoBaseUrlIdx:je.PropTypes.string.isRequired,listing:je.PropTypes.shape({latitude:je.PropTypes.number.isRequired,longitude:je.PropTypes.number.isRequired,tabName:je.PropTypes.string.isRequired,isRental:je.PropTypes.bool}),legend:je.PropTypes.shape({buttonLabel:je.PropTypes.string.isRequired,itemLabels:je.PropTypes.array.isRequired}).isRequired,drawer:je.PropTypes.shape({titleLabel:je.PropTypes.string.isRequired,viewLabel:je.PropTypes.string.isRequired,viewAllPhotosLabel:je.PropTypes.string.isRequired,openHouseLabel:je.PropTypes.string.isRequired,characteristicLabels:je.PropTypes.object.isRequired,isNewHomes:je.PropTypes.bool.isRequired}).isRequired,searchCriteria:je.PropTypes.shape({province:je.PropTypes.number.isRequired}).isRequired,activeListingTab:je.PropTypes.string,priceOnRequest:je.PropTypes.string.isRequired,regions:je.PropTypes.array.isRequired};var fo=yo=Object(m.b)(({listingTabs:e})=>{var{activeTabName:t}=e;return{activeListingTab:t}})(yo),To=g.createProviderWrappedComponent(e=>r.a.createElement(fo,e)),Po=e=>({type:"SET_SEARCH_MAP_INITIAL_LISTINGS_FETCHED",fetched:e});function wo(){return(wo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class Eo extends r.a.Component{constructor(e){super(e);var t=window.innerWidth<=768;this.state={activeListing:null,queryString:"",isLoading:!1,hideAlert:!1,mobile:t,zoom:null}}componentDidMount(){var{attribution:e,photoBaseUrl:t,photoBaseUrlDdf:s,photoBaseUrlIdx:a,initialContext:i,searchCriteria:r,regions:n,priceOnRequest:o,soldLabel:l,soldPriceLabel:c,isBlurred:p}=this.props,d={maxBounds:wr(r),scrollWheelZoom:!0,isGvlMode:void 0!==r.gvl};if(this.map=new Fn(this.refs.map,d,{attribution:e,photoBaseUrl:t,photoBaseUrlDdf:s,photoBaseUrlIdx:a,initialContext:i,regions:n,priceOnRequest:o,soldLabel:l,soldPriceLabel:c}),d.isGvlMode&&this.state.mobile){Ze().then(e=>{this.map.setPositionAndZoom(e.coords.latitude,e.coords.longitude,12)}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})})}if(!p||!r.is_sold)if(this.map.onListingSelect=this.handleListingSelect.bind(this),this.map.onVisibleInSearchListingCountChange=this.handleVisibleInSearchListingCountChange.bind(this),this.map.onMapMoveEnd=this.handleMapMoveEnd.bind(this),this.map.activateIsLoading=this.handleActivateIsLoading.bind(this),this.map.deactivateIsLoading=this.handleDeactivateIsLoading.bind(this),this.map.initialSearchCriteria=((e,t,{center:s})=>s?Object.assign({},e,t.getPaddedBounds()):e)(r,this.map,i),this.map.guessAsTooManySearchResults(this.map.initialSearchCriteria))this.props.dispatch(Po(!0)),this.map.initHasTooManyMarkers(!0),this.map.bindMoveEnd();else{var h=Object.assign({},this.map.initialSearchCriteria);h.search_scope=this.map.determineScopeToFetch(),this.map.fetchListings(h,i.fitInSearchBounds).then(()=>{this.props.dispatch(Po(!0)),this.map.bindMoveEnd()})}}componentDidUpdate(e,{activeListing:t}){this.state.activeListing&&t!==this.state.activeListing&&Tr(this.state.activeListing)}handleDrawerCloseButtonClick(){this.setState({activeListing:null}),this.props.searchCriteria.is_sold&&Se.a.pushDynamicEvent("sold-search-map-click-preview-listing","".concat(window.DP.context.pageType,"_Map"))}handleListingSelect(e){this.setState({activeListing:e})}handleVisibleInSearchListingCountChange(e){this.props.visibleInSearchListingCount!==e&&this.props.dispatch((e=>({type:"SET_SEARCH_MAP_VISIBLE_IN_SEARCH_LISTING_COUNT",count:e}))(e))}handleMapMoveEnd(e){var t=e.getCenter(),s="?position=".concat(t.lat,",").concat(t.lng,"&zoom=").concat(e.getZoom());this.setState({queryString:s}),this.setState({zoom:e.getZoom()}),window.history.pushState(null,null,s)}handleActivateIsLoading(){this.setState({isLoading:!0})}handleDeactivateIsLoading(){this.setState({isLoading:!1}),this.setState({hideAlert:!1})}handleCloseClick(){this.setState({hideAlert:!0})}handleNavigationClick(){var e=this.state.zoom>13?this.state.zoom:13;Ze().then(t=>{this.map.setPositionAndZoom(t.coords.latitude,t.coords.longitude,e)}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})})}render(){return r.a.createElement("div",{className:"search-map"},r.a.createElement("div",{className:"search-map__container"},r.a.createElement("div",{className:"search-map__viewport"},r.a.createElement("div",{ref:"map",className:"search-map__map"}),this.renderNavigation(),r.a.createElement("div",{className:"search-map__legend"},r.a.createElement(Vn,{buttonLabel:this.props.legend.buttonLabel,itemLabels:this.props.legend.itemLabels,isSoldContext:!!this.props.searchCriteria.is_sold})),this.renderDrawer(),this.renderNoResults(),this.renderTooManyResults(),this.renderLoading(),this.renderLoginGate())))}renderNavigation(){return r.a.createElement("div",{className:"map-navigation"},r.a.createElement("button",{className:"map-navigation__button",onClick:this.handleNavigationClick.bind(this)},r.a.createElement(Ge.a,{className:"map-navigation__button-icon",src:"/build/img/svg/icn-navigation.svg",cacheGetRequests:!0})),r.a.createElement("span",{className:"map-navigation__tooltip"},this.props.navigationTooltip))}renderDrawer(){return this.state.isLoading||!this.state.activeListing?null:(d()(".search-survey").addClass("hidden-mobile"),r.a.createElement("div",{className:"search-map__drawer"},r.a.createElement(bo,wo({},this.props.drawer,{listing:this.state.activeListing,queryString:this.state.queryString,onCloseButtonClick:this.handleDrawerCloseButtonClick.bind(this),photoBaseUrl:this.props.photoBaseUrl,photoBaseUrlDdf:this.props.photoBaseUrlDdf,photoBaseUrlIdx:this.props.photoBaseUrlIdx}))))}renderNoResults(){if(this.state.isLoading||this.state.hideAlert||!this.props.initialListingsFetched||null===this.props.visibleInSearchListingCount||this.props.visibleInSearchListingCount>0)return null;var e=He("search-map__alert",{narrow:this.state.activeListing});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"search-map__alert-content"},r.a.createElement("div",{className:"search-map__alert-close-button",onClick:this.handleCloseClick.bind(this)},"x"),r.a.createElement("div",{className:"search-map__alert-title"},this.props.noResults.titleLabel),r.a.createElement("div",{className:"search-map__alert-message"},this.props.noResults.messageLabel)))}renderTooManyResults(){if(this.state.isLoading||this.state.hideAlert||!this.props.initialListingsFetched||this.props.visibleInSearchListingCount<=Ar||0===this.props.visibleInSearchListingCount||null===this.props.visibleInSearchListingCount||void 0===this.props.visibleInSearchListingCount)return null;var e=He("search-map__alert",{narrow:this.state.activeListing});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"search-map__alert-content"},r.a.createElement("div",{className:"search-map__alert-close-button",onClick:this.handleCloseClick.bind(this)},"x"),r.a.createElement("div",{className:"search-map__alert-title"},this.props.tooManyResults.titleLabel),r.a.createElement("div",{className:"search-map__alert-message"},this.props.tooManyResults.messageLabel)))}renderLoading(){return this.state.isLoading?r.a.createElement("div",{className:"search-map__loading"},this.props.loadingResults.titleLabel):null}renderLoginGate(){return this.props.isBlurred&&this.props.searchCriteria.is_sold?r.a.createElement("div",{className:"search-map__login"},r.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.loginWall.line1}}),r.a.createElement("p",null,r.a.createElement("a",{href:this.props.loginWall.loginUrl,className:"button button--auto listing-login-wall__button",dangerouslySetInnerHTML:{__html:this.props.loginWall.buttonLabel},onClick:()=>Se.a.pushDynamicEvent("sold-search-map-click-sold-map-login",window.DP.context.pageType+"_Map")})),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.loginWall.line2},onClick:()=>Se.a.pushDynamicEvent("sold-search-map-click-sold-map-register",window.DP.context.pageType+"_Map")})):null}}Eo.propTypes={attribution:je.PropTypes.string.isRequired,photoBaseUrl:je.PropTypes.string.isRequired,photoBaseUrlDdf:je.PropTypes.string.isRequired,photoBaseUrlIdx:je.PropTypes.string.isRequired,soldLabel:je.PropTypes.string.isRequired,soldPriceLabel:je.PropTypes.string.isRequired,noResults:je.PropTypes.shape({titleLabel:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired}),tooManyResults:je.PropTypes.shape({titleLabel:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired}),loadingResults:je.PropTypes.shape({titleLabel:je.PropTypes.string.isRequired}),drawer:je.PropTypes.shape({titleLabel:je.PropTypes.string.isRequired,viewLabel:je.PropTypes.string.isRequired,viewAllPhotosLabel:je.PropTypes.string.isRequired,openHouseLabel:je.PropTypes.string.isRequired,characteristicLabels:je.PropTypes.object,isNewHomes:je.PropTypes.bool.isRequired}).isRequired,legend:je.PropTypes.shape({buttonLabel:je.PropTypes.string.isRequired,itemLabels:je.PropTypes.array.isRequired,isSoldContext:je.PropTypes.bool}).isRequired,initialContext:je.PropTypes.shape({fitInSearchBounds:je.PropTypes.bool.isRequired,center:je.PropTypes.arrayOf(je.PropTypes.number),bounds:je.PropTypes.arrayOf(je.PropTypes.arrayOf(je.PropTypes.number)),zoomLevel:je.PropTypes.number}),searchCriteria:je.PropTypes.object.isRequired,initialListingsFetched:je.PropTypes.bool.isRequired,visibleInSearchListingCount:je.PropTypes.number,dispatch:je.PropTypes.func.isRequired,priceOnRequest:je.PropTypes.string.isRequired,regions:je.PropTypes.array.isRequired,isBlurred:je.PropTypes.bool.isRequired,loginWall:je.PropTypes.shape({line1:je.PropTypes.string.isRequired,line2:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,loginUrl:je.PropTypes.string.isRequired}).isRequired,navigationTooltip:je.PropTypes.string.isRequired};var Co=Eo=Object(m.b)(({searchMap:e})=>{var{initialListingsFetched:t,visibleInSearchListingCount:s}=e;return{initialListingsFetched:t,visibleInSearchListingCount:s}})(Eo),So=g.createProviderWrappedComponent(e=>r.a.createElement(Co,e));class Ro extends r.a.Component{constructor(e){super(e),this.state={streetViewUrl:!1,isNotFound:!1,newWindow:null}}handleClick(){this.state.isNotFound?this.errorNotFound():(Se.a.pushDynamicEvent("listing-clickmapgooglestreet","Listing"),this.state.newWindow&&!this.state.newWindow.closed||(this.state.newWindow=window.open("","_blank")),this.state.streetViewUrl?this.openStreetView():this.loadGoogleMapsApiScript())}handleStreetViewResponse(e,t){if(t===google.maps.StreetViewStatus.OK){var s=e.location.latLng,a="".concat("https://www.google.ca/maps","?cbll=").concat(s.lat(),",").concat(s.lng(),"&layer=c&cbp=12,20.09,,0,5&panoid=").concat(e.location.pano);this.setState({streetViewUrl:a}),this.openStreetView()}else this.setState({isNotFound:!0}),this.errorNotFound()}render(){return r.a.createElement("button",{onClick:this.handleClick.bind(this),className:"gtm-listing-map-link-google-street-view listing-street-view-button__button"},r.a.createElement("span",{className:"listing-street-view-button__button-content"},r.a.createElement(Ge.a,{className:"listing-street-view-button__button-icon",src:"/build/img/svg/icn-street-view.svg",cacheGetRequests:!0}),this.props.buttonLabel))}loadGoogleMapsApiScript(){var e=document.createElement("script");e.src=Ke()("https://maps.googleapis.com/maps/api/js?key=%s&callback=onGoogleMapsScriptsInitialize",this.props.googleMapsApiKey),document.body.appendChild(e),window.onGoogleMapsScriptsInitialize=()=>this.initializeStreetViewCheck()}initializeStreetViewCheck(){var e=new google.maps.LatLng(this.props.latitude,this.props.longitude);(new google.maps.StreetViewService).getPanoramaByLocation(e,100,this.handleStreetViewResponse.bind(this))}openStreetView(){this.state.newWindow.location=this.state.streetViewUrl,this.state.newWindow.focus()}errorNotFound(){this.state.newWindow&&!this.state.newWindow.closed&&this.state.newWindow.close(),alert(this.props.notFoundMessage)}}Ro.propTypes={latitude:je.PropTypes.number.isRequired,longitude:je.PropTypes.number.isRequired,googleMapsApiKey:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,notFoundMessage:je.PropTypes.string.isRequired};var No=Ro,ko=(e,t=!1)=>({type:"ACTIVATE_LISTING_TAB",name:e,scrollToTab:!!t});class Lo extends r.a.Component{constructor(e){super(e),this.state={gtmPartnerEventPushed:!1},this.useNewCalculator="on"===window.DP.province||"mb"===window.DP.province||"qc"===window.DP.province}componentDidMount(){window.onhashchange=this.onHashChange.bind(this),this.hashtagNavigation(),window.location.hash?(this.showActiveTabContent(),this.scrollToTabs()):d()(".".concat("listing-tab-content","--").concat(this.props.activeTabName)).addClass("listing-tab-content--active"),(d()(".".concat("listing-tab__item--cogeco")).is(":visible")||d()(".".concat("listing-tab__item--bell")).is(":visible")||d()(".".concat("listing-tab__item--bell_FTTH")).is(":visible")||d()(".".concat("listing-tab__item--bell_FTTN")).is(":visible"))&&this.props.items.map(({partnerTab:e,isRental:t})=>this.handleGtmEventPush(e,t)),d()(".".concat("toggleable-content")).find("h3 a").on("click",this.toggleLegalNote.bind(this)),this.handleListingViewDdf()}handleItemClick(e){this.scrollToTabs(),window.location.replace("#".concat(e)),this.props.dispatch(ko(e))}handleListingViewDdf(){var e=this.props.listing;if(void 0!==e&&void 0!==e.code&&void 0!==e.source&&"ddf"===e.source.toLowerCase()){var t=e.code.replace("d","");Lr(t)}}componentDidUpdate({activeTabName:e},t){e!==this.props.activeTabName&&this.showActiveTabContent({activeTabName:e}),this.state.gtmPartnerEventPushed===t.gtmPartnerEventPushed&&this.scrollToTabs()}handleGtmEventPush(e,t){if(this.state.gtmPartnerEventPushed)return null;e&&("cogeco"===e?t?Se.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available_Rental","undefined"):Se.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available","undefined"):"bell_FTTN"===e?Se.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available","FTTN"):"bell_FTTH"===e?Se.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available","FTTH"):"bell"===e&&Se.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available",""),this.setState({gtmPartnerEventPushed:!0}))}handlePushDynamicEvent(e){var t;switch(e){case"cogeco":t="Partnership_Cogeco";break;case"bell":t="Partnership_Bell";break;default:t="Listing"}if(Se.a.pushDynamicEvent("listing-clicktab-".concat(e),t),"price-history"===e){var s=this.props.listing.isSold?"sold":"sell";Se.a.pushDynamicEvent("".concat(s,"-price-history-listing-tab"),window.DP.context.pageType)}}render(){return r.a.createElement("nav",{ref:"tabs",className:"listing-tab"},r.a.createElement("ul",{className:"listing-tab__list"},this.props.items.map(({name:e,label:t,labelShort:s,partnerTab:a})=>this.renderItem(e,t,s,a))))}renderItem(e,t,s,a){if(e!==this.props.listing.hashtagMap||!this.props.listing.hideTabMap){var i=He("listing-tab__item",{highlighted:e===this.props.activeTabName}),n=a?"".concat("listing-tab__item","--").concat(a):"".concat("listing-tab__item","--").concat(e);return r.a.createElement("li",{key:"listingTabs:item:".concat(e),onClick:this.handleItemClick.bind(this,e),className:"".concat(i," ").concat(n)},r.a.createElement("a",{href:"#".concat(e),onClick:this.handlePushDynamicEvent.bind(this,e),className:"listing-tab__link"},this.renderCogeco(t,s)))}}renderCogeco(e,t){return r.a.createElement("div",null,r.a.createElement("span",{className:"listing-tab__link-label"},e),r.a.createElement("span",{className:"listing-tab__link-label-short"},t))}showActiveTabContent(){d()(".".concat("listing-tab-content")).removeClass("listing-tab-content--active"),d()(".".concat("listing-tab-content","--").concat(this.props.activeTabName)).addClass("listing-tab-content--active")}scrollToTabs(){var e,t=d()(this.refs.tabs).offset().top;e=d()(".".concat("mobile-header")).length?d()(".".concat("mobile-header")).height():d()(".".concat("header--fixed")).height()+d()(".".concat("listing-fixed-header")).height(),window.scrollTo(0,t-e)}refreshAds(e){if(window.DP.configSwitch.adsSystem&&!this.props.listing.soldSharedListing){this.resetAds();var t=this;googletag.cmd.push((function(){var s=t.getAvailableAdsList(e);s.length>0&&(googletag.pubads().refresh(s),activeAds=activeAds.concat(s))}))}}resetAds(){if(window.DP.configSwitch.adsSystem&&!this.props.listing.soldSharedListing){var e=this;googletag.cmd.push((function(){var t=e.getAllAdsList();t.length>0&&(googletag.pubads().clear(t),activeAds=d()(activeAds).not(t).get())}))}}getAvailableAdsList(e){return this.isInBuyTab(e)?this.refreshAdsBuyTab():this.isInCostTab(e)?this.refreshAdsCostTab():this.isInMapTab(e)?this.refreshAdsMapTab():this.isInPartnerTab(e)?this.refreshAdsPartnerTab():this.refreshAdsDescriptionTab()}getAllAdsList(){var e=[];return e=(e=(e=(e=(e=e.concat(this.refreshAdsDescriptionTab())).concat(this.refreshAdsBuyTab())).concat(this.refreshAdsCostTab())).concat(this.refreshAdsMapTab())).concat(this.refreshAdsPartnerTab())}isInBuyTab(e){return"acheter"===e||"buy"===e}isInCostTab(e){return"costs"===e||"couts"===e}isInMapTab(e){return"carte"===e||"map"===e}isInPartnerTab(e){return"cogeco"===e||"bell"===e||"bell_FTTN"===e||"bell_FTTH"===e}refreshAdsBuyTab(){return[listingBuyBigboxTop,listingBuyBigboxBottom]}refreshAdsCostTab(){var e=[listingCostBigboxTop,listingCostBigboxBottom];return"undefined"==typeof listingCostsMortgageCalculator||this.useNewCalculator||e.push(listingCostsMortgageCalculator,listingCostsLinkBottom),"undefined"!=typeof listingCostsNewMortgageCalculator&&this.useNewCalculator&&e.push(listingCostsNewMortgageCalculator),e}refreshAdsMapTab(){return this.props.listing.hideTabMap?null:[listingMapLeaderboardBottom]}refreshAdsPartnerTab(){var e=[];return"undefined"!=typeof listingPartnerBigboxTop&&e.push(listingPartnerBigboxTop),"undefined"!=typeof listingPartnerBigboxBottom&&e.push(listingPartnerBigboxBottom),"undefined"!=typeof listingPartnerCatfish&&e.push(listingPartnerCatfish),"undefined"!=typeof listingPartnerTab&&e.push(listingPartnerTab),e}refreshAdsDescriptionTab(){var e=[];return e.push(listingDescriptionBigboxTop,listingDescriptionBigboxBottom),"undefined"==typeof listingDescriptionMortgageCalculator||this.useNewCalculator||e.push(listingDescriptionMortgageCalculator,listingDescriptionLinkBottom),"undefined"!=typeof listingDescriptionNewMortgageCalculator&&this.useNewCalculator&&e.push(listingDescriptionNewMortgageCalculator),e}toggleLegalNote(e){e.preventDefault(),d()(".".concat("toggleable-content")).toggleClass("opened")}onHashChange(){this.hashtagNavigation()}hashtagNavigation(){var e=window.location.hash.substring(1);d()(".".concat("listing-tab-content")).hasClass("".concat("listing-tab-content","--").concat(e))&&window.location.hash||(e=d()(".".concat("listing-tab__item")).first().find("a").attr("href").substring(1)),e&&e!==this.props.activeTabName&&this.props.dispatch(ko(e)),this.refreshAds(e)}}Lo.propTypes={dispatch:je.PropTypes.func.isRequired,activeTabName:je.PropTypes.string.isRequired,items:je.PropTypes.arrayOf(je.PropTypes.shape({name:je.PropTypes.string,label:je.PropTypes.string,labelShort:je.PropTypes.string,partnerTab:je.PropTypes.string,isRental:je.PropTypes.bool})).isRequired,listing:je.PropTypes.shape({code:je.PropTypes.string.isRequired,source:je.PropTypes.string.isRequired,hideTabMap:je.PropTypes.bool.isRequired,hashtagMap:je.PropTypes.string.isRequired,soldSharedListing:je.PropTypes.bool.isRequired,isSold:je.PropTypes.bool}).isRequired,scrollToTab:je.PropTypes.bool.isRequired};var qo=Lo=Object(m.b)(({listingTabs:e})=>{var{activeTabName:t,scrollToTab:s}=e;return{activeTabName:t,scrollToTab:s}})(Lo),Oo=g.createProviderWrappedComponent(e=>r.a.createElement(qo,e)),xo=e=>{var t=window.DP.urls.proxySellerContact;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Do=e=>{var t=window.DP.urls.proxyContact;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Mo=e=>{var t=window.DP.urls.proxyTroubleReachingOwner;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Ao=window.DP.context.route;class Io extends r.a.Component{constructor(e){super(e),this.state={departmentValue:-1!==Ao.indexOf("rental::")?"rental":"customer_service",emailValue:"",messageValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_CONTACT_FORM"})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.state.emailValue,t=this.state.messageValue,s=this.state.departmentValue;Do({fromEmail:e,message:t,department:s}).then(e=>{this.props.gtmCategory&&this.props.gtmAction&&Se.a.pushToDataLayer("gtm-event",this.props.gtmCategory,this.props.gtmAction,"undefined"),this.props.gtmSubmitCallName&&Se.a.pushDynamicEvent(this.props.gtmSubmitCallName,window.DP.context.pageType),this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,messageValue:"",emailValue:""})}).catch(e=>{this.setState({displayedMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if(!this.props.isVisible)return null;var e=He("modal",{submitting:this.state.isSubmitting});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"modal__content contact-form"},this.renderCloseButton(),r.a.createElement("div",{className:"contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,this.renderEmailField(),this.renderMessageField(),this.renderSubmitButton()))}renderCloseButton(){return r.a.createElement("div",{className:"modal__close-button",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderEmailField(){var e=He("contact-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"contact-form__label"},this.props.emailLabel,r.a.createElement("input",{className:"contact-form__field",placeholder:this.props.emailPlaceholder,value:this.state.emailValue,onChange:this.handleEmailValueChange.bind(this)})))}renderMessageField(){var e=He("contact-form__group",{invalid:"message"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"contact-form__label"},this.props.messageLabel,r.a.createElement("textarea",{className:"contact-form__field contact-form__field--message",placeholder:this.props.messagePlaceholder,value:this.state.messageValue,rows:"8",onChange:this.handleMessageValueChange.bind(this)})))}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?r.a.createElement("button",{className:t},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),r.a.createElement("div",{className:"contact-form__group"},e)}renderMessage(){var e=He("contact-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}}Io.propTypes={dispatch:je.PropTypes.func.isRequired,isVisible:je.PropTypes.bool,buttonLabel:je.PropTypes.string.isRequired,emailLabel:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired,messagePlaceholder:je.PropTypes.string.isRequired,formTitle:je.PropTypes.string.isRequired,gtmCategory:je.PropTypes.string,gtmAction:je.PropTypes.string,gtmSubmitCallName:je.PropTypes.string};var Bo=Io=Object(m.b)(({contactForm:e})=>{var{isVisible:t,gtmCategory:s,gtmAction:a,gtmSubmitCallName:i}=e;return{isVisible:t,gtmCategory:s,gtmAction:a,gtmSubmitCallName:i}})(Io),Fo=g.createProviderWrappedComponent(e=>r.a.createElement(Bo,e)),jo=s(39),Vo=s.n(jo);class Uo extends r.a.Component{constructor(e){super(e),this.state={nameValue:"",emailValue:"",phoneValue:"",messageValue:"",departmentValue:this.props.departmentOptions[0].value,displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var{emailValue:e,messageValue:t,nameValue:s,phoneValue:a,departmentValue:i}=this.state;Do({fromEmail:e,message:t,name:s,phone:a,department:i}).then(e=>{this.handleSuccessfulFormGtmPush(),this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,messageValue:"",emailValue:""})}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleDepartmentValueChange(e){this.setState({departmentValue:e.value}),window.Dropdown("hide")}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){var e=He("contact-us-form",{submitting:this.state.isSubmitting});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"contact-us-form__content"},r.a.createElement("h2",{className:"contact-us-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,r.a.createElement("div",{className:"contact-us-form__columns"},r.a.createElement("div",{className:"contact-us-form__column"},this.renderDepartmentField(),this.renderNameField(),this.renderPhoneField(),this.renderEmailField()),r.a.createElement("div",{className:"contact-us-form__column"},this.renderMessageField())),r.a.createElement("div",{className:"contact-us-form__actions"},this.renderSubmitButton())))}renderNameField(){return this.renderField({name:"name",value:this.state.nameValue,label:this.props.nameLabel,placeholder:this.props.namePlaceholder,required:!1,changeCallback:this.handleNameValueChange})}renderPhoneField(){var e=He("contact-us-form__field",{invalid:"phone"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"contact-us-form__field-header"},r.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:"contact-us-phone"},this.props.phoneLabel)),r.a.createElement(Vo.a,{mask:"(999) 999-9999",id:"contact-us-phone",className:"contact-us-form__field-input",placeholder:this.props.phonePlaceholder,onChange:this.handlePhoneValueChange.bind(this)}))}renderDepartmentField(){var e=He("contact-us-form__field",{invalid:"department"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"contact-us-form__field-header"},r.a.createElement("label",{className:"contact-us-form__field-label"},this.props.departmentLabel),r.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel)),r.a.createElement(ar,{dropdownId:"contact-us-department-dropdown",options:this.props.departmentOptions,selected:this.state.departmentValue,onSelect:this.handleDepartmentValueChange.bind(this)}))}renderEmailField(){return this.renderField({name:"from",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!0,changeCallback:this.handleEmailValueChange})}renderMessageField(){var e=He("contact-us-form__field",{invalid:"message"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"contact-us-form__field-header"},r.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:"contact-us-message"},this.props.messageLabel),r.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel)),r.a.createElement("textarea",{className:"contact-us-form__field-textarea",id:"contact-us-message",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this)}))}renderSubmitButton(){var e="button button--full-width button--arrow";return this.state.isSubmitting?r.a.createElement("button",{className:e},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.buttonLabel)}renderField({name:e,value:t,label:s,placeholder:a,required:i,changeCallback:n}){var o=He("contact-us-form__field",{invalid:this.state.errorField===e}),l="contact-us-".concat(e);return r.a.createElement("div",{className:o},r.a.createElement("div",{className:"contact-us-form__field-header"},r.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:l},s),i?r.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel):""),r.a.createElement("input",{id:l,className:"contact-us-form__field-input",placeholder:a,value:t,onChange:n.bind(this)}))}renderMessage(){var e=He("contact-us-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}handleSuccessfulFormGtmPush(){this.props.gtmPushClass?Se.a.pushToDataLayer("gtm-event","ContactUsPage","Click_Email","Email_Submit"):Se.a.pushToDataLayer("gtm-event","ContactUs","Send_ContactForm","undefined")}}Uo.propTypes={emailLabel:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired,messagePlaceholder:je.PropTypes.string.isRequired,nameLabel:je.PropTypes.string.isRequired,namePlaceholder:je.PropTypes.string.isRequired,phoneLabel:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,departmentLabel:je.PropTypes.string.isRequired,requiredLabel:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,formTitle:je.PropTypes.string.isRequired,gtmPushClass:je.PropTypes.string,departmentOptions:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired};var $o=Uo,Go=e=>{var t=window.DP.urls.proxyCallback;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class Ho extends r.a.Component{constructor(e){super(e),this.state={firstnameValue:"",lastnameValue:"",phoneValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,buttonLabel:this.props.buttonLabel,bestTimeCallValue:this.renderDefaultToCallMeValue()}}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.leadSource,t=this.state.firstnameValue,s=this.state.lastnameValue,a=this.state.phoneValue.replace(/\D/g,""),i=this.state.bestTimeCallValue;Go({firstname:t,lastname:s,phone:a,source:e,bestTimeCall:i,from:"pricing"}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,firstnameValue:"",lastnameValue:"",phoneValue:"",bestTimeCallValue:this.renderDefaultToCallMeValue()}),Se.a.pushDynamicEvent("pricing-subscribe-button","PackagePage")}).catch(e=>{this.setState({displayedMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}handleFirstnameValueChange(e){this.setState({firstnameValue:e.target.value})}handleLastnameValueChange(e){this.setState({lastnameValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handlebestTimeCallValueChange(e){this.setState({bestTimeCallValue:e.value}),window.Dropdown("hide")}renderDefaultToCallMeValue(){return this.props.bestTimeCallValues[0].value}render(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"callme-form"},r.a.createElement("div",{className:"callme-form__column"},this.renderFirstnameField(),this.renderLastnameField()),r.a.createElement("div",{className:"callme-form__column"},this.renderPhoneField(),this.renderBestTimeCallDropdown()),this.state.displayedMessage?this.renderMessage():null,this.renderSubmitButton()))}renderFirstnameField(){var e=He("callme-form__group",{invalid:"firstname"===this.state.errorField,filled:this.state.firstnameValue});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"callme-form__label"},r.a.createElement("input",{className:"callme-form__field",value:this.state.firstnameValue,maxLength:"80",onChange:this.handleFirstnameValueChange.bind(this)}),r.a.createElement("span",null,this.props.firstnameLabel)))}renderLastnameField(){var e=He("callme-form__group",{invalid:"lastname"===this.state.errorField,filled:this.state.lastnameValue});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"callme-form__label"},r.a.createElement("input",{className:"callme-form__field",value:this.state.lastnameValue,maxLength:"80",onChange:this.handleLastnameValueChange.bind(this)}),r.a.createElement("span",null,this.props.lastnameLabel)))}renderPhoneField(){var e=He("callme-form__group",{invalid:"phone"===this.state.errorField,filled:this.state.phoneValue});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"callme-form__label"},r.a.createElement(Vo.a,{type:"tel",mask:"(999) 999-9999",className:"callme-form__field",value:this.state.phoneValue,onChange:this.handlePhoneValueChange.bind(this)}),r.a.createElement("span",null,this.props.phoneLabel)))}renderBestTimeCallDropdown(){var e=He("callme-form__group",{invalid:"best_time_call"===this.state.errorField,filled:"label"!==this.state.bestTimeCallValue});return r.a.createElement("div",{className:e},r.a.createElement(ar,{dropdownId:"best-time-call-dropdown",options:this.props.bestTimeCallValues,selected:this.state.bestTimeCallValue,onSelect:this.handlebestTimeCallValueChange.bind(this)}))}renderSubmitButton(){var e;return e=this.state.isSubmitting?r.a.createElement("button",{className:"button button--full-width"},r.a.createElement("div",{className:"callme-form__button-content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"button button--full-width button--arrow"},this.state.buttonLabel),r.a.createElement("div",{className:"callme-form__group callme-form__group--button"},e)}renderMessage(){return this.state.hasFailed?this.renderErrorMessage():this.state.hasSucceed?this.renderSuccessMessage():void 0}renderErrorMessage(){return r.a.createElement("div",{className:"callme-form__message callme-form__message--is-error"},this.state.displayedMessage)}renderSuccessMessage(){return r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal__content modal__content--small"},r.a.createElement("div",{className:"modal__close-button",onClick:this.resetState.bind(this)},r.a.createElement(Ge.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close-thin.svg",cacheGetRequests:!0})),r.a.createElement("h2",null,this.props.thanks),r.a.createElement("p",null,this.props.demandeReceived)))}}Ho.propTypes={leadSource:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,firstnameLabel:je.PropTypes.string.isRequired,lastnameLabel:je.PropTypes.string.isRequired,phoneLabel:je.PropTypes.string.isRequired,bestTimeCallValues:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})),thanks:je.PropTypes.string.isRequired,demandeReceived:je.PropTypes.string.isRequired};var zo=Ho,Wo=e=>{var t=window.DP.urls.login;window.location.href="".concat(t,"?").concat(e)},Ko=e=>({type:"SHOW_LISTING_INFORMATIONS_FORM",modalType:e});class Yo extends r.a.Component{constructor(e){super(e),this.state={messageValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_SELLER_CONTACT_FORM"})}handleClickWarning(){window.DP.store.dispatch(Ko("warning")),this.handleCloseClick()}handleButtonClick(){var e=this.props.property.listingId,t=this.state.messageValue;this.resetState(),this.setState({isSubmitting:!0}),xo({listingId:e,message:t}).then(t=>{this.setState({displayedMessage:t.message,hasSucceed:!0,isSubmitting:!1,messageValue:""}),this.props.property.listingOfferAssist?(Se.a.pushToDataLayer("gtm-event","Listing_OAS","Contact_Submit","undefined"),Se.a.pushDynamicEvent("listing-oa-click-showing-send","Listing")):"basic"===this.props.property.listingGtmType&&Se.a.pushDynamicEvent("listing-basic-click-showing-send","Listing"),Li(e,"send_email_to_client")}).catch(t=>{401===t.status&&Wo("do=contact-owner-list&code=".concat(e,"&url-back=").concat(encodeURIComponent(window.location.href))),this.setState({displayedMessage:t.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:""})}render(){if(!this.props.isVisible)return null;var e=He("seller-contact-form",{submitting:this.state.isSubmitting});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"seller-contact-form__content"},this.renderCloseButton(),r.a.createElement("div",{className:"seller-contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage({isSuccess:this.state.hasSucceed,isError:this.state.hasFailed,displayedMessage:this.state.displayedMessage}):null,r.a.createElement("div",{className:"seller-contact-form__info"},this.renderForm(),this.renderProperty()),this.renderSecurityWarning(),this.renderSubmitButton()))}renderForm(){return r.a.createElement("div",{className:"seller-contact-form__info-form"},this.renderMessageField(),r.a.createElement("div",{className:"seller-contact-form__disclaimer"},this.props.disclaimerText))}renderSecurityWarning(){if(window.DP.isRental)return r.a.createElement("div",{className:"seller-contact-form__disclaimer"},r.a.createElement("div",{className:"seller-contact-form__disclaimer-title"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-exclamation-mark.svg",cacheGetRequests:!0}),r.a.createElement("span",null,this.props.warningTitle)),r.a.createElement("div",{className:"seller-contact-form__disclaimer-content"},this.props.warningNote,r.a.createElement("span",{className:"seller-contact-form__disclaimer-link",onClick:this.handleClickWarning.bind(this)},this.props.warningLinkLabel)))}renderProperty(){return r.a.createElement("div",{className:"seller-contact-form__info-property"},r.a.createElement("div",{className:"seller-contact-form__info-property-photo"},r.a.createElement("img",{className:"seller-contact-form__info-property-photo-item",src:this.props.property.photoUrl})),r.a.createElement("div",{className:"seller-contact-form__property-info"},r.a.createElement("div",{className:"seller-contact-form__property-info-price"},this.props.property.price),r.a.createElement("div",{className:"seller-contact-form__property-info-city"},this.props.property.city)))}renderCloseButton(){return r.a.createElement("div",{className:"seller-contact-form__close-button",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"seller-contact-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderMessageField(){var e=He("seller-contact-form__group",{invalid:!1});return r.a.createElement("div",{className:e},r.a.createElement("label",{className:"seller-contact-form__label"},this.props.messageLabel),r.a.createElement("textarea",{rows:"8",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this),className:"seller-contact-form__field"}))}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?r.a.createElement("button",{className:t},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),r.a.createElement("div",{className:"seller-contact-form__group"},e)}renderMessage({isError:e,isSuccess:t,displayedMessage:s}){var a=He("seller-contact-form__message",{isError:e,isSuccess:t});return r.a.createElement("div",{className:a},s)}}Yo.propTypes={dispatch:je.PropTypes.func.isRequired,isVisible:je.PropTypes.bool,buttonLabel:je.PropTypes.string.isRequired,disclaimerText:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired,messagePlaceholder:je.PropTypes.string.isRequired,formTitle:je.PropTypes.string.isRequired,property:je.PropTypes.shape({listingId:je.PropTypes.string.isRequired,photoUrl:je.PropTypes.string.isRequired,city:je.PropTypes.string.isRequired,price:je.PropTypes.string,listingOfferAssist:je.PropTypes.bool,listingGtmType:je.PropTypes.string}).isRequired,warningLinkLabel:je.PropTypes.string.isRequired,warningTitle:je.PropTypes.string.isRequired,warningNote:je.PropTypes.string.isRequired};var Xo=Yo=Object(m.b)(({sellerContactForm:e})=>{var{isVisible:t}=e;return{isVisible:t}})(Yo),Zo=g.createProviderWrappedComponent(e=>r.a.createElement(Xo,e)),Jo=e=>{var t=window.DP.urls.proxyPostLead;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class Qo extends r.a.Component{constructor(e){super(e),this.state={nameValue:"",emailValue:"",phoneNumberValue:"",interestValue:"",sellValue:"",messageValue:"",displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_LISTING_CONTACT_FORM"})}handleFormSubmit(e){e.preventDefault(),this.resetState(),this.setState({isSubmitting:!0}),this.ignoreMessage()&&this.setState({messageValue:""}),"component-right-side"===this.props.version?this.handleSubmitLead():this.handleSubmitMessage()}handleSubmitMessage(){var{nameValue:e,emailValue:t,phoneNumberValue:s,interestValue:a,sellValue:i}=this.state,r=this.renderInputMessageWithListingUrl(),n=this.props.department,o=this.props.listingCity,l=this.props.listingPrice;Do({name:e,fromEmail:t,phone:s,interest:a,sell:i,message:r,department:n,listingCity:o,listingPrice:l}).then(e=>{var t="book_showing"===a?"listing-ddf-contact-showing":"listing-ddf-contact-information";this.pushGtmDataLayer(t),this.setSuccessStateFromResponse(e)}).catch(e=>{this.setErrorStateFromResponse(e)})}handleSubmitLead(){var{listingCity:e,listingPrice:t}=this.props,{nameValue:s,emailValue:a,phoneNumberValue:i,interestValue:r,sellValue:n}=this.state,o=this.renderInputMessageWithListingUrl(),l=this.getLeadSource();Jo({email:a,interest:r,message:o,name:s,phone:i.replace(/\D/g,""),sell:n,source:l,sourceDescription:l,listingCity:e,listingPrice:t}).then(e=>{var t="book_showing"===r?"listing-lead-contact-showing":"listing-lead-contact-information";this.pushGtmDataLayer(t),this.setSuccessStateFromResponse(e)}).catch(e=>{this.setErrorStateFromResponse(e)})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}handlePhoneNumberValueChange(e){this.setState({phoneNumberValue:e.target.value})}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleInterestValueChange(e){this.setState({interestValue:e.value}),window.Dropdown("hide")}handleSellValueChange(e){this.setState({sellValue:e.value}),this.setSellLabel(e.value),window.Dropdown("hide")}pushGtmDataLayer(e){var{gtmCategory:t}=this.props;Se.a.pushDynamicEvent(e,t)}setSellLabel(e){switch(e){case"sell_yes":this.sellLabel="yes";break;default:this.sellLabel="no"}this.setState({sellLabel:this.sellLabel})}setErrorStateFromResponse(e){this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})}setSuccessStateFromResponse(e){this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,nameValue:"",emailValue:"",phoneNumberValue:"",interestValue:"",sellValue:"",messageValue:""})}ignoreMessage(){return("more_information"!==this.state.interestValue||""===this.state.interestValue)&&(this.props.isDDFListing||this.props.isIDXListing||"component-right-side"===this.props.version)}getLeadSource(){return this.props.isDDFListing||this.props.isIDXListing?"DDF form":"Listing form"}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if("component-right-side"!==this.props.version&&"Content"===this.props.origin&&!this.props.isVisible)return null;var e=He("listing-contact-form",{submitting:this.state.isSubmitting}),t=He("listing-contact-form__content",{"component-right-side":"component-right-side"===this.props.version});return r.a.createElement("div",{className:t},r.a.createElement("form",{className:e},this.renderCloseButton(),r.a.createElement("div",{className:"listing-contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,this.renderNameField(),this.renderEmailField(),this.renderPhoneField(),this.renderInterestField(),this.renderSellField(),this.renderMessageField(),this.renderSubmitButton()))}renderNameField(){return this.renderField({name:"name",value:this.state.nameValue,label:this.props.nameLabel,placeholder:this.props.namePlaceholder,required:!0,changeCallback:this.handleNameValueChange})}renderEmailField(){return this.renderField({name:"from",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!0,changeCallback:this.handleEmailValueChange})}renderPhoneField(){return this.renderField({name:"phone",value:this.state.phoneNumberValue,label:this.props.phoneNumberLabel,placeholder:this.props.phoneNumberPlaceholder,required:!0,changeCallback:this.handlePhoneNumberValueChange})}renderInterestField(){var e=He("listing-contact-form__field",{invalid:"interest"===this.state.errorField});return r.a.createElement("label",{className:e},r.a.createElement("div",{className:"listing-contact-form__label"},this.props.interestLabel),r.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),r.a.createElement(ar,{dropdownId:"listing_contact-interest-dropdown",options:this.props.interestOptions,placeholder:this.props.interestPlaceholder,selected:this.state.interestValue,onSelect:this.handleInterestValueChange.bind(this)}))}renderSellField(){var e=He("listing-contact-form__field",{invalid:"sell"===this.state.errorField});return r.a.createElement("label",{className:e},r.a.createElement("div",{className:"listing-contact-form__label"},this.props.sellLabel),r.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),r.a.createElement(ar,{dropdownId:"listing_contact-sell-dropdown",options:this.props.sellOptions,placeholder:this.props.sellPlaceholder,selected:this.state.sellValue,onSelect:this.handleSellValueChange.bind(this)}))}renderMessageField(){if(this.ignoreMessage())return null;var e=He("listing-contact-form__field",{invalid:"message"===this.state.errorField});return r.a.createElement("label",{className:e},r.a.createElement("div",{className:"listing-contact-form__label"},this.props.messageLabel),r.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),r.a.createElement("textarea",{className:"listing-contact-form__input",id:"contact-us-message",name:"message",value:this.state.messageValue,rows:"6",placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this)}))}renderField({name:e,value:t,label:s,placeholder:a,required:i,changeCallback:n}){var o=He("listing-contact-form__field",{invalid:this.state.errorField===e}),l="listing-contact-form-".concat(e);return r.a.createElement("label",{className:o},r.a.createElement("div",{className:"listing-contact-form__label"},s),i?r.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel):"",r.a.createElement("input",{id:l,name:e,value:t,className:"listing-contact-form__input",placeholder:a,onChange:n.bind(this)}))}renderSubmitButton(){return this.state.isSubmitting?r.a.createElement("button",{className:"button button--full button--arrow"},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{className:"button button--full button--arrow",type:"submit",onClick:this.handleFormSubmit.bind(this)},this.props.submit)}renderMessage(){var e=He("listing-contact-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}renderInputMessageWithListingUrl(){return this.state.messageValue||this.ignoreMessage()?"".concat(this.state.messageValue,"\n\n        ").concat(this.props.listingUrl):this.state.messageValue}renderCloseButton(){return r.a.createElement("div",{className:"listing-contact-form__close-button",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"listing-contact-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}}Qo.propTypes={dispatch:je.PropTypes.func.isRequired,isVisible:je.PropTypes.bool,origin:je.PropTypes.string.isRequired,nameLabel:je.PropTypes.string.isRequired,namePlaceholder:je.PropTypes.string.isRequired,emailLabel:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,phoneNumberLabel:je.PropTypes.string.isRequired,phoneNumberPlaceholder:je.PropTypes.string.isRequired,interestLabel:je.PropTypes.string.isRequired,interestPlaceholder:je.PropTypes.string.isRequired,interestOptions:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,sellLabel:je.PropTypes.string.isRequired,sellPlaceholder:je.PropTypes.string.isRequired,sellOptions:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,messageLabel:je.PropTypes.string.isRequired,messagePlaceholder:je.PropTypes.string.isRequired,department:je.PropTypes.string.isRequired,listingUrl:je.PropTypes.string.isRequired,listingCity:je.PropTypes.string.isRequired,listingPrice:je.PropTypes.number.isRequired,formTitle:je.PropTypes.string.isRequired,submit:je.PropTypes.string.isRequired,requiredLabel:je.PropTypes.string.isRequired,gtmCategory:je.PropTypes.string,gtmAction:je.PropTypes.string,isDDFListing:je.PropTypes.bool,isIDXListing:je.PropTypes.bool,version:je.PropTypes.string};var el=Qo=Object(m.b)(({listingContactForm:e})=>{var{isVisible:t}=e;return{isVisible:t}})(Qo),tl=g.createProviderWrappedComponent(e=>r.a.createElement(el,e)),sl=e=>{var t=()=>{Se.a.pushDynamicEvent("right-side-".concat(e.id,"-oa-email"),window.DP.context.pageType)},s=()=>{Se.a.pushDynamicEvent("right-side-".concat(e.id,"-oa-phone-number"),window.DP.context.pageType)};return r.a.createElement("div",{className:"listing-contact__action--submit--content"},r.a.createElement("p",{className:"listing-contact__action--submit__title"},e.labels.sections.offer_assist.title),e.labels.sections.offer_assist.phone.value?r.a.createElement("div",{className:"listing-contact__action--submit--phone"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-contact-phone.svg",cacheGetRequests:!0}),r.a.createElement("div",null,r.a.createElement("span",{className:"listing-contact__action--submit--phone__title"},e.labels.sections.offer_assist.phone.label),r.a.createElement("span",null,r.a.createElement("a",{className:"listing-contact__action--submit--phone__value",href:e.labels.sections.offer_assist.phone.link,onClick:s},e.labels.sections.offer_assist.phone.value)))):null,e.labels.sections.offer_assist.fax.value?r.a.createElement("div",{className:"listing-contact__action--submit--fax"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-contact-fax.svg",cacheGetRequests:!0}),r.a.createElement("div",null,r.a.createElement("span",{className:"listing-contact__action--submit--fax__title"},e.labels.sections.offer_assist.fax.label),r.a.createElement("span",null,e.labels.sections.offer_assist.fax.value))):null,e.labels.sections.offer_assist.email.value?r.a.createElement("div",{className:"listing-contact__action--submit--mail"},r.a.createElement(Ge.a,{src:"/build/img/svg/icn-contact-mail.svg",cacheGetRequests:!0}),r.a.createElement("div",null,r.a.createElement("span",{className:"listing-contact__action--submit--mail__title"},e.labels.sections.offer_assist.email.label),r.a.createElement("span",null,r.a.createElement("a",{className:"listing-contact__action--submit--mail__value",href:"mailto:".concat(e.labels.sections.offer_assist.email.value),onClick:t},e.labels.sections.offer_assist.email.value)))):null)};sl.propTypes={id:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired};var al=sl;class il extends r.a.Component{componentDidMount(){window.location=location.pathname+"/contact-seller"}render(){return r.a.createElement("span",null)}}var rl=il,nl=e=>r.a.createElement("div",{className:"listing-contact__action--submit--content"},r.a.createElement("p",null,r.a.createElement("a",{className:"link link--arrow",href:e.url,onClick:()=>{Se.a.pushDynamicEvent("right-side-showing-book-online",window.DP.context.pageType)},target:"_self"},e.link)));nl.propTypes={link:je.PropTypes.string.isRequired,url:je.PropTypes.string.isRequired};var ol=nl,ll=e=>r.a.createElement("div",{className:"listing-contact__action--submit--content"},r.a.createElement("p",null,e.text));ll.propTypes={text:je.PropTypes.string.isRequired};var cl=ll,pl=e=>r.a.createElement("div",{className:"link link--arrow",onClick:()=>{e.handleSwitchUser(e.id)}},e.title);pl.propTypes={handleSwitchUser:je.PropTypes.func.isRequired,id:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired};var dl=pl,hl=e=>r.a.createElement("div",{className:"listing-contact__action--book--content"},r.a.createElement("p",{className:"listing-contact__action--content__text"},e.labels.sections.user_choice.intro),r.a.createElement(dl,{handleSwitchUser:e.handleSwitchUser,id:"buyer",title:e.labels.sections.user_choice.buyer}),r.a.createElement(dl,{handleSwitchUser:e.handleSwitchUser,id:"agent",title:e.labels.sections.user_choice.agent}));hl.propTypes={handleSwitchUser:je.PropTypes.func.isRequired,labels:je.PropTypes.object.isRequired};var ul=hl,ml=e=>r.a.createElement("div",{className:"link link--arrow",onClick:()=>{e.handleSelectRequest(e.status)}}," ",e.response);ml.propTypes={response:je.PropTypes.string.isRequired,status:je.PropTypes.bool.isRequired,handleSelectRequest:je.PropTypes.func.isRequired};var gl=ml,_l=e=>r.a.createElement("div",{className:"listing-contact__action--book--content"},r.a.createElement("p",{className:"listing-contact__action--content__text"},e.labels.sections.work_with_agent.intro),r.a.createElement(gl,{handleSelectRequest:e.handleSelectRequest,status:!0,response:e.labels.sections.work_with_agent.yes}),r.a.createElement(gl,{handleSelectRequest:e.handleSelectRequest,status:!1,response:e.labels.sections.work_with_agent.no}));_l.propTypes={labels:je.PropTypes.object.isRequired,handleSelectRequest:je.PropTypes.func.isRequired};var bl=_l;class vl extends r.a.Component{constructor(e){super(e),this.state={user:"",userWorkWithAgent:""}}switchUser(e){this.setState({user:e}),this.pushGtmEvent(e)}handleSelectRequest(e){this.setState({userWorkWithAgent:e});var t=e?"yes":"no";this.pushGtmEvent(t)}pushGtmEvent(e){var{id:t}=this.props;Se.a.pushDynamicEvent("right-side-".concat(t,"-click-").concat(e),window.DP.context.pageType)}renderContactForm(){var{listingContactFormProps:e,origin:t}=this.props;return r.a.createElement("div",{className:"listing-contact__content__form"},r.a.createElement(tl,{department:e.department,emailLabel:e.emailLabel,emailPlaceholder:e.emailPlaceholder,formTitle:e.formTitle,gtmAction:e.gtmAction,gtmCategory:e.gtmCategory,interestLabel:e.interestLabel,interestOptions:e.interestOptions,interestPlaceholder:e.interestPlaceholder,isDDFListing:e.isDDFListing,isIDXListing:e.isIDXListing,isVisible:e.isVisible,listingCity:e.listingCity,listingPrice:e.listingPrice,listingUrl:e.listingUrl,messageLabel:e.messageLabel,messagePlaceholder:e.messagePlaceholder,nameLabel:e.nameLabel,namePlaceholder:e.namePlaceholder,phoneNumberLabel:e.phoneNumberLabel,phoneNumberPlaceholder:e.phoneNumberPlaceholder,requiredLabel:e.requiredLabel,sellLabel:e.sellLabel,sellOptions:e.sellOptions,sellPlaceholder:e.sellPlaceholder,submit:e.submit,origin:t,version:"component-right-side"}))}renderContent(){var{user:e}=this.state,{id:t,labels:s,listing:a}=this.props;if(!e)return r.a.createElement(ul,{handleSwitchUser:e=>this.switchUser(e),labels:s});if(a.is_ddf_idx||a.has_showing_service&&"offer"!==t)switch(this.state.userWorkWithAgent){case!0:return r.a.createElement(cl,{text:this.props.labels.sections.work_with_agent.contact});case!1:break;default:if("buyer"===e)return r.a.createElement(bl,{handleSelectRequest:this.handleSelectRequest.bind(this),labels:s})}switch(t){case"showing":return this.renderContentShowing();case"offer":return this.renderContentOffer();case"contact":default:return this.renderContentContact()}}renderContentContact(){var{id:e,labels:t,listing:s}=this.props,{user:a}=this.state;return s.is_ddf_idx?"buyer"===a?this.renderContactForm():r.a.createElement(cl,{text:t.submit_offer.ddf_idx}):s.has_showing_service?"buyer"===a?this.renderContactForm():r.a.createElement(al,{id:e,labels:t}):s.has_offer_assist?"buyer"===a?r.a.createElement(rl,null):r.a.createElement(al,{id:e,labels:t}):r.a.createElement(rl,null)}renderContentOffer(){var{id:e,labels:t,listing:s}=this.props,{user:a}=this.state;return s.is_ddf_idx?"buyer"===a?this.renderContactForm():r.a.createElement(cl,{text:t.submit_offer.ddf_idx}):s.has_offer_assist||s.has_showing_service?r.a.createElement(al,{id:e,labels:t}):r.a.createElement(rl,null)}renderContentShowing(){var{labels:e,listing:t}=this.props,{user:s}=this.state;return t.is_ddf_idx?"buyer"===s?this.renderContactForm():r.a.createElement(cl,{text:e.book_showing.ddf_idx}):t.has_showing_service?"buyer"===s?this.renderContactForm():(Se.a.pushDynamicEvent("book-online-button-view",window.DP.context.pageType),r.a.createElement(ol,{link:e.book_showing.online.link,url:e.book_showing.online.url})):r.a.createElement(rl,null)}render(){return r.a.createElement("div",{className:"listing-contact__panel__body"},this.renderContent())}}vl.propTypes={id:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,listingContactFormProps:je.PropTypes.object.isRequired,origin:je.PropTypes.string.isRequired};var yl=vl,fl=e=>{var t=e.active,s=He("button--plus",{active:t}),a=["button"].concat(s);return r.a.createElement("div",{className:a.join(" "),onClick:()=>{e.handleSwitchPanel(e.id)}},e.title,r.a.createElement("span",null))};fl.propTypes={active:je.PropTypes.bool.isRequired,handleSwitchPanel:je.PropTypes.func.isRequired,id:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired};var Tl=fl,Pl=e=>r.a.createElement("div",{className:"listing-contact__action-submit"},r.a.createElement(Tl,e),e.active?r.a.createElement(yl,{id:e.id,labels:e.labels,listing:e.listing,listingContactFormProps:e.listingContactFormProps,origin:e.origin}):null);Pl.propTypes={active:je.PropTypes.bool.isRequired,handleSwitchPanel:je.PropTypes.func.isRequired,id:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,listingContactFormProps:je.PropTypes.object.isRequired,origin:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired};var wl=Pl;function El(){return(El=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class Cl extends r.a.Component{constructor(e){super(e),this.state={activePanel:""}}isPanelActive(e){return e===this.state.activePanel}switchPanel(e){e===this.state.activePanel&&(e=""),this.setState({activePanel:e}),""!==e&&Se.a.pushDynamicEvent("right-side-".concat(e,"-view"),window.DP.context.pageType)}render(){var{labels:e}=this.props;return r.a.createElement("div",{className:"listing-contact__actions"},r.a.createElement(wl,El({active:this.isPanelActive("showing"),handleSwitchPanel:e=>this.switchPanel(e),id:"showing",title:e.book_showing.title},this.props)),r.a.createElement(wl,El({active:this.isPanelActive("offer"),handleSwitchPanel:e=>this.switchPanel(e),id:"offer",title:e.submit_offer.title},this.props)),r.a.createElement(wl,El({active:this.isPanelActive("contact"),handleSwitchPanel:e=>this.switchPanel(e),id:"contact",title:e.contact.title},this.props)))}}Cl.propTypes={labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,listingContactFormProps:je.PropTypes.object.isRequired};var Sl=Cl,Rl=e=>{var t=e.scope;return r.a.createElement("div",{className:"listing-mortgage-calculator__ad js-mortgage-data__new-form-".concat(t.toLowerCase()),"data-category":"Listing","data-action":"View_".concat(t,"-MortgageCalculator")},r.a.createElement("p",{dangerouslySetInnerHTML:{__html:e.adZone}}))};Rl.propTypes={adZone:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired};var Nl=Rl,kl=e=>r.a.createElement("div",{className:"listing-mortgage-calculator__form__tooltip"},r.a.createElement("span",{className:"listing-mortgage-calculator__form__tooltip__icon"},"i"),r.a.createElement("p",{className:"listing-mortgage-calculator__form__tooltip__content"},e.text));kl.propTypes={active:je.PropTypes.bool.isRequired,text:je.PropTypes.string.isRequired};var Ll=kl,ql=r.a.Fragment;class Ol extends r.a.Component{constructor(e){super(e),this.state={helpShow:!1}}handleShowHideHelp(){var{helpShow:e}=this.state;this.setState({helpShow:!e})}render(){var{children:e,help:t,label:s,typeInput:a}=this.props,{helpShow:i}=this.state,n=void 0!==a?"listing-mortgage-calculator__form__field--input":"";return r.a.createElement(ql,null,r.a.createElement("div",{className:"listing-mortgage-calculator__form__field ".concat(n)},r.a.createElement("label",null,s),r.a.createElement(Ll,{active:i,text:t,onClick:()=>this.handleShowHideHelp()}),e))}}Ol.propTypes={children:je.PropTypes.object.isRequired,help:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired,typeInput:je.PropTypes.string};var xl=Ol,Dl=r.a.Fragment;class Ml extends r.a.Component{constructor(e){super(e)}componentDidMount(){setTimeout(()=>{var e={start:[this.getSliderStartingPrice()],connect:"lower",range:this.getSliderDefaultSteps(),format:{to:Number,from:Number}};this.slider=es.a.create(this.refs.slider,e),this.slider.on("slide",this.handleSliderSlide.bind(this)),window.DP.configSwitch.Gtm&&this.slider.on("change",this.handleSliderChange.bind(this))})}componentWillUnmount(){this.slider.off("update"),this.slider.off("slide")}getSliderStartingPrice(){var e=this.props.value,t=h.a.decodeValue(e);return"interest"!==this.props.id?Math.round(t/this.getSliderStep())*this.getSliderStep():e.toString().replace(",",".")}getSliderMaximumPrice(){switch(this.props.id){case"downPayment":return 5e5;case"interest":return 10;default:return 3e6}}getSliderStep(){switch(this.props.id){case"price":return 5e4;case"downPayment":return 1e4;default:return.1}}getGtmLabelBasedOnId(){switch(this.props.id){case"downPayment":return"DownPayment";case"interest":return"InterestRate";default:case"price":return"PurchasePrice"}}getGtmActionScope(){switch(this.props.scope){case"Costs":return"Cost";default:case"Description":return"Description"}}getSliderDefaultSteps(){var e={min:[0,this.getSliderStep()],max:[this.getSliderMaximumPrice()]};return"price"===this.props.id?(e["45%"]=[5e5,this.getSliderStep()],e["90%"]=[2e6,this.getSliderStep()]):"downPayment"===this.props.id&&(e["45%"]=[25e4,this.getSliderStep()]),e}encodeCurrencyValueDisplay(){var{id:e,value:t}=this.props,s="en"!==window.DP.lang;return"price"===e||"downPayment"===e?h.a.encodeCurrencyValue(t,{noDecimal:!0,noDollarSign:s}):t.toString().replace(",",".")}onInputChange(e){var t="price"===this.props.id||"downPayment"===this.props.id?h.a.decodeValue(e.target.value):e.target.value;this.props.onChange(this.props.id,t.toString()),this.slider.set(t),this.renderMonthlyMortgageCostsTableCell()}handleSliderSlide(e){var t=e[0],s="interest"===this.props.id?t.toFixed(2):t;this.onSliderChange(this.props.id,s)}handleSliderChange(){var e="Use_".concat(this.getGtmActionScope(),"-MortgageCalculator");Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,e,this.getGtmLabelBasedOnId())}onSliderChange(e,t){this.renderMonthlyMortgageCostsTableCell(),this.props.onChange(e,t.toString())}renderInputType(){return"interest"===this.props.id?"number":"text"}renderMonthlyMortgageCostsTableCell(){if("qc"===window.DP.province)return null;setTimeout(()=>{new Vs(d()(".listing-mortgage-calculator__content")).calculate(d()(".mortgage-data__table__row__monthly-mortgage"))})}renderSlider(){return r.a.createElement("div",{className:"savings-calculator__slider"},r.a.createElement("div",{ref:"slider"}))}render(){return r.a.createElement(Dl,null,r.a.createElement("input",{id:this.props.id,name:this.props.id,value:this.encodeCurrencyValueDisplay(),onChange:this.onInputChange.bind(this),type:this.renderInputType(),className:"listing-mortgage-calculator__form__input"}),this.renderSlider())}}Ml.propTypes={id:je.PropTypes.string.isRequired,onChange:je.PropTypes.func.isRequired,value:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired};var Al=Ml,Il=r.a.Fragment;class Bl extends r.a.Component{onChange(e){this.props.onChange(this.props.id,e.value);var t="Click_".concat(this.getGtmActionScope(),"-MortgageCalculator");Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,t,this.getGtmLabelBasedOnId())}getGtmLabelBasedOnId(){switch(this.props.id){case"amortization":return"Amortization";case"term":return"Term";default:case"frequency":return"PaymentFrequency"}}getGtmActionScope(){switch(this.props.scope){case"Costs":return"Cost";default:case"Description":return"Description"}}render(){var{id:e,options:t,value:s}=this.props;return r.a.createElement(Il,null,r.a.createElement(ar,{onSelect:e=>this.onChange(e),dropdownId:e,selected:s,options:t}))}}Bl.propTypes={id:je.PropTypes.string.isRequired,onChange:je.PropTypes.func.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,value:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired};var Fl=Bl,jl=r.a.Fragment,Vl=e=>r.a.createElement(jl,null,r.a.createElement("div",{className:"listing-mortgage-calculator__form"},r.a.createElement(xl,{help:e.labels.fields.price.help,label:e.labels.fields.price.label,typeInput:"input"},r.a.createElement(Al,{id:"price",onChange:e.onChange,value:e.price,scope:e.scope})),r.a.createElement(xl,{help:e.labels.fields.downPayment.help,label:e.labels.fields.downPayment.label,typeInput:"input"},r.a.createElement(Al,{id:"downPayment",onChange:e.onChange,value:e.downPayment,scope:e.scope})),r.a.createElement(xl,{help:e.labels.fields.interest.help,label:e.labels.fields.interest.label,typeInput:"input"},r.a.createElement(Al,{id:"interest",onChange:e.onChange,value:e.interest,scope:e.scope})),r.a.createElement(xl,{help:e.labels.fields.amortization.help,label:e.labels.fields.amortization.label},r.a.createElement(Fl,{id:"amortization",onChange:e.onChange,options:e.labels.fields.amortization.options,value:e.amortization,scope:e.scope})),r.a.createElement(xl,{help:e.labels.fields.term.help,label:e.labels.fields.term.label},r.a.createElement(Fl,{id:"term",onChange:e.onChange,options:e.labels.fields.term.options,value:e.term,scope:e.scope})),r.a.createElement(xl,{help:e.labels.fields.frequency.help,label:e.labels.fields.frequency.label},r.a.createElement(Fl,{id:"frequency",onChange:e.onChange,options:e.labels.fields.frequency.options,value:e.frequency,scope:e.scope}))));Vl.propTypes={amortization:je.PropTypes.string.isRequired,downPayment:je.PropTypes.string.isRequired,frequency:je.PropTypes.string.isRequired,interest:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired,onChange:je.PropTypes.func.isRequired,price:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired,term:je.PropTypes.string.isRequired};var Ul=Vl,$l=s(236),Gl=s.n($l),Hl=s(70);class zl extends r.a.Component{constructor(e){super(e),this.state={triggerCountUpOnce:"Costs"===this.props.scope},this.triggerCountUp=this.handleScrollToItem.bind(this),this.startAmount=[],this.loadCounter=0}componentDidMount(){window.addEventListener("scroll",this.triggerCountUp)}handleScrollToItem(){this.state.triggerCountUpOnce||Hl.a.hasScrolledIntoView(".js-trigger-countup-".concat(this.props.scope,"-1"))&&(this.setState({triggerCountUpOnce:!0}),window.removeEventListener("scroll",this.triggerCountUp))}renderResults(){var e="en"===window.DP.lang,t=e?/(\$)/g:/(\s\$)/g;if(this.state.triggerCountUpOnce){this.loadCounter<=1&&this.loadCounter++;var s=this.props.amount,a=s.replace(/[\d\s\^$.,]+/g," ").substr(1),i=Number(s.replace(/[^0-9.]+/g,"")),n=",",o=".",l="<sup>$</sup>",c=" ".concat(a);e||(i=Number(s.replace(/[^0-9,]+/g,"").split(",").join(".")),n=" ",o=",",l="",c="<sup>$</sup> ".concat(a));var p="qc"===window.DP.province?"0":i,h=r.a.createElement(Gl.a,{start:this.startAmount[this.props.resultKey],end:i,delay:0,duration:1.3,separator:n,decimals:0,decimal:o,prefix:l,suffix:c,onEnd:()=>this.startAmount[this.props.resultKey]=i},({countUpRef:e})=>r.a.createElement("div",null,r.a.createElement("span",{ref:e})));return this.loadCounter>1?r.a.createElement("div",{className:"listing-mortgage-calculator__result__amount","data-amount":p,dangerouslySetInnerHTML:{__html:s.replace(t,"<sup>$</sup>")}}):("qc"!==window.DP.province&&setTimeout(()=>{new Vs(d()(".listing-mortgage-calculator__content")).calculate(d()(".mortgage-data__table__row__monthly-mortgage"))}),r.a.createElement("div",{className:"listing-mortgage-calculator__result__amount","data-amount":p},h))}}render(){return r.a.createElement("div",{className:"listing-mortgage-calculator__result js-trigger-countup-".concat(this.props.scope,"-").concat(this.props.resultKey)},r.a.createElement("div",{className:"listing-mortgage-calculator__result__label"},this.props.label),this.renderResults())}}zl.propTypes={amount:je.PropTypes.string.isRequired,label:je.PropTypes.string.isRequired,resultKey:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired};var Wl=zl;class Kl extends r.a.Component{constructor(e){super(e),this.state={showDisclaimer:!1},this.handleToggleDisclaimer=this.handleToggleDisclaimer.bind(this)}handleToggleDisclaimer(e){e.preventDefault(),this.setState({showDisclaimer:!this.state.showDisclaimer})}renderSpecialDisclaimer(){if(""!==this.props.specialDisclaimer)return r.a.createElement("p",{className:"listing-mortgage-calculator__disclaimer-information"},this.props.disclaimer.special[this.props.specialDisclaimer])}render(){var e=He("listing-mortgage-calculator__disclaimer",{open:this.state.showDisclaimer});return r.a.createElement("div",{className:e},this.renderSpecialDisclaimer(),r.a.createElement("h3",{className:"listing-mortgage-calculator__disclaimer-title"},r.a.createElement("a",{href:"#",className:"listing-mortgage-calculator__disclaimer-link",onClick:this.handleToggleDisclaimer},this.props.disclaimer.title)),r.a.createElement("p",{className:"listing-mortgage-calculator__disclaimer-content"},this.props.disclaimer.text))}}Kl.propTypes={disclaimer:je.PropTypes.object.isRequired,specialDisclaimer:je.PropTypes.string.isRequired};var Yl=Kl;function Xl(e,t){if(null==e)return{};var s,a,i=function(e,t){if(null==e)return{};var s,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)s=r[a],t.indexOf(s)>=0||(i[s]=e[s]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)s=r[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}var Zl=r.a.Fragment,Jl=e=>{var{adZone:t,amount:s,disclaimer:a,payments:i,specialDisclaimer:n}=e,o=Xl(e,["adZone","amount","disclaimer","payments","specialDisclaimer"]);return r.a.createElement(Zl,null,r.a.createElement("div",{className:"listing-mortgage-calculator__content"},r.a.createElement(Ul,o),r.a.createElement(Wl,{amount:s,label:o.labels.amount,resultKey:"1",scope:o.scope}),r.a.createElement(Wl,{amount:i,label:o.labels.payments,resultKey:"2",scope:o.scope}),r.a.createElement(Nl,{adZone:t,scope:o.scope}),r.a.createElement(Yl,{disclaimer:a,specialDisclaimer:n})))};Jl.propTypes={adZone:je.PropTypes.string.isRequired,amortization:je.PropTypes.string.isRequired,amount:je.PropTypes.string.isRequired,disclaimer:je.PropTypes.object.isRequired,downPayment:je.PropTypes.string.isRequired,frequency:je.PropTypes.string.isRequired,interest:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired,onChange:je.PropTypes.func.isRequired,payments:je.PropTypes.string.isRequired,price:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired,term:je.PropTypes.string.isRequired,specialDisclaimer:je.PropTypes.string.isRequired};var Ql=Jl,ec=r.a.Fragment,tc=e=>{var t="ab"===window.DP.province,s=()=>{switch(e.scope){case"Costs":return e.logoUrl.cost;default:case"Description":return e.logoUrl.description}};return r.a.createElement(ec,null,r.a.createElement("div",{className:"listing-box__title listing-mortgage-calculator__header"},t||e.isPurpleBricks&&!e.isAdToggleSwitchOn?r.a.createElement("h3",{className:"listing-mortgage-calculator__header__title"},e.title.alternate):r.a.createElement(ec,null,r.a.createElement("h3",{className:"listing-mortgage-calculator__header__title--short"},e.title.short),r.a.createElement("h3",{className:"listing-mortgage-calculator__header__title--long"},e.title.long)),t||e.isPurpleBricks&&!e.isAdToggleSwitchOn?null:r.a.createElement("a",{href:s(),target:"_blank",className:"listing-mortgage-calculator__logo-link"},r.a.createElement("img",{src:e.logoPath,alt:"",className:"listing-mortgage-calculator__logo"}))))};tc.propTypes={isAdToggleSwitchOn:je.PropTypes.bool,isPurpleBricks:je.PropTypes.bool,logoPath:je.PropTypes.string.isRequired,logoUrl:je.PropTypes.object.isRequired,title:je.PropTypes.object.isRequired,scope:je.PropTypes.string.isRequired};var sc=tc,ac=(e,t)=>({type:"SET_MORTGAGE_CALCULATOR_VALUE",id:e,value:t=((e,t)=>"price"===e||"downPayment"===e?parseInt(t,10)>0?t:"":"interest"===e?parseFloat(t)>=0?t:"":t)(e,t)});class ic extends r.a.Component{componentDidMount(){this.props.dispatch(ac("price",this.props.priceDefault)),this.props.dispatch(ac("downPayment",this.props.downPaymentDefault))}handleInputChange(e,t){this.props.dispatch(ac(e,t)),window.Dropdown("hide")}getFrequencyLabel(){var{frequency:e,labels:t}=this.props,s=t.fields.frequency.options;if(s){var a=s.filter((function(t){return t.value===e}));if(a)return a[0].label}return""}addFrequencyLabelToPayments(e){var t=this.getFrequencyLabel();return"".concat(e," ").concat(t)}renderPositiveNumbersOnly(e){return h.a.decodeValue(e)<0?this.renderFormatCurrencyValue("0",!1):e}renderFormatCurrencyValue(e,t){return h.a.encodeCurrencyValue(e,{noDecimal:t})}render(){var{adZone:e,amortization:t,downPayment:s,frequency:a,interest:i,isAdToggleSwitchOn:n,isPurpleBricks:o,labels:l,price:c,scope:p,term:d,specialDisclaimer:h}=this.props,u=de(c,s),m=this.renderPositiveNumbersOnly(this.renderFormatCurrencyValue(u,!0)),g=this.renderPositiveNumbersOnly(this.renderFormatCurrencyValue(he(a,u,i,t),!0));return r.a.createElement("div",{className:"listing-box listing-mortgage-calculator"},r.a.createElement(sc,{isAdToggleSwitchOn:n,isPurpleBricks:o,logoPath:l.logoPath,logoUrl:l.logoUrl,title:l.title,scope:p}),r.a.createElement(Ql,{adZone:e,amortization:t,amount:m,disclaimer:l.disclaimer,downPayment:s,frequency:a,interest:i,labels:l,onChange:(e,t)=>this.handleInputChange(e,t),payments:this.addFrequencyLabelToPayments(g),price:c,scope:p,term:d,specialDisclaimer:h}))}}ic.propTypes={specialDisclaimer:je.PropTypes.string.isRequired,adZone:je.PropTypes.string.isRequired,amortization:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired,downPayment:je.PropTypes.string.isRequired,downPaymentDefault:je.PropTypes.string.isRequired,frequency:je.PropTypes.string.isRequired,interest:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired,price:je.PropTypes.string.isRequired,priceDefault:je.PropTypes.string.isRequired,scope:je.PropTypes.string.isRequired,term:je.PropTypes.string.isRequired,isAdToggleSwitchOn:je.PropTypes.bool,isPurpleBricks:je.PropTypes.bool},ic=Object(m.b)(({mortgageCalculator:e})=>{var{amortization:t,downPayment:s,frequency:a,interest:i,price:r,term:n}=e;return{amortization:t,downPayment:s,frequency:a,interest:i,price:r,term:n}})(ic);var rc=g.createProviderWrappedComponent(e=>r.a.createElement(ic,e)),nc=window.DP.context.route,oc="highway-subscribe-callbuyer";class lc extends r.a.Component{constructor(e){super(e),this.state={departmentValue:-1!==nc.indexOf("rental::")?"rental":"customer_service",emailValue:"",firstnameValue:"",lastnameValue:"",phoneValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,formTitle:this.props.formTitle,formText:this.props.formText,buttonLabel:this.props.buttonLabel,whenPlanningToSellValue:this.renderDefaultPlanningToSellValue()}}componentDidMount(){this.renderTextsBasedOnContext()}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_CALLBACK_FORM"})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.leadSource,t=this.state.emailValue,s=this.state.firstnameValue,a=this.state.lastnameValue,i=this.state.phoneValue.replace(/\D/g,""),r=this.state.whenPlanningToSellValue;Go({fromEmail:t,firstname:s,lastname:a,phone:i,source:e,whenPlanningToSell:r}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,emailValue:"",firstnameValue:"",lastnameValue:"",phoneValue:"",whenPlanningToSellValue:this.renderDefaultPlanningToSellValue()}),Se.a.pushDynamicEvent(this.props.origin,"CallMeBackPage")}).catch(e=>{this.setState({displayedMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleFirstnameValueChange(e){this.setState({firstnameValue:e.target.value})}handleLastnameValueChange(e){this.setState({lastnameValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleWhenPlanningToSellValueValueChange(e){this.setState({whenPlanningToSellValue:e.value}),window.Dropdown("hide")}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}renderTextsBasedOnContext(){switch(this.props.origin){case"highway-subscribe-callhome":this.setState({formTitle:this.props.formTitleHome,formText:this.props.formTextHome,buttonLabel:this.props.buttonLabelHome});break;case"highway-subscribe-callseller":this.setState({formTitle:this.props.formTitleSell,formText:this.props.formTextSell,buttonLabel:this.props.buttonLabelSell});break;case oc:this.setState({formTitle:this.props.formTitleBuy,formText:this.props.formTextBuy,buttonLabel:this.props.buttonLabelBuy})}}renderDefaultPlanningToSellValue(){return this.props.origin===oc?null:this.props.whenPlanningToSellValues[0].value}render(){if(!this.props.isVisible)return null;var e=He("modal",{submitting:this.state.isSubmitting});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"modal__content modal__content--big callback-form"},this.renderCloseButton(),r.a.createElement("div",{className:"callback-form__title",dangerouslySetInnerHTML:{__html:this.state.formTitle}}),r.a.createElement("div",{className:"callback-form__text",dangerouslySetInnerHTML:{__html:this.state.formText}}),this.state.displayedMessage?this.renderMessage():null,r.a.createElement("div",{className:"callback-form__column"},this.renderFirstnameField(),this.renderLastnameField(),this.renderPhoneField(),this.renderEmailField(),this.renderWhenPlanningToSellDropdown(),this.renderSubmitButton())))}renderCloseButton(){return r.a.createElement("div",{className:"modal__close-button",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderFirstnameField(){var e=He("callback-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",null,r.a.createElement("span",{className:"callback-form__label"},this.props.firstnameLabel),r.a.createElement("input",{className:"callback-form__field",placeholder:this.props.firstnamePlaceholder,value:this.state.firstnameValue,maxLength:"80",onChange:this.handleFirstnameValueChange.bind(this)})))}renderLastnameField(){var e=He("callback-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",null,r.a.createElement("span",{className:"callback-form__label"},this.props.lastnameLabel),r.a.createElement("input",{className:"callback-form__field",placeholder:this.props.lastnamePlaceholder,value:this.state.lastnameValue,maxLength:"80",onChange:this.handleLastnameValueChange.bind(this)})))}renderPhoneField(){var e=He("callback-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",null,r.a.createElement("span",{className:"callback-form__label"},this.props.phoneLabel),r.a.createElement(Vo.a,{type:"tel",mask:"(999) 999-9999",className:"callback-form__field",value:this.state.phoneValue,placeholder:this.props.phonePlaceholder,onChange:this.handlePhoneValueChange.bind(this)})))}renderEmailField(){var e=He("callback-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",null,r.a.createElement("span",{className:"callback-form__label"},this.props.emailLabel),r.a.createElement("input",{className:"callback-form__field",placeholder:this.props.emailPlaceholder,value:this.state.emailValue,type:"email",maxLength:"80",onChange:this.handleEmailValueChange.bind(this)})))}renderWhenPlanningToSellDropdown(){if(this.props.origin===oc)return null;var e=He("callback-form__group",{invalid:"from"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("label",null,r.a.createElement("span",{className:"callback-form__label"},this.props.whenPlanningToSellValues[0].label),r.a.createElement(ar,{dropdownId:"when-planning-to-sell-dropdown",options:this.props.whenPlanningToSellValues,selected:this.state.whenPlanningToSellValue,onSelect:this.handleWhenPlanningToSellValueValueChange.bind(this)})))}renderSubmitButton(){var e=null;return e=this.state.isSubmitting?r.a.createElement("button",{className:"button button--small button--arrow"},r.a.createElement("div",{className:"callback-form__button-content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"button button--small button--arrow"},this.state.buttonLabel),r.a.createElement("div",{className:"callback-form__group"},e)}renderMessage(){var e=He("callback-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return this.state.hasSucceed&&this.props.gtmCategory&&this.props.gtmAction&&Se.a.pushToDataLayer("gtm-event",this.props.gtmCategory,this.props.gtmAction,"undefined"),r.a.createElement("div",{className:e},this.state.displayedMessage)}}lc.propTypes={leadSource:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired,isVisible:je.PropTypes.bool,buttonLabel:je.PropTypes.string.isRequired,emailLabel:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,firstnameLabel:je.PropTypes.string.isRequired,firstnamePlaceholder:je.PropTypes.string.isRequired,lastnameLabel:je.PropTypes.string.isRequired,lastnamePlaceholder:je.PropTypes.string.isRequired,phoneLabel:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,formTitle:je.PropTypes.string.isRequired,formText:je.PropTypes.string.isRequired,formTitleHome:je.PropTypes.string.isRequired,formTextHome:je.PropTypes.string.isRequired,buttonLabelHome:je.PropTypes.string.isRequired,formTitleSell:je.PropTypes.string.isRequired,formTextSell:je.PropTypes.string.isRequired,buttonLabelSell:je.PropTypes.string.isRequired,formTitleBuy:je.PropTypes.string.isRequired,formTextBuy:je.PropTypes.string.isRequired,buttonLabelBuy:je.PropTypes.string.isRequired,gtmCategory:je.PropTypes.string,gtmAction:je.PropTypes.string,origin:je.PropTypes.string,whenPlanningToSellValues:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired}))};var cc=lc=Object(m.b)(({callbackForm:e})=>{var{isVisible:t,gtmCategory:s,gtmAction:a}=e;return{isVisible:t,gtmCategory:s,gtmAction:a}})(lc),pc=g.createProviderWrappedComponent(e=>r.a.createElement(cc,e)),dc=window.DP.isRental;class hc extends r.a.Component{constructor(e){super(e),this.state={nameValue:e.nameValue,emailValue:e.emailValue,phoneValue:"",problemTypeValue:this.renderDefaultProblemTypeValue(),messageValue:"",displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1,showField:e.isPurplebricks||dc}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_LISTING_INFORMATIONS_FORM"})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.property.listingId,t=this.props.modalType,{nameValue:s,emailValue:a,phoneValue:i,problemTypeValue:r,messageValue:n}=this.state;Mo({listingId:e,name:s,email:a,phone:i,problemtype:r,message:n,modaltype:t,IS_RENTAL:dc}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,nameValue:"",emailValue:"",phoneValue:"",messageValue:""})}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleProblemTypeValueChange(e){this.setState({problemTypeValue:e.value}),window.Dropdown("hide")}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({problemTypeValue:this.renderDefaultProblemTypeValue(),hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if(!this.props.isVisible)return null;var e=He("listing-information-form",{submitting:this.state.isSubmitting});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"listing-information-form__content"},this.renderCloseButton(),this.renderFormTitle(),r.a.createElement("div",{className:"listing-information-form__subtitle"},this.props.formSubtitle),this.state.displayedMessage?this.renderMessage({isSuccess:this.state.hasSucceed,isError:this.state.hasFailed,displayedMessage:this.state.displayedMessage}):null,r.a.createElement("div",{className:"listing-information-form__info"},this.renderForm()),this.renderSubmitButton()))}renderDefaultProblemTypeValue(){return"warning"!==this.props.modalType?this.props.problemTypeOptions[0].value:this.props.problemTypeOptionsWarning[0].value}renderForm(){return r.a.createElement("div",{className:"listing-information-form__info-form"},this.renderNameField(),this.renderEmailField(),this.renderPhoneField(),this.renderProblemType(),this.renderMessageField())}renderFormTitle(){var e="warning"!==this.props.modalType?this.props.formTitle:this.props.formTitleWarning;return r.a.createElement("div",{className:"listing-information-form__title"},e)}renderCloseButton(){return r.a.createElement("div",{className:"listing-information-form__close-button",onClick:this.handleCloseClick.bind(this)},r.a.createElement(Ge.a,{className:"listing-information-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderNameField(){return this.state.showField?this.renderField({name:"name",value:this.state.nameValue,label:this.props.nameLabel,placeholder:this.props.namePlaceholder,required:!1,changeCallback:this.handleNameValueChange}):null}renderEmailField(){return this.state.showField?this.renderField({name:"fromEmail",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!1,changeCallback:this.handleEmailValueChange}):null}renderPhoneField(){return this.state.showField?this.renderField({name:"phone",value:this.state.phoneValue,label:this.props.phoneLabel,placeholder:this.props.phonePlaceholder,required:!1,changeCallback:this.handlePhoneValueChange,mask:"(999) 999-9999"}):null}renderProblemType(){var e=He("listing-information-form__field",{invalid:"problem"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"listing-information-form__dropdown-header"},r.a.createElement("label",{className:"listing-information-form__field-label"},this.props.problemSelectLabel),r.a.createElement("span",{className:"listing-information-form__dropdown-required"},this.props.requiredLabel)),r.a.createElement(ar,{dropdownId:"information-problemtype-dropdown",options:this.renderProblemTypeOptions(),selected:this.state.problemTypeValue,onSelect:this.handleProblemTypeValueChange.bind(this)}))}renderProblemTypeOptions(){return"warning"!==this.props.modalType?this.props.problemTypeOptions:this.props.problemTypeOptionsWarning}renderMessageField(){return this.props.isWithMessage?r.a.createElement("div",{className:"listing-information-form__field"},r.a.createElement("div",{className:"listing-information-form__field-header"},r.a.createElement("label",{className:"listing-information-form__field-label",htmlFor:"listing-information-message"},this.props.messageLabel)),r.a.createElement("textarea",{id:"listing-information-message",rows:"8",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this),className:"listing-information-form__field-textarea"})):null}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?r.a.createElement("button",{className:t},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),r.a.createElement("div",{className:"listing-information-form__group"},e)}renderField({name:e,value:t,label:s,placeholder:a,required:i,changeCallback:n,mask:o=""}){var l="listing-information-".concat(e);return r.a.createElement("div",{className:"listing-information-form__field"},r.a.createElement("div",{className:"listing-information-form__field-header"},r.a.createElement("label",{className:"listing-information-form__field-label",htmlFor:l},s),i?r.a.createElement("span",{className:"listing-information-form__field-required"},this.props.requiredLabel):""),r.a.createElement(Vo.a,{id:l,mask:o,className:"listing-information-form__field-input",placeholder:a,value:t,onChange:n.bind(this)}))}renderMessage({isError:e,isSuccess:t,displayedMessage:s}){var a=He("listing-information-form__message",{isError:e,isSuccess:t});return r.a.createElement("div",{className:a},s)}}hc.propTypes={dispatch:je.PropTypes.func.isRequired,isVisible:je.PropTypes.bool,isPurplebricks:je.PropTypes.bool.isRequired,isWithMessage:je.PropTypes.bool.isRequired,formTitle:je.PropTypes.string.isRequired,formTitleWarning:je.PropTypes.string.isRequired,formSubtitle:je.PropTypes.string.isRequired,requiredLabel:je.PropTypes.string.isRequired,nameLabel:je.PropTypes.string.isRequired,namePlaceholder:je.PropTypes.string.isRequired,nameValue:je.PropTypes.string,emailLabel:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,emailValue:je.PropTypes.string,phoneLabel:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,problemSelectLabel:je.PropTypes.string.isRequired,messageLabel:je.PropTypes.string.isRequired,messagePlaceholder:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,property:je.PropTypes.shape({listingId:je.PropTypes.string.isRequired}).isRequired,problemTypeOptions:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,problemTypeOptionsWarning:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,modalType:je.PropTypes.string.isRequired};var uc=hc=Object(m.b)(({listingTroubleReachingForm:e})=>{var{isVisible:t,modalType:s}=e;return{isVisible:t,modalType:s}})(hc),mc=g.createProviderWrappedComponent(e=>r.a.createElement(uc,e)),gc=/\{(\d+)\}(.+)/,_c=/\[([\d\*,]+)\](.+)/,bc=(e,t)=>{var s=((e,t)=>e.find(({value:e})=>"number"==typeof e?e===t:((e,t)=>{var[s,a]=e;return t>=s&&t<=a})(e,t)))(e.split("|").map((e,t)=>{var s=e.match(gc);if(s)return{value:parseInt(s[1],10),string:s[2]};var a,i=e.match(_c);return i?{value:(a=i[1],a.split(",").map(e=>"*"===e?1/0:parseInt(e,10))),string:i[2]}:{value:t+1,string:e}}),t);return s?s.string:""};class vc extends r.a.Component{render(){if(!this.props.initialListingsFetched||this.props.visibleInSearchListingCount>Ar)return null;var e=bc(this.props.listingsFound,this.props.visibleInSearchListingCount);return 0===this.props.visibleInSearchListingCount||null===this.props.visibleInSearchListingCount||void 0===this.props.visibleInSearchListingCount?r.a.createElement("div",{className:"search-map-listing-count"},bc(this.props.listingsFound,0)):r.a.createElement("div",{className:"search-map-listing-count"},r.a.createElement("span",{className:"search-results-listings-header__properties-found__number"},this.props.visibleInSearchListingCount),r.a.createElement("span",null," ".concat(e)))}}vc.propTypes={visibleInSearchListingCount:je.PropTypes.number,initialListingsFetched:je.PropTypes.bool.isRequired,listingsFound:je.PropTypes.string.isRequired};var yc=vc=Object(m.b)(({searchMap:e})=>{var{visibleInSearchListingCount:t,initialListingsFetched:s}=e;return{visibleInSearchListingCount:t,initialListingsFetched:s}})(vc),fc=g.createProviderWrappedComponent(e=>r.a.createElement(yc,e)),Tc=({searchBar:e,location:t,title:s})=>{var{searchTerms:a,searchTypes:i,searchSubTypes:n,searchRooms:o,searchBathrooms:l,searchPriceRange:c}=e,p=0===os(e),d=He("search-results-params",{["at-".concat(t)]:!0,empty:p});return r.a.createElement("div",{className:d},r.a.createElement(Cc,{title:s}),r.a.createElement(Sc,{terms:a}),r.a.createElement("ul",{className:"search-results-params__list"},r.a.createElement("li",{className:"search-results-params__criteria search-results-params__criteria__property"},i.options.map(t=>Pc(t,e)),n.selected.map(t=>wc(t,e))),r.a.createElement(Rc,{selectedCount:o.selected,selectedLabel:Ec(o)}),r.a.createElement(Nc,{selectedCount:l.selected,selectedLabel:Ec(l)}),r.a.createElement(kc,{selectedRange:c.selected,noMinimumLabel:c.noMinimumLabel,noMaximumLabel:c.noMaximumLabel})))},Pc=(e,t)=>{var{searchSubTypes:s}=t,a=ls(s.options,e.id);if(ls(s.selected,e.id)===a)return r.a.createElement("span",{className:"search-results-params__term",key:"searchTypesPopoverOption:".concat(e.id)},e.name)},wc=(e,t)=>{var{searchSubTypes:s}=t,a=ls(s.options,e.typeId),i=ls(s.selected,e.typeId);if(0===i||i!==a)return r.a.createElement("span",{className:"search-results-params__term",key:"searchSubTypesPopoverOption:".concat(e.typeId).concat(e.id)},e.name)},Ec=e=>e.options.find(t=>t.value===e.selected).label,Cc=({title:e})=>e&&0!==e.length?r.a.createElement("div",{className:"search-results-params_title"},e):null,Sc=({terms:e})=>0===e.length?null:r.a.createElement("div",{className:"search-results-params__terms"},e.map(({uniqueId:e,name:t})=>r.a.createElement("span",{key:"term:".concat(e),className:"search-results-params__term"},t))),Rc=({selectedCount:e,selectedLabel:t})=>"0"===e?null:r.a.createElement("li",{className:"search-results-params__criteria"},r.a.createElement(Ge.a,{className:"search-results-params__criteria-icon search-results-params__criteria-icon--bedrooms",src:"/build/img/svg/icn-characteristics-bedrooms.svg",cacheGetRequests:!0}),t),Nc=({selectedCount:e,selectedLabel:t})=>"0"===e?null:r.a.createElement("li",{className:"search-results-params__criteria"},r.a.createElement(Ge.a,{className:"search-results-params__criteria-icon search-results-params__criteria-icon--bathrooms",src:"/build/img/svg/icn-characteristics-bathrooms.svg",cacheGetRequests:!0}),t),kc=({selectedRange:e,noMinimumLabel:t,noMaximumLabel:s})=>{if(!e[0]&&!e[1])return null;var a=e[0]?h.a.encodeCurrencyValue(e[0].value,{noDecimal:!0}):t,i=e[1]?h.a.encodeCurrencyValue(e[1].value,{noDecimal:!0}):s,n="".concat(a," — ").concat(i);return r.a.createElement("li",{className:"search-results-params__criteria"},r.a.createElement("span",{className:"search-results-params__criteria-dollar-sign"},"$"),n)};Tc.propTypes={searchBar:je.PropTypes.object.isRequired,location:je.PropTypes.string.isRequired,title:je.PropTypes.string},Cc.propTypes={title:je.PropTypes.string},Sc.propTypes={terms:je.PropTypes.array.isRequired},Rc.propTypes={selectedCount:je.PropTypes.string,selectedLabel:je.PropTypes.string},Nc.propTypes={selectedCount:je.PropTypes.string,selectedLabel:je.PropTypes.string},kc.propTypes={selectedRange:je.PropTypes.arrayOf(je.PropTypes.object).isRequired,noMinimumLabel:je.PropTypes.string.isRequired,noMaximumLabel:je.PropTypes.string.isRequired};var Lc=Tc,qc=e=>{var t=window.DP.urls.proxyEmailAlert;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},Oc=()=>window.DP.auth.check;class xc extends r.a.Component{constructor(e){super(e),this.state={searchHash:e.searchHash,emailValue:e.emailValue,displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1,version:e.version,id:e.id}}componentDidMount(){this.openModalOnFirstLoad()}openModalOnFirstLoad(){c.a.setBucket("email_alert"),this.props.canOpenOnFirstLoad&&"sticky"===this.state.version&&!c.a.get("has_been_shown")&&(c.a.setBucket("service_conditions"),this.props.canDisplayTermsOfUsePopup&&!c.a.get("_have_been_agreed_upon_v2")||setTimeout(()=>{this.props.webinarOnly?this.webinarPopupVisible()||this.handleVisiblePopin():!this.infosessionsPopupVisible()&&this.infosessionsPopupSeenOnce()&&this.handleVisiblePopin()},7e3))}handleVisiblePopin(){this.setState({version:"modal",id:"popup"}),c.a.setBucket("email_alert"),c.a.set("has_been_shown",!0),Se.a.pushToDataLayer("gtm-event","SearchResults_EmailAlertWidget","View_PopUp","undefined"),Se.a.pushDynamicEvent("email-alert-auto-".concat(this.state.version,"-view-popup"),window.DP.context.pageType)}handleButtonClose(){this.setState({version:this.props.version})}handleButtonClick(){if("sticky"===this.state.id?Se.a.pushDynamicEvent("email-alert-popup-mobile","Listing_Mobile"):Se.a.pushDynamicEvent("email-alert-".concat(this.state.version,"-view-popup"),window.DP.context.pageType),"sticky"!==this.state.version&&"light"!==this.state.version){this.resetState(),this.setState({isSubmitting:!0});var{emailValue:e,searchHash:t}=this.state;qc({emailValue:e,searchHash:t}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1}),this.pushGtmSentEmailEvent(this.state.id)}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}else this.setState({version:"modal"})}handleClickLogIn(){var e="sticky"===this.state.version?"Listing_Mobile":window.DP.context.pageType;"popup"===this.state.id||"sticky"===this.state.id?Se.a.pushDynamicEvent("email-alert-".concat(this.state.id,"-popup-login"),e):Se.a.pushDynamicEvent("email-alert-".concat(this.state.version,"-popup-login"),e)}handleClickContactUs(){var e="sticky"===this.state.version?"Listing_Mobile":window.DP.context.pageType;"popup"===this.state.id||"sticky"===this.state.id?Se.a.pushDynamicEvent("email-alert-".concat(this.state.id,"-popup-contact"),e):Se.a.pushDynamicEvent("email-alert-".concat(this.state.version,"-popup-contact"),e)}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){var e=He("email-alerts-form",{light:"light"===this.state.version,sticky:"sticky"===this.state.version,modal:"modal"===this.state.version});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"email-alerts-form--inner"},r.a.createElement(Ge.a,{className:"email-alerts-form__alert-icon",src:"/build/img/svg/icn-email-alert.svg",cacheGetRequests:!0}),r.a.createElement("div",{className:"email-alerts-form__text"},r.a.createElement("div",{className:"email-alerts-form__header"},r.a.createElement("div",{className:"email-alerts-form__close",onClick:this.handleButtonClose.bind(this)},r.a.createElement(Ge.a,{className:"email-alerts-form__close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),r.a.createElement("h3",{className:"email-alerts-form__modal-title"},this.props.modalTitle),r.a.createElement("h3",{className:"email-alerts-form__title",dangerouslySetInnerHTML:{__html:this.props.title}}),r.a.createElement("h4",{className:"email-alerts-form__subtitle"},this.props.subtitle),this.renderSearchParams()),r.a.createElement("div",{className:"email-alerts-form__form"},this.state.displayedMessage?this.renderMessage():null,this.renderEmailAlertFormInputs()),r.a.createElement("p",{className:"email-alerts-form__legal-modal"},this.props.legal),this.renderMoreInfo(),r.a.createElement("p",{className:"email-alerts-form__legal"},this.props.legal)))}renderEmailAlertFormInputs(){var e=He("email-alerts-form__form__inputs",{isSuccess:this.state.hasSucceed}),t=Rr.a.v4();return r.a.createElement("div",{className:e},this.renderEmailLabel(t),this.renderEmailField(t),this.renderSubmitButton())}renderSubmitButton(){var e="button button--arrow email-alerts-form__button button--nofocus gtm-search-results-link-subscribe-alerts-";return e=e.concat(this.state.id),this.state.isSubmitting?r.a.createElement("button",{className:"button button--arrow email-alerts-form__button"},r.a.createElement(ze,null)):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.button)}renderEmailLabel(e){return r.a.createElement("label",{htmlFor:"email-alerts-input-form-".concat(e),className:"is-visually-hidden"},this.props.placeholder)}renderEmailField(e){var t=He("email-alerts-form__input",{invalid:"email"===this.state.errorField});return r.a.createElement("input",{id:"email-alerts-input-form-".concat(e),value:this.state.emailValue,type:"email",name:"email-alerts-input-form",className:t,disabled:Oc(),onChange:this.handleEmailValueChange.bind(this),placeholder:this.props.placeholder})}renderMessage(){var e=He("email-alerts-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}renderSearchParams(){return"modal"!==this.state.version?null:r.a.createElement(Lc,{searchBar:this.props.searchBar,location:"email-alert",title:this.props.paramsTitle})}renderMoreInfo(){return r.a.createElement("div",{className:"email-alerts-form__more-info"},this.renderMoreInfoNotLogged(),r.a.createElement("p",{onClick:this.handleClickContactUs.bind(this),className:"email-alerts-form__more-info__item email-alerts-form__more-info__item--contact-us",dangerouslySetInnerHTML:{__html:this.props.modalMoreInfoText}}))}renderMoreInfoNotLogged(){return Oc()?"":r.a.createElement("p",{onClick:this.handleClickLogIn.bind(this),className:"email-alerts-form__more-info__item email-alerts-form__more-info__item--login",dangerouslySetInnerHTML:{__html:this.props.modalLoginText}})}pushGtmSentEmailEvent(e){var t="",s="";switch(e){case"result_1":case"result_2":case"result_3":t="Subscribe_1",s="email-alert-subscribe-1";break;case"end":t="Subscribe_2",s="email-alert-subscribe-2";break;case"popup":t="Subscribe_Popup",s="email-alert-subscribe-3";break;case"sticky":t="Subscribe_Popup",s="email-alert-subscribe-4"}Qe()&&(t="Subscribe_Mobile"),Se.a.pushToDataLayer("gtm-event","SearchResults_EmailAlertWidget",t,"undefined"),Se.a.pushDynamicEvent(s,"EmailAlert")}infosessionsPopupVisible(){return document.querySelector(".info-sessions-popup")&&!document.querySelector(".info-sessions-popup--hidden")}webinarPopupVisible(){return document.querySelector(".webinar-popup")&&!document.querySelector(".webinar-popup--hidden")}infosessionsPopupSeenOnce(){var e="";if(sessionStorage){for(var t in sessionStorage)e+=t;return-1!==e.indexOf("sscache-infosessions_popup")}return null}}xc.propTypes={modalTitle:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired,subtitle:je.PropTypes.string.isRequired,placeholder:je.PropTypes.string.isRequired,note:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,searchHash:je.PropTypes.string.isRequired,searchBar:je.PropTypes.object.isRequired,modalMoreInfoText:je.PropTypes.string.isRequired,modalLoginText:je.PropTypes.string.isRequired,paramsTitle:je.PropTypes.string.isRequired,emailValue:je.PropTypes.string,version:je.PropTypes.string,id:je.PropTypes.string.isRequired,legal:je.PropTypes.string.isRequired,canDisplayTermsOfUsePopup:je.PropTypes.bool.isRequired,canOpenOnFirstLoad:je.PropTypes.bool.isRequired,isPurplebricks:je.PropTypes.bool.isRequired,webinarOnly:je.PropTypes.bool.isRequired};var Dc=xc;class Mc extends r.a.Component{constructor(e){super(e),this.state={isSubmitting:!1}}handleTogglePopover(){this.props.currentPopover!==this.props.origin&&this.props.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"}),d()(".favourite-notes-panel__notes").blur(),this.props.dispatch({type:"CURRENT_FAVOURITE_NOTES_PANEL_POPOVER",origin:this.props.origin}),this.props.dispatch({type:"TOGGLE_FAVOURITE_NOTES_PANEL_POPOVER"})}handleNotesClick(){this.setState({isSubmitting:!0}),this.handleNotesSave()}handleNotesSave(){Zn(this.props.listingId,this.refs.notes.value).then(()=>{this.props.dispatch(Qn(this.props.listingId,this.refs.notes.value)),this.setState({isSubmitting:!1}),this.props.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"})})}render(){return this.props.isVisible?r.a.createElement("div",{className:"favourite-notes-panel"},this.renderButton(),this.renderPopover()):null}renderButton(){var e=He("favourite-notes-panel__button",{active:this.props.showPopover&&this.props.currentPopover===this.props.origin});return r.a.createElement("div",{className:e,onClick:this.handleTogglePopover.bind(this)},r.a.createElement(Ge.a,{className:"favourite-notes-panel__button-icon",src:"/build/img/svg/icn-notes-v2.svg",cacheGetRequests:!0}),r.a.createElement("span",{className:"favourite-notes-panel__button-label gtm-listing-link-notes"},this.props.buttonLabel))}renderSaveButton(){return this.state.isSubmitting?r.a.createElement("button",{className:"favourite-notes-panel__save-button"},r.a.createElement("div",{className:"favourite-notes-panel__save-button-content"},r.a.createElement(ze,null))):r.a.createElement("button",{className:"button",onClick:this.handleNotesClick.bind(this)},this.props.saveButtonLabel)}renderPopover(){if(this.props.showPopover&&this.props.currentPopover===this.props.origin){var e=He("favourite-notes-panel__popover",{sticky:"header"===this.props.origin,sidebar:"Sidebar"===this.props.origin,content:"Content"===this.props.origin});return r.a.createElement(Kt,{onOuterClick:this.handleTogglePopover.bind(this),onOuterTouch:this.handleTogglePopover.bind(this)},r.a.createElement("div",{className:e},r.a.createElement("div",{className:"popover-arrow"}),r.a.createElement("textarea",{className:"favourite-notes-panel__notes",ref:"notes",placeholder:this.props.placeholderText,defaultValue:this.props.note}),this.renderSaveButton()))}}}Mc.propTypes={buttonLabel:je.PropTypes.string.isRequired,saveButtonLabel:je.PropTypes.string.isRequired,placeholderText:je.PropTypes.string.isRequired,showPopover:je.PropTypes.bool.isRequired,currentPopover:je.PropTypes.string,isVisible:je.PropTypes.bool.isRequired,listingId:je.PropTypes.string.isRequired,note:je.PropTypes.string.isRequired,origin:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired};var Ac=Mc=Object(m.b)(({favouriteNotesPanel:e,listingsFavourites:t},{listingId:s})=>{var{showPopover:a,currentPopover:i}=e,{favouriteListingIds:r,favouriteListingNotes:n}=t;return{showPopover:a,currentPopover:i,isVisible:r.includes(s),note:n[s]||""}})(Mc),Ic=g.createProviderWrappedComponent(e=>r.a.createElement(Ac,e));class Bc extends r.a.Component{constructor(e){super(e),this.state={showContent:!1,notes:""},this.handleNotesSave=Xe(this.handleNotesSave.bind(this),500)}componentDidUpdate(e,{showContent:t}){this.state.showContent&&this.state.showContent!==t&&this.refs.notes.focus()}handleOpenButtonClick(){this.setState({showContent:!this.state.showContent})}handleCloseButtonClick(){this.setState({showContent:!this.state.showContent})}handleNotesKeyUp(){var e=this.refs.notes.value;this.setState({notes:e}),this.handleNotesSave()}handleNotesSave(){Zn(this.props.listingId,this.state.notes).then(()=>this.props.dispatch(Qn(this.props.listingId,this.state.notes)))}render(){return this.props.isVisible?r.a.createElement("div",{className:"favourite-notes-modal"},this.renderButton(),this.renderContent()):null}renderButton(){return r.a.createElement("div",{className:"favourite-notes-modal__button",onClick:this.handleOpenButtonClick.bind(this)},r.a.createElement(Ge.a,{className:"favourite-notes-modal__button-icon",src:"/build/img/svg/icn-notes-v2.svg",cacheGetRequests:!0}),r.a.createElement("span",{className:"favourite-notes-modal__button-label"},this.props.buttonLabel))}renderContent(){return this.state.showContent?r.a.createElement("div",{className:"favourite-notes-modal__content"},r.a.createElement("div",{className:"favourite-notes-modal__title"},r.a.createElement("div",{className:"favourite-notes-modal__close-button",onClick:this.handleCloseButtonClick.bind(this)},r.a.createElement(Ge.a,{className:"favourite-notes-modal__close-button-icon",src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0})),this.props.titleText),r.a.createElement("textarea",{ref:"notes",className:"favourite-notes-modal__notes",defaultValue:this.props.note,placeholder:this.props.placeholderText,onKeyUp:this.handleNotesKeyUp.bind(this)})):null}}Bc.propTypes={buttonLabel:je.PropTypes.string.isRequired,titleText:je.PropTypes.string.isRequired,placeholderText:je.PropTypes.string.isRequired,listingId:je.PropTypes.string.isRequired,isVisible:je.PropTypes.bool.isRequired,note:je.PropTypes.string.isRequired,dispatch:je.PropTypes.func.isRequired};var Fc=Bc=Object(m.b)(({listingsFavourites:e},{listingId:t})=>{var{favouriteListingIds:s,favouriteListingNotes:a}=e;return{isVisible:s.includes(t),note:a[t]||""}})(Bc),jc=g.createProviderWrappedComponent(e=>r.a.createElement(Fc,e));class Vc extends r.a.Component{render(){var e=ns(this.props.searchResultsParams);return r.a.createElement("div",null,e)}}Vc.propTypes={searchResultsParams:je.PropTypes.object.isRequired};var Uc=Vc=Object(m.b)(({searchAdditionalCriteria:e,searchBar:t,searchBathrooms:s,searchFieldInput:a,searchFieldResults:i,searchFilters:r,searchFlags:n,searchLandArea:o,searchOnlineSince:l,searchOptions:c,searchPriceRange:p,searchRooms:d,searchSortOrder:h,searchSubTypes:u,searchTerms:m,searchTypes:g,searchLotSize:_,searchLivingArea:b})=>({searchResultsParams:{searchAdditionalCriteria:e,searchBar:t,searchBathrooms:s,searchFieldInput:a,searchFieldResults:i,searchFilters:r,searchFlags:n,searchLandArea:o,searchOnlineSince:l,searchOptions:c,searchPriceRange:p,searchRooms:d,searchSortOrder:h,searchSubTypes:u,searchTerms:m,searchTypes:g,searchLotSize:_,searchLivingArea:b}}))(Vc),$c=g.createProviderWrappedComponent(e=>r.a.createElement(Uc,e));class Gc extends r.a.Component{constructor(e){super(e),this.state={distance:this.props.distance?this.props.distance:null}}componentDidMount(){!this.props.distance&&this.shouldUseNavigatorGeolocation()&&this.props.position&&this.fetchListingDistance()}render(){var e=!this.state.distance,t=He("listing-distance-tag",{hidden:e,listing:"listing"===window.DP.context.route});return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"listing-distance-tag__tag"},r.a.createElement(Ge.a,{className:"listing-distance-tag__icon",src:"/build/img/svg/icn-precision.svg",cacheGetRequests:!0}),this.state.distance))}shouldUseNavigatorGeolocation(){return window.innerWidth<=window.DP.breakpoints.medium}fetchListingDistance(){var e,t;(e=this.props.listingId,t=this.props.position,(new Cr).fetch(e,{position:t,fields:{listings:"distance"}}).then(e=>Promise.resolve(e.distance)).catch(()=>Promise.reject())).then(e=>{this.setState({distance:e})}).catch(()=>{this.setState({distance:null})})}}Gc.propTypes={listingId:je.PropTypes.string.isRequired,distance:je.PropTypes.string,position:je.PropTypes.string};var Hc=Gc,zc=e=>{var t=(e=>{var t=(({builderListingsPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e);return Je({pageNumber:t})})(e),s=d.a.param(t);window.location="".concat(window.location.pathname,"?").concat(s)};class Wc extends r.a.Component{handlePageChange(e){this.props.dispatch({type:"SET_BUILDER_LISTINGS_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e.toString()}),this.props.dispatch((zc(window.DP.store.getState()),{type:"SUBMIT_BUILDER_LISTINGS"}))}render(){return r.a.createElement(si,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,onPageChange:this.handlePageChange.bind(this)})}}Wc.propTypes={dispatch:je.PropTypes.func.isRequired,previousLinkActive:je.PropTypes.bool.isRequired,nextLinkActive:je.PropTypes.bool.isRequired,items:je.PropTypes.array.isRequired,currentPageNumber:je.PropTypes.string},Wc=Object(m.b)()(Wc);var Kc=g.createProviderWrappedComponent(e=>r.a.createElement(Wc,e)),Yc=(e,t,s)=>{var a={};return t.length&&(a=Object.assign({},a,{city:t.join("-")})),s.length&&(a=Object.assign({},a,{regions:s.join("-")})),Object.assign({},e,a)},Xc=({province:e,lang:t,cityIds:s,regionIds:a})=>new Promise((i,r)=>{var n="".concat(window.DP.urls.bizApi,"/getFeaturedCompanies"),o=Yc({province:e,lang:t,limit:1},s,a);d.a.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),d.a.ajax({url:n,data:o}).done(e=>{var t=(e=>{var t=d()(e).find("featured").eq(0);return 0===t.length?null:{name:t.find("name").text(),category:t.find("category_name").text(),logo:t.find("logo_url").text(),bizUrl:t.find("link_to_dp_biz").text(),websiteUrl:t.find("url").text(),phone:t.find("phone").text()}})(e);t||r(),i(t)}).fail(r)}),Zc=({province:e,lang:t,cityIds:s,regionIds:a})=>new Promise((i,r)=>{var n="".concat(window.DP.urls.bizApi,"/getCategories"),o=Yc({province:e,lang:t,limit:10},s,a);d.a.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),d.a.ajax({url:n,data:o}).done(e=>{var t=(e=>d()(e).find("category").map((e,t)=>{var s=d()(t);return{name:s.find("category_name").text(),url:s.find("link_to_dp_biz").text()}}).toArray())(e);0===t.length&&r(),i(t)}).fail(r)});function Jc(){return(Jc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class Qc extends r.a.Component{constructor(e){super(e),this.state={company:null,categories:[]}}componentDidMount(){this.isListingPageType()?this.fetchCategories():this.fetchCompany()}render(){var e=this.renderContent();if(!e)return null;var t=He("featured-company",{bordered:this.props.bordered});return r.a.createElement("div",{className:t},e,r.a.createElement(ap,Jc({},this.props.form,{regionIds:this.props.regionIds})))}renderContent(){return this.state.company?r.a.createElement(ep,Jc({},this.props.company,{company:this.state.company,regionIds:this.props.regionIds})):this.state.categories.length?r.a.createElement(tp,Jc({},this.props.categories,{categories:this.state.categories,regionIds:this.props.regionIds})):null}fetchCompany(){var{province:e,lang:t,cityIds:s,regionIds:a}=this.props;Xc({province:e,lang:t,cityIds:s,regionIds:a}).then(e=>this.setState({company:e})).catch(()=>this.fetchCategories())}fetchCategories(){var{province:e,lang:t,cityIds:s,regionIds:a}=this.props;Zc({province:e,lang:t,cityIds:s,regionIds:a}).then(e=>this.setState({categories:e})).catch(()=>{})}isListingPageType(){return this.props.pageType&&"listing"===this.props.pageType}}var ep=({company:e,title:t,website:s})=>r.a.createElement("div",{className:"featured-company__container"},r.a.createElement("div",{className:"featured-company__title"},t),r.a.createElement("div",{className:"featured-company__content--company"},r.a.createElement("div",{className:"featured-company__company-name"},e.name),r.a.createElement("div",{className:"featured-company__company-category"},e.category),r.a.createElement("div",{className:"featured-company__company-columns"},r.a.createElement("div",{className:"featured-company__company-photo"},r.a.createElement("a",{target:"_blank",className:"featured-company__company-biz",href:e.bizUrl},r.a.createElement("img",{className:"featured-company__company-image",src:e.logo}))),r.a.createElement("div",{className:"featured-company__company-contact"},r.a.createElement("div",{className:"featured-company__company-phone-number"},e.phone),r.a.createElement("a",{target:"_blank",className:"featured-company__company-website",href:e.websiteUrl},s))))),tp=({categories:e,title:t})=>r.a.createElement("div",{className:"featured-company__container"},r.a.createElement("div",{className:"featured-company__logo-title"},r.a.createElement("img",{className:"featured-company__logo-title-image",src:"/build/img/png/img-dupropriobiz.png",alt:""})),r.a.createElement("div",{className:"featured-company__subtitle"},t),r.a.createElement("div",{className:"featured-company__content--categories"},r.a.createElement("ul",{className:"featured-company__categories"},e.map((e,t)=>r.a.createElement(sp,{key:"category:".concat(t),category:e}))))),sp=({category:e})=>{var{name:t,url:s}=e;return r.a.createElement("li",{className:"featured-company__category"},r.a.createElement("a",{className:"featured-company__category-link",href:s,target:"_blank"},t))},ap=({regionIds:e,placeholder:t,button:s,action:a})=>r.a.createElement("form",{target:"_blank",method:"post",action:a,className:"featured-company__form"},e.map(e=>r.a.createElement("input",{key:"featuredCompany:form:region:".concat(e),type:"hidden",name:"region[]",defaultValue:e})),r.a.createElement("label",null,r.a.createElement("span",{className:"is-visually-hidden"},t),r.a.createElement("input",{className:"featured-company__form-input",name:"what",placeholder:t})),r.a.createElement("button",{className:"featured-company__form-button"},s));ep.propTypes={company:je.PropTypes.shape({name:je.PropTypes.string.isRequired,category:je.PropTypes.string.isRequired,logo:je.PropTypes.string.isRequired,phone:je.PropTypes.string.isRequired,bizUrl:je.PropTypes.string.isRequired,websiteUrl:je.PropTypes.string.isRequired}).isRequired,title:je.PropTypes.string.isRequired,website:je.PropTypes.string.isRequired},tp.propTypes={categories:je.PropTypes.array.isRequired,title:je.PropTypes.string.isRequired},sp.propTypes={category:je.PropTypes.shape({name:je.PropTypes.string.isRequired,url:je.PropTypes.string.isRequired}).isRequired},ap.propTypes={regionIds:je.PropTypes.arrayOf(je.PropTypes.number).isRequired,placeholder:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,action:je.PropTypes.string.isRequired},Qc.propTypes={cityIds:je.PropTypes.arrayOf(je.PropTypes.number).isRequired,regionIds:je.PropTypes.arrayOf(je.PropTypes.number).isRequired,province:je.PropTypes.number.isRequired,lang:je.PropTypes.string.isRequired,company:je.PropTypes.object.isRequired,categories:je.PropTypes.object.isRequired,form:je.PropTypes.object.isRequired,bordered:je.PropTypes.bool.isRequired,pageType:je.PropTypes.string};var ip=Qc,rp=g.createProviderWrappedComponent(e=>r.a.createElement(ip,e)),np=e=>{var t=window.DP.urls.proxyInfosession;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class op extends r.a.Component{constructor(e){super(e),c.a.setBucket("infosession"),this.state={infosessionIdValue:this.props.infosessionId,firstNameValue:c.a.get("first_name")?c.a.get("first_name"):"",lastNameValue:c.a.get("last_name")?c.a.get("last_name"):"",emailValue:c.a.get("email")?c.a.get("email"):"",phoneValue:c.a.get("phone")?c.a.get("phone"):"",cityValue:c.a.get("city")?c.a.get("city"):"",doYouSellValue:c.a.get("doyousell")?c.a.get("doyousell"):this.props.doYouSellOptions[0].value,postalCodeValue:c.a.get("city")?c.a.get("postalcode"):"",emailConsentChecked:!1,displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}componentDidMount(){this.scrollToItem()}scrollToItem(){window.scrollTo(0,d()(this.refs.infosessionForm).offset().top-185)}handleFirstNameValueChange(e){c.a.setBucket("infosession"),c.a.set("first_name",e.target.value),this.setState({firstNameValue:e.target.value})}handleLastNameValueChange(e){c.a.setBucket("infosession"),c.a.set("last_name",e.target.value),this.setState({lastNameValue:e.target.value})}handleEmailValueChange(e){c.a.setBucket("infosession"),c.a.set("email",e.target.value),this.setState({emailValue:e.target.value})}handlePhoneValueChange(e){c.a.setBucket("infosession"),c.a.set("phone",e.target.value),this.setState({phoneValue:e.target.value})}handleCityValueChange(e){c.a.setBucket("infosession"),c.a.set("city",e.target.value),this.setState({cityValue:e.target.value})}handleDoYouSellValueChange(e){c.a.setBucket("infosession"),c.a.set("doyousell",e.value),this.setState({doYouSellValue:e.value}),window.Dropdown("hide")}handlePostalCodeValueChange(e){c.a.setBucket("infosession"),c.a.set("postalcode",e.target.value),this.setState({postalCodeValue:e.target.value})}handleEmailConsentClick(e){this.setState({emailConsentChecked:!e})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var{infosessionIdValue:e,firstNameValue:t,lastNameValue:s,emailValue:a,phoneValue:i,cityValue:r,doYouSellValue:n,postalCodeValue:o,emailConsentChecked:l}=this.state;np({infosessionIdValue:e,firstNameValue:t,lastNameValue:s,emailValue:a,phoneValue:i,doYouSellValue:n,cityValue:r,postalCodeValue:o,emailConsentChecked:l}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1}),this.resetFormInformation(),this.scrollToItem(),this.handleSuccessfullFormGtmPush()}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0}),this.scrollToItem()})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}resetFormInformation(){c.a.setBucket("infosession"),c.a.flush(),this.setState({firstNameValue:"",lastNameValue:"",emailValue:"",phoneValue:"",cityValue:"",doYouSellValue:this.props.doYouSellOptions[0].value,postalCodeValue:"",emailConsentChecked:!1})}render(){var e=He("infosession-form",{success:this.state.hasSucceed});return r.a.createElement("div",{className:e,ref:"infosessionForm"},this.state.displayedMessage?this.renderMessage():null,this.renderFirstNameField(),this.renderLastNameField(),this.renderEmailField(),this.renderPhoneField(),this.renderCityField(),this.renderDoYouSellField(),this.renderPostalCodeField(),r.a.createElement("div",{className:"infosession-form__required"},this.props.fieldsRequiredText),this.renderSubmitButton(),this.renderEmailConsent())}renderMessage(){var e=He("infosession-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}handleSuccessfullFormGtmPush(){var e=this.props.isWebinar?"Webinar":"Infosession",t=this.props.isWebinar?"infosession-page-webinar":"infosession-page-infosession",s=this.props.isWebinar?"WebinarPage":"InfoSessionPage";Se.a.pushToDataLayer("gtm-event","InfosessionPage","Subscribe",e),Se.a.pushDynamicEvent(t,s)}renderFirstNameField(){var e=He("infosession-form__field",{invalid:"first_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"first-name-infosession-form",placeholder:this.props.firstNamePlaceholder,value:this.state.firstNameValue,onChange:this.handleFirstNameValueChange.bind(this)})}renderLastNameField(){var e=He("infosession-form__field",{invalid:"last_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"last-name-infosession-form",placeholder:this.props.lastNamePlaceholder,value:this.state.lastNameValue,onChange:this.handleLastNameValueChange.bind(this)})}renderEmailField(){var e=He("infosession-form__field",{invalid:"email"===this.state.errorField});return r.a.createElement("input",{className:e,type:"email",name:"email-infosession-form",placeholder:this.props.emailPlaceholder,value:this.state.emailValue,onChange:this.handleEmailValueChange.bind(this)})}renderPhoneField(){var e=He("infosession-form__field",{invalid:"phone"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"phone-infosession-form",placeholder:this.props.phonePlaceholder,value:this.state.phoneValue,onChange:this.handlePhoneValueChange.bind(this)})}renderCityField(){var e=He("infosession-form__field",{invalid:"city"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"city-infosession-form",placeholder:this.props.cityPlaceholder,value:this.state.cityValue,onChange:this.handleCityValueChange.bind(this)})}renderDoYouSellField(){var e=He("infosession-form__field_do_you_sell",{invalid:"do_you_sell"===this.state.errorField});return r.a.createElement("div",{className:e},r.a.createElement(ar,{dropdownId:e,options:this.props.doYouSellOptions,selected:this.state.doYouSellValue,onSelect:this.handleDoYouSellValueChange.bind(this)}))}renderPostalCodeField(){var e=He("infosession-form__field",{invalid:"postal_code"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"postal-code-infosession-form",placeholder:this.props.postalCodePlaceholder,value:this.state.postalCodeValue,onChange:this.handlePostalCodeValueChange.bind(this)})}renderFieldsRequiredText(){return r.a.createElement("div",{className:"infosession-form__required"},this.props.fieldsRequiredText)}renderSubmitButton(){return this.state.isSubmitting?r.a.createElement("button",{className:"infosession-form__button"},r.a.createElement("div",{className:"infosession-form__button-content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"infosession-form__button"},this.props.buttonLabel)}renderEmailConsent(){var e=this.state.emailConsentChecked;return r.a.createElement("div",{onClick:this.handleEmailConsentClick.bind(this,e),className:"infosession-form__email-consent"},r.a.createElement(jt,{checked:e}),r.a.createElement("p",{className:"infosession-form__email-consent-text"},this.props.emailConsentLabel))}}op.propTypes={infosessionId:je.PropTypes.string.isRequired,firstNamePlaceholder:je.PropTypes.string.isRequired,lastNamePlaceholder:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,cityPlaceholder:je.PropTypes.string.isRequired,doYouSellOptions:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired,doYouSellLabel:je.PropTypes.string,postalCodePlaceholder:je.PropTypes.string.isRequired,fieldsRequiredText:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,emailConsentLabel:je.PropTypes.string.isRequired,isWebinar:je.PropTypes.bool.isRequired};var lp=op;var cp=class{fetch(e={}){return this.lastRequest&&this.lastRequest.abort(),new Promise((t,s)=>{var a,i;this.lastRequest=(a=e,i=Ke()(window.DP.urls.proxyInfosession),d.a.ajax({url:i,data:a})).done(t).fail(s)})}},pp=({latitude:e,longitude:t})=>{var s=new cp,a="".concat(e,",").concat(t);return s.fetch({position:a}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject())};class dp extends r.a.Component{constructor(e){super(e),this.handleToggle=this.handleToggle.bind(this),this.state={infosessionFormProps:this.props.infosessionFormProps,infosessionTextProps:this.props.infosessionTextProps,infosessions:[],active:this.props.active,showSort:"infosession"===this.props.type||"sk"===window.DP.province,sortDate:!0}}componentDidMount(){"infosession"===this.props.type||"sk"===window.DP.province?d()(".".concat("infosession__content-list-tab","-").concat("infosession")).addClass("infosessions-tab-content--active"):d()(".".concat("infosession__content-list-tab","-").concat("webinar")).addClass("infosessions-tab-content--active"),this.selectionType()}selectionType(){"undefined"===this.props.type?this.fetchInfosessionsDate("webinar"):(this.fetchInfosessionsDate(this.props.type),"infosession"===this.props.type&&this.setState({showSort:!0}))}handleBtnClick(e){"date"===e?(this.setState({sortDate:!0}),this.fetchInfosessionsDate("infosession"),d()(".".concat("geolocator-warning")).removeClass("geolocator-warning--active")):(this.setState({sortDate:!1}),this.fetchInfosessionsPosition())}handleItemClick(e){d()(".".concat("infosession__content-list-tab")).removeClass("infosessions-tab-content--active"),d()(".".concat("infosession__content-list-tab","-").concat(e)).addClass("infosessions-tab-content--active"),d()(".".concat("geolocator-warning")).removeClass("geolocator-warning--active"),d()(".".concat("infosession__content-list__noresult")).hide(),"infosession"===e?(this.setState({showSort:!0}),this.state.sortDate?this.fetchInfosessionsDate("infosession"):this.fetchInfosessionsPosition("infosession"),Se.a.pushDynamicEvent("infosession-click-choose-session-infosession","SellerLanding_Mobile")):(this.setState({showSort:!1}),this.fetchInfosessionsDate("webinar"),Se.a.pushDynamicEvent("infosession-click-choose-session-webinar","SellerLanding_Mobile"))}handleToggle(e){e===this.state.active&&(e=null),this.setState({active:e})}render(){var e=He("infosession-list"),t=He("infosession__content-list-items-show",{webinar:!this.state.showSort,infosession:this.state.showSort});return"sk"===window.DP.province&&(t=He("infosession__content-list-items-show",{webinar:this.state.showSort,infosession:!this.state.showSort})),r.a.createElement("div",{className:"infosession__content-list"},r.a.createElement("div",{className:"infosession__content-list__switch"},this.renderWebinarTab(),this.renderInfosessionTab()),this.renderSort(),r.a.createElement("div",{className:"geolocator-warning"},this.props.infosessionWebinarTextProps.geolocalisation),r.a.createElement("ul",{className:"infosession__content-list-items ".concat(e," ").concat(t)},this.state.infosessions.map(e=>this.renderInfosession(e)),this.renderInfosessionNull(),this.renderWebinarCallToAction()))}renderInfosessionTab(){var e="infosession__content-list-tab infosession__content-list-tab-infosession";return"sk"===window.DP.province&&(e+=" infosession__content-list-tab-sk"),r.a.createElement("span",{className:e,onClick:this.handleItemClick.bind(this,"infosession")},this.props.infosessionWebinarTextProps.infosession)}renderWebinarTab(){if("sk"===window.DP.province)return null;var e="qc"===window.DP.province?this.props.infosessionWebinarTextProps.online:this.props.infosessionWebinarTextProps.webinar;return r.a.createElement("span",{className:"infosession__content-list-tab infosession__content-list-tab-webinar",onClick:this.handleItemClick.bind(this,"webinar")},e)}renderInfosessionNull(){return"fr"!==window.DP.lang&&"qc"===window.DP.province||null!==this.state.infosessions?null:r.a.createElement("div",{className:"infosession__content-list__noresult"},this.props.infosessionWebinarTextProps.noresult)}renderWebinarCallToAction(){return"qc"!==window.DP.province?null:r.a.createElement("li",{className:"infosession__content-list-item infosession__content-list-item--webinar"},r.a.createElement("a",{className:"infosession__content-list-item-link",href:this.props.infosessionWebinarTextProps.link_webinar},r.a.createElement("div",{className:"infosession__content-list-item-session"},r.a.createElement("div",{className:"infosession__content-list-item-date"},r.a.createElement("span",{className:"infosession__content-list-item-date-month"},this.props.infosessionWebinarTextProps.availability),r.a.createElement("span",{className:"infosession__content-list-item-date-day"},this.props.infosessionWebinarTextProps.date)),r.a.createElement("div",{className:"infosession__content-list-item-information"},r.a.createElement("div",{className:"infosession__content-list-item-information-details"},this.props.infosessionWebinarTextProps.download)))))}renderSort(){var e=He("sort__options-button",{active:this.state.sortDate});return this.state.showSort?r.a.createElement("div",{className:"infosession__content-list__sort"},r.a.createElement("span",null,this.props.infosessionWebinarTextProps.sort),r.a.createElement("span",{className:"infosession__content-list__sort-button ".concat(e)},r.a.createElement("span",{onClick:this.handleBtnClick.bind(this,"date")},this.props.infosessionWebinarTextProps.date_btn),r.a.createElement("span",{onClick:this.handleBtnClick.bind(this,"distance")},this.props.infosessionWebinarTextProps.distance))):null}renderInfosession(e){return r.a.createElement(hp,{key:"infosession:item:".concat(e.id),infosession:e,infosessionFormProps:this.props.infosessionFormProps,infosessionTextProps:this.props.infosessionTextProps,active:this.state.active,handleToggle:this.handleToggle})}fetchInfosessionsDate(e){("qc"===window.DP.province||"sk"===window.DP.province)&&(e="infosession"),(e=>(new cp).fetch({type:e}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()))(e).then(e=>{this.setState({infosessions:e})}).catch(()=>{this.setState({infosessions:null})})}fetchInfosessionsPosition(){Ze().then(({coords:e})=>pp(e)).catch(()=>d()(".".concat("geolocator-warning")).addClass("geolocator-warning--active")).then(e=>{this.setState({infosessions:e})}).catch(()=>{this.setState({infosessions:null})})}}class hp extends r.a.Component{handleClick(){this.props.handleToggle(this.props.infosession.id)}handleCallUsClick(){var e=this.props.infosession.isWebinar?"webinar":"infosession";Se.a.pushDynamicEvent("infosession-call-us-click-".concat(e),"SellerLanding_Mobile")}render(){if(0===this.props.infosession)return null;var e=He("infosession__content-list-item",{open:this.props.active===this.renderInfosessionId(),webinar:this.props.infosession.isWebinar,infosession:!this.props.infosession.isWebinar,english:"fr"!==window.DP.lang});return r.a.createElement("li",{className:e,"data-id":this.renderInfosessionId(),"data-geolocation-distance":this.renderPosition()},r.a.createElement("div",{className:"infosession__content-list-item-session",onClick:this.handleClick.bind(this)},r.a.createElement("div",{className:"infosession__content-list-item-date"},r.a.createElement("span",{className:"infosession__content-list-item-date-day"},oo.formatDate(this.props.infosession.date,"day_number")),r.a.createElement("span",{className:"infosession__content-list-item-date-month"},oo.formatDate(this.props.infosession.date,"month"))," ",oo.formatDate(this.props.infosession.date,"year")),r.a.createElement("div",{className:"infosession__content-list-item-information"},r.a.createElement("div",{className:"infosession__content-list-item-information-location"},this.renderCity()),r.a.createElement("div",{className:"infosession__content-list-item-information-details"},oo.formatDate(this.props.infosession.date,"hour"),", ",this.renderDescription(),r.a.createElement("br",null),this.renderLanguageText())),r.a.createElement("div",{className:"infosession__content-list-item-arrow"},r.a.createElement(Ge.a,{className:"infosession__content-list-item-arrow-icon",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))),this.renderForm())}renderForm(){return this.props.infosession.id!==this.props.active?null:r.a.createElement("div",{className:"infosession__content-list-item-form"},r.a.createElement("div",{className:"infosession__content-list-item-form-title"},this.renderCoordinates()),r.a.createElement("div",{className:"infosession__content-list-item-form-container"},r.a.createElement(lp,{infosessionId:this.props.infosession.id,firstNamePlaceholder:this.props.infosessionFormProps.firstNamePlaceholder,lastNamePlaceholder:this.props.infosessionFormProps.lastNamePlaceholder,emailPlaceholder:this.props.infosessionFormProps.emailPlaceholder,phonePlaceholder:this.props.infosessionFormProps.phonePlaceholder,cityPlaceholder:this.props.infosessionFormProps.cityPlaceholder,doYouSellOptions:this.props.infosessionFormProps.doYouSellOptions,postalCodePlaceholder:this.props.infosessionFormProps.postalCodePlaceholder,fieldsRequiredText:this.props.infosessionFormProps.fieldsRequiredText,buttonLabel:this.props.infosessionFormProps.buttonLabel,emailConsentLabel:this.props.infosessionFormProps.emailConsentLabel,isWebinar:this.props.infosession.isWebinar})),r.a.createElement("div",{className:"infosession__content-list-item-form__phone"},r.a.createElement("div",{className:"infosession__content-list-item-form__phone-text"},this.renderCallUsTitle()),r.a.createElement("a",{href:this.renderPhoneNumberLink(),className:"infosession__content-list-item-form__phone-button",onClick:this.handleCallUsClick.bind(this)},this.renderCallUsLabel())))}renderCity(){var e=this.props.infosession.isWebinar?this.props.infosessionTextProps.infosessionWebinar:this.props.infosession.city;return r.a.createElement("span",{className:""},e)}renderLanguageText(){if(!this.props.infosession.language||"qc"!==window.DP.province)return null;var e="fr"===this.props.infosession.language?this.props.infosessionTextProps.infosessionLanguageFr:this.props.infosessionTextProps.infosessionLanguageEn;return r.a.createElement("span",{className:""},e)}renderPosition(){return this.props.infosession.latitude&&this.props.infosession.longitude?"".concat(this.props.infosession.latitude,",").concat(this.props.infosession.longitude):null}renderDescription(){return this.props.infosession.description?r.a.createElement("span",{className:""},this.props.infosession.description):null}renderCoordinates(){return this.props.infosessionTextProps.coordinates?r.a.createElement("span",{className:""},this.props.infosessionTextProps.coordinates):null}renderCallUsTitle(){return this.props.infosessionTextProps.formCallUsTitle?r.a.createElement("span",{className:""},this.props.infosessionTextProps.formCallUsTitle):null}renderCallUsLabel(){return this.props.infosessionTextProps.formCallUsLabel?r.a.createElement("span",{className:""},this.props.infosessionTextProps.formCallUsLabel):null}renderPhoneNumberLink(){return this.props.infosessionTextProps.phoneNumberLink?this.props.infosessionTextProps.phoneNumberLink:null}renderInfosessionId(){return this.props.infosession.id?this.props.infosession.id:null}}hp.propTypes={infosessionFormProps:je.PropTypes.object.isRequired,infosessionTextProps:je.PropTypes.object.isRequired,infosession:je.PropTypes.shape({city:je.PropTypes.string,date:je.PropTypes.string.isRequired,description:je.PropTypes.string.isRequired,id:je.PropTypes.string.isRequired,isWebinar:je.PropTypes.bool.isRequired,language:je.PropTypes.string.isRequired,latitude:je.PropTypes.number.isRequired,longitude:je.PropTypes.number.isRequired,province:je.PropTypes.string.isRequired}).isRequired,handleToggle:je.PropTypes.func.isRequired,active:je.PropTypes.string},dp.propTypes={infosessionFormProps:je.PropTypes.object.isRequired,infosessionTextProps:je.PropTypes.object.isRequired,infosessionWebinarTextProps:je.PropTypes.object.isRequired,infosessions:je.PropTypes.array,active:je.PropTypes.string,type:je.PropTypes.string};var up=dp,mp=(s(309),{speed:15,direction:"top",cycles:1/0,delayBetweenCycles:0,space:0,duplicated:!0,handleHover:!0});class gp extends r.a.Component{constructor(e){super(e),this.state={infosessions:[]}}fetchInfosessions(){var{regions:e,cities:t}=this.props;(({regions:e,cities:t})=>(new cp).fetch({regions:e,cities:t}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()))({regions:e,cities:t}).then(e=>{this.removeDuplicateInfosession(e),this.renderWebinarOnDemand()}).catch(()=>{this.setState({infosessions:[]}),this.renderWebinarOnDemand()})}componentDidMount(){this.fetchInfosessions()}componentDidUpdate(){this.state.infosessions.length>0&&(this.element=d()(this.refs.infosessionTickerList),this.element.simplemarquee(mp))}getBaseUrl(){return this.props.webinarOnDemandUrl}getItemUrl(e){return e.isWebinar?this.props.webinarOnDemandUrl:this.props.baseUrl}removeDuplicateInfosession(e){var t=e,s=[],a="fr"===window.DP.lang?"fr":"en",i=!1,r=0;for(r in t){for(var n=s.length-1;n>=0;n--)t[r].city===s[n].city&&t[r].dayMonth===s[n].dayMonth&&(t[r].language===a&&(s.splice(n,1),s.push(t[r])),i=!0);i||s.push(t[r]),i=!1}this.setState({infosessions:s})}handleLinkClick(){Se.a.pushDynamicEvent("listing-infosession-widget-sessions-list",window.DP.context.pageType)}handleRegisterClick(){Se.a.pushDynamicEvent("listing-infosession-widget-register-button",window.DP.context.pageType)}render(){return 0===this.state.infosessions.length?this.renderPlaceholder():r.a.createElement("div",{className:"info-session-ticker"},r.a.createElement("header",{className:"info-session-ticker__title"},r.a.createElement("a",{className:"info-session-ticker__title-link",href:"".concat(this.getBaseUrl(),"?").concat(this.props.itmParametersUrls.box)},this.props.title)),r.a.createElement("ul",{className:"info-session-ticker__list has-enough-space",ref:"infosessionTickerList"},this.state.infosessions.map(e=>this.renderInfosession(e))),r.a.createElement("div",{className:"info-session-ticker__action"},r.a.createElement("a",{href:"".concat(this.getBaseUrl(),"?").concat(this.props.itmParametersUrls.button),onClick:this.handleRegisterClick.bind(this),className:"info-session-ticker__button gtm-infosession-ticker-link-subscribe"},this.props.button)))}renderWebinarOnDemand(){if("qc"===window.DP.province){var e={city:null,dayMonth:this.props.OnDemand,description:"".concat(this.props.isWebinar," ").concat(this.props.OnDemand),id:"",isWebinar:!0,language:window.DP.lang,latitude:0,longitude:0,province:"QC"},t=this.state.infosessions.concat(e);return this.setState({infosessions:t})}}renderInfosession(e){if(!e.isWebinar&&"qc"!==window.DP.province)return!1;var t="";return"qc"===window.DP.province&&(t="info-session-ticker__list-item-",e.isWebinar?t+=e.dayMonth===this.props.OnDemand?"ondemand":"online":t+="salle"),r.a.createElement("li",{key:"InfoSessionTicker:infosession:".concat(e.id),className:"info-session-ticker__list-item ".concat(t)},r.a.createElement("a",{href:"".concat(this.getItemUrl(e),"?id=").concat(e.id,"&").concat(this.props.itmParametersUrls.list),onClick:this.handleLinkClick.bind(this),className:"info-session-ticker__list-link gtm-infosession-ticker-link-session"},this.renderCity(e),e.dayMonth))}renderCity(e){var t=e.isWebinar?this.props.isWebinar:e.city;return r.a.createElement("span",{className:"info-session-ticker__location gtm-infosession-ticker-link-session"},t)}renderPlaceholder(){return r.a.createElement("div",{className:"info-session-ticker info-session-ticker--placeholder"},r.a.createElement("header",{className:"info-session-ticker__title"},r.a.createElement("div",{className:"info-session-ticker__title-link"},this.props.title)),r.a.createElement("div",{className:"info-session-ticker__list",ref:"infosessionTickerList"},r.a.createElement("div",{className:"info-session-ticker__loading loading-dots loading-dots--light"},r.a.createElement("div",{className:"loading-dots__dot"}),r.a.createElement("div",{className:"loading-dots__dot"}),r.a.createElement("div",{className:"loading-dots__dot"}))))}}gp.propTypes={title:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,baseUrl:je.PropTypes.string.isRequired,baseUrlMobile:je.PropTypes.string.isRequired,baseUrlServices:je.PropTypes.string,webinarOnDemandUrl:je.PropTypes.string,OnDemand:je.PropTypes.string,isWebinar:je.PropTypes.string.isRequired,regions:je.PropTypes.array.isRequired,cities:je.PropTypes.array.isRequired,itmParametersUrls:je.PropTypes.shape({box:je.PropTypes.string.isRequired,list:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired})};var _p=gp,bp={slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3,arrows:!1};class vp extends r.a.Component{constructor(e){super(e),this.state={infosessions:[]}}fetchInfosessions(){var{regions:e,cities:t}=this.props;(({regions:e,cities:t})=>(new cp).fetch({regions:e,cities:t}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()))({regions:e,cities:t}).then(e=>{"qc"===window.DP.province?this.renderWebinarOnDemand(e):this.setState({infosessions:e})}).catch(()=>{this.setState({infosessions:[]}),"qc"===window.DP.province&&this.renderWebinarOnDemand()})}componentDidMount(){this.fetchInfosessions()}componentDidUpdate(){this.state.infosessions.length>0&&(this.element=d()(this.refs.infosessionCarousselList),di()(this.element,bp))}handleClick(){Se.a.pushDynamicEvent("infosession-widget-click-session-list","Listing_Mobile")}render(){return 0===this.state.infosessions.length?null:r.a.createElement("div",{id:"carousel-infosession-list"},r.a.createElement("div",{className:"carousel slide","data-ride":"carousel"},r.a.createElement("div",{className:"infosession-title"},this.renderTitleMobile()),r.a.createElement("div",{className:"carousel-inner infosession-infos"},r.a.createElement("span",{className:"arrow"}),r.a.createElement("ul",{className:"info-session-ticker__list",ref:"infosessionCarousselList"},this.state.infosessions.map((e,t)=>this.renderInfosession(e,t)))),r.a.createElement("div",{className:"clearfix"})))}renderTitleMobile(){return r.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.titleMobile}})}renderInfosession(e,t){if(!e.isWebinar&&"qc"!==window.DP.province)return!1;var s=e.isWebinar?"webinar":"infosession",a="",i="",n=e.isWebinar?this.props.webinarOnDemandUrl:this.props.baseUrlMobile;if("qc"===window.DP.province)if(i="info-session-ticker__list-item-",a="? ".concat(this.props.itmParametersUrls.mobile),e.isWebinar){if(e.dayMonth!==this.props.OnDemand)return;i+="ondemand",n=this.props.webinarOnDemandUrl}else i+="salle";return r.a.createElement("li",{key:"InfoSessionTicker:infosession:".concat(t),className:"item ".concat(i)},r.a.createElement("a",{href:"".concat(n,"?id=").concat(e.id,"&type=").concat(s,"&").concat("from=iw").concat(a),className:"gtm-infosession-ticker-mobile-link-session",onClick:this.handleClick.bind(this)},this.renderCity(e),r.a.createElement("br",null),e.dayMonth),r.a.createElement(Ge.a,{className:"icon-arrow-right",src:"/build/img/svg/icn-arrow.svg",cacheGetRequests:!0}))}renderWebinarOnDemand(e){if("qc"===window.DP.province){var t={city:null,dayMonth:this.props.OnDemand,description:"".concat(this.props.isWebinar," ").concat(this.props.OnDemand),id:"",isWebinar:!0,language:window.DP.lang,latitude:0,longitude:0,province:"QC"},s=this.state.infosessions.concat(t);e&&(s=e.concat(t)),this.setState({infosessions:s})}}renderCity(e){var t=e.isWebinar?this.props.isWebinar:e.city;return r.a.createElement("strong",null,t)}}vp.propTypes={title:je.PropTypes.string.isRequired,titleMobile:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,baseUrl:je.PropTypes.string.isRequired,baseUrlMobile:je.PropTypes.string.isRequired,webinarOnDemandUrl:je.PropTypes.string,itmParametersUrls:je.PropTypes.shape({box:je.PropTypes.string.isRequired,list:je.PropTypes.string.isRequired,button:je.PropTypes.string.isRequired,mobile:je.PropTypes.string.isRequired}),OnDemand:je.PropTypes.string,isWebinar:je.PropTypes.string.isRequired,regions:je.PropTypes.array.isRequired,cities:je.PropTypes.array.isRequired};var yp=vp;class fp extends r.a.Component{render(){if(!this.props.isVisible)return null;var e="purplebricks"===window.DP.theme,t=He("province-selector-modal",{purplebricks:e}),s=He("province-selector-modal__container",{purplebricks:e});return r.a.createElement("div",{className:t},r.a.createElement("div",{className:"province-selector-modal__content"},r.a.createElement("div",{className:"province-selector-modal__main-container"},r.a.createElement("div",{className:s},e?r.a.createElement("div",{className:"province-selector-modal__logo"},r.a.createElement(Ge.a,{className:"province-selector-modal__logo-icon",src:"/build/img/svg/purplebricks/logo-purplebricks.svg",cacheGetRequests:!0})):r.a.createElement("div",{className:"province-selector-modal__text"},this.props.title),this.renderTitle(),r.a.createElement("ul",{className:"province-selector-modal__provinces"},this.props.provinces.map(e=>this.renderProvince(e))))),r.a.createElement("div",{className:"province-selector-modal__disclaimer"},this.props.disclaimer)))}renderTitle(){return"purplebricks"!==window.DP.theme?null:r.a.createElement("div",{className:"province-selector-modal__title"},this.props.title)}renderProvince(e){var t="provinceSelectorModal:province:".concat(e.name);return r.a.createElement("li",{key:t,className:"province-selector-modal__province"},r.a.createElement("a",{href:e.link,className:"province-selector-modal__province-link"},e.name))}}fp.propTypes={title:je.PropTypes.string.isRequired,provinces:je.PropTypes.arrayOf(je.PropTypes.shape({name:je.PropTypes.string.isRequired,link:je.PropTypes.string.isRequired})).isRequired,disclaimer:je.PropTypes.string.isRequired,isVisible:je.PropTypes.bool};var Tp=fp,Pp=e=>{var t=window.DP.urls.proxyCreateReferral;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class wp extends r.a.Component{constructor(e){super(e),this.state={referralFirstName:"",referralLastName:"",referralPhone:"",referentFirstName:"",referentLastName:"",referentEmail:"",referentPhone:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,showPopinNotEligible:!1,showPopinSuccess:!1,hidePopin:!0},this.handleValueChange=this.handleValueChange.bind(this)}scrollToItem(){window.scrollTo(0,d()(this.refs.referralForm).offset().top-50)}handleValueChange(e){this.setState({[e.target.name]:e.target.value})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.state.referralFirstName,t=this.state.referralLastName,s=this.state.referralPhone,a=this.state.referentFirstName,i=this.state.referentLastName,r=this.state.referentEmail,n=this.state.referentPhone,o=window.DP.province;Pp({referral_first_name:e,referral_last_name:t,referral_phone:s,referent_first_name:a,referent_last_name:i,referent_phone:n,referent_email:r,province:o}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,hidePopin:!1,showPopinSuccess:!0}),this.resetFormInformation(),Se.a.pushToDataLayer("gtm-event","ReferralPage","Subscribe","Referral")}).catch(e=>{var t=null,s="";e.status>400?s=this.props.genericError:(t=e.responseJSON.field,s=e.responseJSON.message),"referral_not_eligible"===t&&this.setState({showPopinNotEligible:!0,hidePopin:!1}),this.setState({errorField:t,displayedMessage:s,isSubmitting:!1,hasFailed:!0}),this.scrollToItem()})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null,showPopinNotEligible:!1,showPopinSuccess:!1,hidePopin:!0})}resetFormInformation(){this.setState({referralFirstName:"",referralLastName:"",referralPhone:"",referentFirstName:"",referentLastName:"",referentEmail:"",referentPhone:""})}renderMessage(){var e=He("referral-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return r.a.createElement("div",{className:e},this.state.displayedMessage)}renderReferralFirstNameField(){var e=He("referral-form__field",{invalid:"referral_first_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"referralFirstName",placeholder:this.props.referral.firstNamePlaceholder,value:this.state.referralFirstName,onChange:this.handleValueChange})}renderReferralLastNameField(){var e=He("referral-form__field",{invalid:"referral_last_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"referralLastName",placeholder:this.props.referral.lastNamePlaceholder,value:this.state.referralLastName,onChange:this.handleValueChange})}renderReferralPhoneField(){var e=He("referral-form__field",{invalid:this.handleReferralPhoneFieldInvalid()});return r.a.createElement(Vo.a,{className:e,mask:"999-999-9999",name:"referralPhone",placeholder:this.props.referral.phonePlaceholder,value:this.state.referralPhone,onChange:this.handleValueChange})}renderReferentFirstNameField(){var e=He("referral-form__field",{invalid:"referent_first_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"referentFirstName",placeholder:this.props.referent.firstNamePlaceholder,value:this.state.referentFirstName,onChange:this.handleValueChange})}renderReferentLastNameField(){var e=He("referral-form__field",{invalid:"referent_last_name"===this.state.errorField});return r.a.createElement("input",{className:e,type:"text",name:"referentLastName",placeholder:this.props.referent.lastNamePlaceholder,value:this.state.referentLastName,onChange:this.handleValueChange})}renderReferentEmailField(){var e=He("referral-form__field",{invalid:"referent_email_invalid"===this.state.errorField});return r.a.createElement("input",{className:e,type:"email",name:"referentEmail",placeholder:this.props.referent.emailPlaceholder,value:this.state.referentEmail,onChange:this.handleValueChange})}renderReferentPhoneField(){var e=He("referral-form__field",{invalid:this.handleReferentPhoneFieldInvalid()});return r.a.createElement(Vo.a,{className:e,mask:"999-999-9999",name:"referentPhone",placeholder:this.props.referent.phonePlaceholder,value:this.state.referentPhone,onChange:this.handleValueChange})}renderSubmitButton(){return this.state.isSubmitting?r.a.createElement("button",{className:"referral-form__button referral-form__button--submitting"},r.a.createElement("div",{className:"referral-form__button-content"},r.a.createElement(ze,null))):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"referral-form__button"},this.props.submitButtonLabel)}renderWizardContent(){return r.a.createElement("div",{className:"referral-form__wizard-container"},r.a.createElement("h2",{className:"referral-form__wizard-intro-title"},this.props.titleIntro),r.a.createElement("p",{className:"referral-form__wizard-intro-text",dangerouslySetInnerHTML:{__html:this.props.textIntro}}),this.renderFormContent())}renderDisclaimer(){return r.a.createElement("div",{className:"referral-form__disclaimer",dangerouslySetInnerHTML:{__html:this.props.disclaimer}})}renderFormContent(){return r.a.createElement("div",{className:"referral-form__wizard-content"},r.a.createElement("h2",{className:"referral-form__wizard-title"},this.props.referral.title),this.state.displayedMessage?this.renderMessage():null,r.a.createElement("div",{className:"referral-form__field-group"},this.renderReferralFirstNameField(),this.renderReferralLastNameField(),this.renderReferralPhoneField()),r.a.createElement("h2",{className:"referral-form__wizard-title"},this.props.referent.title),r.a.createElement("div",{className:"referral-form__field-group"},this.renderReferentFirstNameField(),this.renderReferentLastNameField(),this.renderReferentEmailField(),this.renderReferentPhoneField()),this.renderSubmitButton(),this.renderDisclaimer())}renderPopin(){return this.state.hidePopin?null:r.a.createElement("div",{className:"referral-form-popin"},r.a.createElement("div",{className:"referral-form-popin--inner"},this.renderPopinText(),r.a.createElement("div",{className:"referral-form-popin__close",onClick:this.handlePopinCloseAction.bind(this)},r.a.createElement(Ge.a,{className:"referral-form-popin__close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))))}renderPopinText(){var e="";return this.state.showPopinSuccess?e=this.props.popinSuccessText:this.state.showPopinNotEligible&&(e=this.props.popinNotEligibleText),r.a.createElement("div",{className:"referral-form-popin__text",dangerouslySetInnerHTML:{__html:e}})}render(){var e=He("referral-form",{success:this.state.hasSucceed});return r.a.createElement("div",{className:e,ref:"referralForm"},this.renderWizardContent(),this.renderPopin())}handlePopinCloseAction(){this.setState({hidePopin:!0})}handleReferralPhoneFieldInvalid(){return"referral_phone_required"===this.state.errorField||"referral_phone_invalid"===this.state.errorField||"referral_not_eligible"===this.state.errorField}handleReferentPhoneFieldInvalid(){return"referent_phone_required"===this.state.errorField||"referent_phone_invalid"===this.state.errorField||"referent_not_eligible"===this.state.errorField}}wp.propTypes={titleIntro:je.PropTypes.string.isRequired,textIntro:je.PropTypes.string.isRequired,referral:je.PropTypes.shape({firstNamePlaceholder:je.PropTypes.string.isRequired,lastNamePlaceholder:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired}),referent:je.PropTypes.shape({firstNamePlaceholder:je.PropTypes.string.isRequired,lastNamePlaceholder:je.PropTypes.string.isRequired,emailPlaceholder:je.PropTypes.string.isRequired,phonePlaceholder:je.PropTypes.string.isRequired,title:je.PropTypes.string.isRequired}),submitButtonLabel:je.PropTypes.string.isRequired,disclaimer:je.PropTypes.string.isRequired,popinSuccessText:je.PropTypes.string.isRequired,popinNotEligibleText:je.PropTypes.string.isRequired,genericError:je.PropTypes.string.isRequired};var Ep=wp;class Cp extends r.a.Component{constructor(e){super(e),this.state={isSubmitting:!1,submitted:!1}}componentDidMount(){this.openModal()}openModal(){c.a.setBucket("service_conditions"),c.a.get("_have_been_agreed_upon_v2")&&this.setState({submitted:!0})}handleButtonClick(){this.setState({isSubmitting:!0,submitted:!0}),c.a.setBucket("service_conditions"),c.a.set("_have_been_agreed_upon_v2",!0)}render(){var e=He("terms-of-use-popup",{hidden:this.state.submitted});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"terms-of-use-popup--inner"},r.a.createElement("div",{className:"terms-of-use-popup__text"},r.a.createElement("h3",{className:"terms-of-use-popup__title"},this.props.title),r.a.createElement("div",{className:"terms-of-use-popup__agreement"},this.props.termsAgreement),this.renderTerms(),r.a.createElement("div",{className:"terms-of-use-popup__form"},r.a.createElement("div",{className:"terms-of-use-popup__form__input"},this.renderSubmitButton())))))}renderTerms(){return r.a.createElement("div",{className:"terms-of-use-popup__legal"},r.a.createElement("div",{className:"terms-of-use-popup__legal-content",dangerouslySetInnerHTML:{__html:this.props.text}}))}renderSubmitButton(){return this.state.isSubmitting?r.a.createElement("button",{className:"terms-of-use-popup__button"},r.a.createElement(ze,null)):r.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"terms-of-use-popup__button"},this.props.buttonLabel)}}Cp.propTypes={title:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired,termsAgreement:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired};var Sp=Cp,Rp=s(36),Np=s.n(Rp);class kp extends r.a.Component{constructor(e){super(e),this.state={hidden:!1,infosessions:[],popupSeenOnce:!1}}componentDidMount(){setTimeout(()=>{this.openModalConditions()},5e3)}openModalConditions(){var e=[];if(Np.a.get(this.props.popupSeenOnceSscache))this.setState({infosessions:null});else{if(this.props.webinarOnly)return this.displayPopupWebinar()||this.setState({hidden:!0}),void this.gtmTriggerOpenModal();this.fetchInfosessionsBasedOnPromotion().then(t=>{e=t,this.setState({infosessions:t});var s=e[0],a=this.displayNextInfosessionDaysLeft(e);c.a.setBucket("infosessions_popup"),c.a.flushExpired();var i="_";i=i.concat(s.id,"_have_been_shown"),(!this.displayPopup(e)||!a||!this.displayFirstInfosessionPopup(a)||this.displayFirstInfosessionPopup(a)&&c.a.get(i))&&this.setState({hidden:!0}),this.gtmTriggerOpenModal()}).catch(()=>{this.setState({infosessions:null})})}}gtmTriggerOpenModal(){this.state.popupSeenOnce||this.state.hidden||(this.props.webinarOnly?Se.a.pushDynamicEvent("listing-popup-webinar-view",window.DP.context.pageType):Se.a.pushToDataLayer("gtm-event","SearchResults_InfosessionNearYou","View_PopUp","undefined"),this.setState({popupSeenOnce:!0}))}handlePopupCloseAction(){this.setState({hidden:!0}),this.storeInfosessionSeenOnce()}handlePopupExitLinkAction(){this.setState({hidden:!0}),this.props.webinarOnly?Se.a.pushDynamicEvent("listing-popup-webinar-button-click",window.DP.context.pageType):Se.a.pushToDataLayer("gtm-event","SearchResults_InfosessionNearYou","Click_Popup","undefined"),this.storeInfosessionSeenOnce()}render(){if(this.props.webinarOnly&&!this.displayPopupWebinar())return null;if(!this.props.webinarOnly&&!this.displayPopup(this.state.infosessions))return null;var e=He("info-sessions-popup",{hidden:this.state.hidden});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"info-sessions-popup--inner"},r.a.createElement("div",{className:"info-sessions-popup__close",onClick:this.handlePopupCloseAction.bind(this)}),r.a.createElement("div",{className:"info-sessions-popup__content"},r.a.createElement("div",{className:"info-sessions-popup__content-wrapper ".concat(this.props.webinarOnly?"content-wrapper-webinar":"content-wrapper-infosessions")},r.a.createElement("div",{className:"info-sessions-popup__invitation"},r.a.createElement("div",{className:"info-sessions-popup__texts"},this.renderInvitation(),this.props.webinarOnly?null:this.renderSchedule())),this.renderCtaButton()))))}renderCtaButton(){var e,t,s,a="",i="itm_source=search&itm_medium=navigation&itm_campaign=popup&itm_content=webinar-".concat(this.props.language);if(this.props.webinarOnly)e="?".concat(i),t=this.props.buttonLabelWebinar,s=this.props.webinarOnDemandUrl;else{var n=this.state.secondPopupSeen?this.props.itmParametersUrls.nearYou:this.props.itmParametersUrls.savings;e="&".concat(n),t=this.props.buttonLabel,s=this.props.infosessionDesktopUrl,a="?id=".concat(this.state.infosessions[0].id)}return r.a.createElement("a",{onClick:this.handlePopupExitLinkAction.bind(this),className:"info-sessions-popup__cta-button",href:"".concat(s).concat(a).concat(e)},t)}renderSchedule(){if(!this.props.webinarOnly){var e=this.state.infosessions[0].date;return r.a.createElement("div",{className:"info-sessions-popup__schedule"},r.a.createElement("div",{className:"info-sessions-popup__when"},r.a.createElement("div",{className:"info-sessions-popup__when-hour"},oo.formatDate(e,"hour","h")),this.renderWhenDate()),r.a.createElement("div",{className:"info-sessions-popup__title"},this.renderScheduleTitle()))}}renderWhenDate(){if(!this.props.webinarOnly){var e="info-sessions-popup__when-date info-sessions-popup__when-date--";e=e.concat(window.DP.lang);var t=this.state.infosessions[0].date,s=r.a.createElement("span",{className:"info-sessions-popup__when-day"},oo.formatDate(t,"day_number")),a=r.a.createElement("span",{className:"info-sessions-popup__when-month"},oo.formatDate(t,"month")),i=r.a.createElement("div",{className:e},s,a);return"en"===window.DP.lang&&(i=r.a.createElement("div",{className:e},a,s)),i}}renderScheduleTitle(){if(!this.props.webinarOnly)return r.a.createElement("div",null,r.a.createElement("h3",null,this.props.scheduleTitle),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.scheduleTitleContent},className:"info-sessions-popup__scheduletitle--content"}))}renderInvitation(){return r.a.createElement("div",null,r.a.createElement("div",{className:"info-sessions-popup__explanation",dangerouslySetInnerHTML:{__html:this.props.invitation}}),r.a.createElement("p",{className:"info-sessions-popup__explanation--content",dangerouslySetInnerHTML:{__html:this.props.invitationExplanation}}))}storeInfosessionSeenOnce(){var e="_";e=this.props.webinarOnly?e.concat("_have_been_shown"):e.concat(this.state.infosessions[0].id,"_have_been_shown"),c.a.setBucket("infosessions_popup"),c.a.set(e,!0,21600),(null===Np.a.get(this.props.popupSeenOnceSscache)||isNaN(Np.a.get(this.props.popupSeenOnceSscache))||void 0===Np.a.get(this.props.popupSeenOnceSscache))&&Np.a.set(this.props.popupSeenOnceSscache,!0)}fetchInfosessionsBasedOnPromotion(){var e,{regions:t,cities:s}=this.props,a=new cp;return e=this.props.webinarOnly?{only_promoted:!0,type:"webinar"}:{only_promoted:!0,regions:t,cities:s},a.fetch(e).then(e=>Promise.resolve(e)).catch(()=>Promise.reject())}displayPopupWebinar(){return!Qe()&&!Np.a.get(this.props.popupSeenOnceSscache)&&"qc"===window.DP.province}displayPopup(e){return!(Qe()||"qc"!==window.DP.province||!e||e&&!e.length)}displayNextInfosessionDaysLeft(e){if(!this.props.webinarOnly){var t=new Date;if(!e)return null;var s=e[0];if(s){var a=oo.reformatDate(s.date);if(t.getTime()>a.getTime())return null;var i=Math.abs(t.getTime()-a.getTime());return Math.ceil(i/864e5)}}}displayFirstInfosessionPopup(e){if(!this.props.webinarOnly)return e<=10&&e>3}}kp.propTypes={invitation:je.PropTypes.string.isRequired,invitationExplanation:je.PropTypes.string.isRequired,scheduleTitle:je.PropTypes.string.isRequired,scheduleTitleContent:je.PropTypes.string.isRequired,infosessionDesktopUrl:je.PropTypes.string.isRequired,webinarDesktopUrl:je.PropTypes.string.isRequired,webinarOnDemandUrl:je.PropTypes.string.isRequired,buttonLabel:je.PropTypes.string.isRequired,buttonLabelWebinar:je.PropTypes.string.isRequired,regions:je.PropTypes.array.isRequired,cities:je.PropTypes.array.isRequired,itmParametersUrls:je.PropTypes.shape({savings:je.PropTypes.string.isRequired,nearYou:je.PropTypes.string.isRequired}),webinarOnly:je.PropTypes.bool.isRequired,popupSeenOnceSscache:je.PropTypes.string.isRequired,language:je.PropTypes.string.isRequired};var Lp=kp;class qp extends r.a.Component{constructor(e){super(e),this.state={hidden:!0}}componentDidMount(){setTimeout(()=>{this.openModalConditions()},5e3)}openModalConditions(){this.displayPopupWebinar()&&(this.setState({hidden:!1}),this.gtmTriggerOpenModal(),this.storePopupSeenOnce())}gtmTriggerOpenModal(){Se.a.pushDynamicEvent("listing-popup-webinar-view",window.DP.context.pageType)}closePopup(e){this.setState({hidden:!0}),e&&Se.a.pushDynamicEvent("listing-popup-webinar-button-click",window.DP.context.pageType)}handlePopupCloseAction(){this.closePopup(!1)}handlePopupExitLinkAction(){this.closePopup(!0)}render(){if(this.state.hidden)return null;var e=He("webinar-popup",{hidden:this.state.hidden});return r.a.createElement("div",{className:e},r.a.createElement("div",{className:"webinar-popup--inner"},r.a.createElement("div",{className:"webinar-popup__close",onClick:this.handlePopupCloseAction.bind(this)}),r.a.createElement("div",{className:"webinar-popup__content"},r.a.createElement("div",{className:"webinar-popup__content-wrapper"},r.a.createElement("div",{className:"webinar-popup__invitation"},r.a.createElement("div",{className:"webinar-popup__texts"},this.renderInvitation())),this.renderCtaButton()))))}renderCtaButton(){var e="?itm_source=search&itm_medium=navigation&itm_campaign=popup&itm_content=webinar-".concat(this.props.language),t=this.props.buttonLabelWebinar,s=this.props.webinarOnDemandUrl;return r.a.createElement("a",{onClick:this.handlePopupExitLinkAction.bind(this),className:"webinar-popup__cta-button",href:"".concat(s).concat(e)},t)}renderInvitation(){return r.a.createElement("div",null,r.a.createElement("div",{className:"webinar-popup__explanation",dangerouslySetInnerHTML:{__html:this.props.invitation}}),r.a.createElement("p",{className:"webinar-popup__explanation--content",dangerouslySetInnerHTML:{__html:this.props.invitationExplanation}}))}storePopupSeenOnce(){Np.a.set(this.props.popupSeenOnceSscache,!0)}displayPopupWebinar(){return!Np.a.get(this.props.popupSeenOnceSscache)&&!Qe()&&"qc"===window.DP.province}}qp.propTypes={invitation:je.PropTypes.string.isRequired,invitationExplanation:je.PropTypes.string.isRequired,webinarOnDemandUrl:je.PropTypes.string.isRequired,buttonLabelWebinar:je.PropTypes.string.isRequired,popupSeenOnceSscache:je.PropTypes.string.isRequired,language:je.PropTypes.string.isRequired};var Op=qp;class xp extends r.a.Component{constructor(e){super(e),window.__lc=window.__lc||{},window.__lc.license=e.license,window.LC_API=window.LC_API||{},window.__lc.chat_between_groups=!0,window.__lc.group=e.group,window.LC_API.on_before_load=function(){e.version&&"light"===e.version?window.LC_API.livechat_chat_started||window.LC_API.hide_chat_window():window.LC_API.agents_are_available()||window.LC_API.visitor_engaged()||window.LC_API.hide_chat_window()};var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.livechatinc.com/tracking.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}render(){return r.a.createElement("div",null)}}xp.propTypes={license:je.PropTypes.number.isRequired,group:je.PropTypes.number.isRequired,version:je.PropTypes.string};var Dp=xp;class Mp extends r.a.Component{handleClick(){this.props.handleGroupClick(this)}render(){var{selected:e,label:t}=this.props,s=He("packages-selection__listingroup-selector-list-item",{active:e});return r.a.createElement("li",{className:s,onClick:this.handleClick.bind(this)},t)}}Mp.propTypes={handleGroupClick:je.PropTypes.func.isRequired,group:je.PropTypes.string.isRequired,selected:je.PropTypes.bool.isRequired,label:je.PropTypes.string.isRequired};var Ap=Mp;class Ip extends r.a.Component{render(){var{labels:e}=this.props;return r.a.createElement("div",{className:"packages-selection__listingroup-selector"},r.a.createElement("span",{className:"packages-selection__listingroup-selector-label"},e.title),r.a.createElement("ul",{className:"packages-selection__listingroup-selector-list"},this.getListingGroups().map(e=>this.renderListingGroupItem(e))))}getListingGroups(){var{config:e}=this.props;return Object.keys(e)}renderListingGroupItem(e){var{handleGroupClick:t,labels:s,selectedGroup:a}=this.props,i=s.groups[e],n=a===e;return r.a.createElement(Ap,{key:e,handleGroupClick:t,group:e,selected:n,label:i})}}Ip.propTypes={handleGroupClick:je.PropTypes.func.isRequired,config:je.PropTypes.object.isRequired,labels:je.PropTypes.shape({title:je.PropTypes.string.isRequired,groups:je.PropTypes.object.isRequired}),selectedGroup:je.PropTypes.string};var Bp=Ip;class Fp extends r.a.Component{render(){return r.a.createElement("div",{className:"packages-selection__boxes-extras"},this.renderSpecialOffer(),this.renderExtraIdealLargeVolume())}isPromoActive(e){var{extras:t}=this.props;return 0!==t.length&&-1!==t.indexOf(e)}getTextForPromoKey(e,t){var{labels:s}=this.props,a="";return s.hasOwnProperty("extra")&&s.extra.hasOwnProperty(e)&&s.extra[e].hasOwnProperty(t)&&"string"==typeof s.extra[e][t]&&(a=s.extra[e][t]),a}renderSpecialOffer(){var e=this.getTextForPromoKey("special_offer","title"),t=this.getTextForPromoKey("special_offer","text");if(this.isPromoActive("special_offer")&&(0!==e.length||0!==t.length))return r.a.createElement(jp,{title:e,text:t})}renderExtraIdealLargeVolume(){var e=this.getTextForPromoKey("ideal_for_large_volume","text");if(this.isPromoActive("ideal_for_large_volume")&&0!==e.length)return r.a.createElement(Vp,{text:e})}}class jp extends r.a.Component{render(){var{title:e,text:t}=this.props;return r.a.createElement("div",{className:"packages-selection__boxes-special-offer"},r.a.createElement("h4",{className:"packages-selection__boxes-special-offer-title"},e),r.a.createElement("p",{className:"packages-selection__boxes-special-offer-text",dangerouslySetInnerHTML:{__html:t}}))}}class Vp extends r.a.Component{render(){var{text:e}=this.props;return r.a.createElement("div",{className:""},e)}}Fp.propTypes={extras:je.PropTypes.array.isRequired,labels:je.PropTypes.object.isRequired},jp.propTypes={title:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired},Vp.propTypes={text:je.PropTypes.string.isRequired};var Up=Fp;class $p extends r.a.Component{buildTitle(){var{data:e,labels:t}=this.props,s="";return e.code&&(s=t.titles[e.code]),s}buildPrice(){var{data:e}=this.props;return e.price}buildDefinitions(){var{data:e}=this.props,t=this;return!e.hasOwnProperty("definitions")||e.hasOwnProperty("definitions")&&!Array.isArray(e.definitions)?[]:e.definitions.map((function(e){return{key:t.buildDefinitionKey(e),title:t.buildDefinitionTitle(e),help:t.buildDefinitionHelp(e)}}))}buildDefinitionKey(e){var{data:t}=this.props;return"".concat(t.code,"_").concat(e)}buildDefinitionTitle(e){var{labels:t}=this.props,s=t.definitions;return s.hasOwnProperty(e)&&s[e].hasOwnProperty("text")?s[e].text:""}buildDefinitionHelp(e){var{labels:t}=this.props,s=t.definitions;return s.hasOwnProperty(e)&&s[e].hasOwnProperty("help")?s[e].help:""}buildButtonText(){var{labels:e,data:t}=this.props,s="default";return t.hasOwnProperty("button")&&e.buttons.hasOwnProperty(t.button)&&(s=t.button),e.buttons[s]}buildButtonUrl(){var{baseUrl:e,data:t,selectedGroup:s}=this.props,a=1;return t.hasOwnProperty("rank")&&"number"==typeof t.rank&&(a=t.rank),"".concat(e,"&package=").concat(a,"&type=").concat(s)}render(){var{data:e,labels:t}=this.props,s=[];return e.hasOwnProperty("extras")&&Array.isArray(e.extras)&&(s=e.extras),r.a.createElement("div",{className:"packages-selection__boxes packages-selection__boxes--package-".concat(e.rank)},r.a.createElement(Gp,{title:this.buildTitle()}),r.a.createElement(zp,{definitions:this.buildDefinitions()}),r.a.createElement(Up,{extras:s,labels:t}),r.a.createElement(Hp,{price:this.buildPrice()}),r.a.createElement(Kp,{text:this.buildButtonText(),url:this.buildButtonUrl()}))}}class Gp extends r.a.Component{render(){var{title:e}=this.props;return r.a.createElement("div",{className:"packages-selection__boxes-title packages-selection__boxes-title--lang-".concat(window.DP.lang)},r.a.createElement("h3",null,e))}}class Hp extends r.a.Component{encodeCurrencyValueDisplay(e){return h.a.encodeCurrencyValue(e,{noDecimal:!1})}render(){var{price:e}=this.props;return r.a.createElement("div",{className:"packages-selection__boxes-price"},this.encodeCurrencyValueDisplay(e))}}class zp extends r.a.Component{render(){var{definitions:e}=this.props;return r.a.createElement("div",{className:"packages-selection__boxes-definition"},r.a.createElement("ul",{className:"packages-selection__boxes-definition-list"},e.map((e,t)=>this.renderDefinitionLine(e,t))))}renderDefinitionLine(e,t){return r.a.createElement("li",{key:t},r.a.createElement("span",{className:"packages-selection__boxes-definition-text",dangerouslySetInnerHTML:{__html:e.title}}),r.a.createElement(Wp,{id:e.key,text:e.help}))}}class Wp extends r.a.Component{render(){return this.props.text.length<=0?null:r.a.createElement("span",{className:"packages-selection__boxes-definition-helper"},r.a.createElement("span",{className:"packages-selection__boxes-definition-helper-trigger"},"?"),this.renderHelperText())}renderHelperText(){var e=this.props.text;return r.a.createElement("span",{className:"packages-selection__boxes-helper-text",dangerouslySetInnerHTML:{__html:e}})}}class Kp extends r.a.Component{render(){var{text:e,url:t}=this.props;return r.a.createElement("div",{className:"packages-selection__boxes-button-container"},r.a.createElement("a",{className:"packages-selection__boxes-button",href:t,target:"_self"},e))}}Gp.propTypes={title:je.PropTypes.string.isRequired},Hp.propTypes={price:je.PropTypes.number.isRequired},zp.propTypes={definitions:je.PropTypes.array.isRequired},Wp.propTypes={id:je.PropTypes.string.isRequired,text:je.PropTypes.string.isRequired},Kp.propTypes={text:je.PropTypes.string.isRequired,url:je.PropTypes.string.isRequired},$p.propTypes={baseUrl:je.PropTypes.string.isRequired,data:je.PropTypes.object.isRequired,labels:je.PropTypes.object.isRequired,selectedGroup:je.PropTypes.string};var Yp=$p;class Xp extends r.a.Component{constructor(e){super(e)}getGroupPackages(){var{config:e,selectedGroup:t}=this.props;return e[t]}render(){return r.a.createElement("div",{className:"packages-selection__boxes-container"},this.getGroupPackages().map((e,t)=>this.renderPackageItem(e,t)))}renderPackageItem(e,t){var{labels:s,baseUrl:a,selectedGroup:i}=this.props;return r.a.createElement(Yp,{key:t,baseUrl:a,data:e,labels:s,selectedGroup:i})}}Xp.propTypes={baseUrl:je.PropTypes.string.isRequired,config:je.PropTypes.object.isRequired,labels:je.PropTypes.object.isRequired,selectedGroup:je.PropTypes.string};var Zp=Xp;class Jp extends r.a.Component{render(){return r.a.createElement("div",{className:"packages-selection__disclaimer"},this.props.disclaimerText)}}Jp.propTypes={disclaimerText:je.PropTypes.string.isRequired};var Qp=Jp;class ed extends r.a.Component{constructor(e){super(e);var t=e.selectedGroup;this.state={selectedGroup:t}}handleGroupClick(e){var t=e.props.group;this.setState({selectedGroup:t})}render(){var{config:e,labels:t,baseUrl:s,disclaimerText:a}=this.props,{selectedGroup:i}=this.state;return r.a.createElement("div",{className:"packages-selection__main-container"},r.a.createElement(Bp,{config:e,labels:t.listingGroupSelection,selectedGroup:i,handleGroupClick:this.handleGroupClick.bind(this)}),r.a.createElement(Zp,{baseUrl:s,config:e,labels:t.packages,selectedGroup:i}),r.a.createElement(Qp,{disclaimerText:a}))}}ed.propTypes={baseUrl:je.PropTypes.string.isRequired,config:je.PropTypes.object.isRequired,labels:je.PropTypes.shape({listingGroupSelection:je.PropTypes.object.isRequired,packages:je.PropTypes.object.isRequired}),selectedGroup:je.PropTypes.string,disclaimerText:je.PropTypes.string.isRequired};var td=ed;class sd extends r.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0})}renderMatterportIframe(){if(!this.state.showModal)return null;var e=He("photo-viewer-3d-showcase-content__viewer",{visible:this.state.showModal});return r.a.createElement("iframe",{className:"".concat(e," matterportIframe_vrmfu2 keep-aspect-ratio"),src:this.props.showcaseUrl,frameBorder:"0",allowFullScreen:!0})}renderDisplay3DShowcaseButton(){return this.state.showModal?null:r.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"virtual-tour-page-visual__block__button"},r.a.createElement("img",{className:"virtual-tour-page-visual__block__button__image",src:"/build/img/jpg/landingpages/landing-virtual-tour/virtual-tour-preview-v2-".concat(this.props.lang,".jpg"),alt:""}))}render(){var e=He("virtual-tour-page-visual__block__showcase",{visible:this.state.showModal});return r.a.createElement("div",{className:e},this.renderDisplay3DShowcaseButton(),this.renderMatterportIframe())}}sd.propTypes={showcaseUrl:je.PropTypes.string.isRequired,lang:je.PropTypes.string.isRequired};var ad=sd;class id extends r.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0})}loadWistiaVideoScript(){var e=document.createElement("script"),t="//fast.wistia.com/embed/medias/".concat(this.props.virtualTourVideoPath,".jsonp");e.src=t,e.async=!0,window.wistiaInit=e=>e.options("".concat(this.props.virtualTourVideoPath),{autoPlay:!0}),document.querySelector("footer").appendChild(e)}loadWistiaAssetsScript(){var e=document.createElement("script");e.src="//fast.wistia.com/assets/external/E-v1.js",document.body.appendChild(e)}renderTriggerVideoButton(){return this.state.showModal?null:r.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"virtual-tour-page__video__trigger"})}renderWistiaVideo(){return this.state.showModal?r.a.createElement("div",null,r.a.createElement("div",{className:"wistia_embed wistia_async_".concat(this.props.virtualTourVideoPath)}," "),this.loadWistiaVideoScript(),this.loadWistiaAssetsScript()):null}render(){return r.a.createElement("div",null,this.renderTriggerVideoButton(),this.renderWistiaVideo())}}id.propTypes={virtualTourVideoPath:je.PropTypes.string.isRequired};var rd=id;class nd extends r.a.Component{constructor(e){super(e),c.a.setBucket("survey-popup"),this.state={isVisible:!1,willShow:!c.a.get("status")&&this.lottery()}}componentDidMount(){if(!this.state.willShow)return null;this.openPopup()}lottery(){var e=Math.random().toFixed(2);return c.a.setBucket("survey-popup"),e<.33?(c.a.set("status","winner"),!0):(c.a.set("status","looser"),!1)}openPopup(){setTimeout(()=>{this.setState({isVisible:!0})},5e3)}closePopup(e){c.a.setBucket("survey-popup"),c.a.set("status",e),this.setState({isVisible:!1})}handleCloseButtonClick(){this.closePopup("declined")}handleLinkButtonClick(){this.closePopup("accepted")}renderLinkButton(){return this.props.buttonTitle&&this.props.buttonLink?r.a.createElement("p",{className:"is-center"},r.a.createElement("a",{href:this.props.buttonLink,target:"_blank",className:"button survey-popup__link-button",onClick:()=>this.handleLinkButtonClick()},this.props.buttonTitle)):null}render(){return r.a.createElement("section",{className:"survey-popup"+(this.state.isVisible?" survey-popup--is-visible":"")},r.a.createElement("div",{className:"survey-popup__inner"},r.a.createElement("div",{className:"survey-popup__close",onClick:()=>this.handleCloseButtonClick()},r.a.createElement(Ge.a,{className:"survey-popup__close__icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})),this.props.title?r.a.createElement("h2",{className:"survey-popup__title"},this.props.title):null,r.a.createElement("div",{className:"survey-popup__text",dangerouslySetInnerHTML:{__html:this.props.text}}),this.renderLinkButton(),this.props.legal?r.a.createElement("footer",{className:"survey-popup__footer"},this.props.legal):null))}}nd.propTypes={buttonLink:je.PropTypes.string,buttonTitle:je.PropTypes.string,legal:je.PropTypes.string,title:je.PropTypes.string,text:je.PropTypes.string.isRequired};var od=nd,ld=e=>{var t="";switch(e.type){case"link-back":t="link link--arrow-back";break;case"button-back":t="button button--back";break;case"button-right":t="button button--arrow button--right";break;case"cancel-showing":t="link cancel";break;case"cancelShowingPopupSubmitButton":t="button button--small button--arrow";break;default:t="button button--arrow"}return r.a.createElement("button",{className:t,onClick:t=>{e.handleOnClick(t)}},e.label)};ld.propTypes={label:je.PropTypes.string.isRequired,handleOnClick:je.PropTypes.func.isRequired,type:je.PropTypes.string};var cd=ld,pd=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dd=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],hd=["January","February","March","April","May","June","July","August","September","October","November","December"],ud=e=>e<10?"0".concat(e):e,md=e=>{var t=new Date(e),s=t.getTime(),a=t.getTimezoneOffset(),i=new Date(s+60*a*1e3),r=pd[i.getDay()],n=hd[i.getMonth()],o=i.getDate(),l=i.getFullYear();return"".concat(r," ").concat(n," ").concat(o,", ").concat(l)},gd=(e,t)=>{var s=[];return[...Array(e).keys()].map((function(){var e=t,a="".concat(t.getFullYear()).concat("-").concat(ud(t.getMonth()+1)).concat("-").concat(ud(t.getDate()));s.push({day:t.getDate().toString(),dow:pd[t.getDay()],month:dd[t.getMonth()],value:a}),e.setDate(e.getDate()+1)})),s},_d=e=>(e/60).toString().split("."),bd=e=>e?Math.floor(e/Math.pow(10,e.length)*60).toString():"00",vd=e=>(e=e>=1440?e-1440:e)<720?"am":"pm",yd=(e,t)=>t<=779?e:(e-12).toString(),fd=e=>e<10?"0".concat(e):"".concat(e),Td=(e,t)=>"".concat(e).concat(":").concat(t),Pd=e=>"object"==typeof e&&e.hasOwnProperty("unavailabilities")?e.unavailabilities:[],wd=(e,t,s)=>{for(var a=60*t,i=[],r=60*e;r<=a;){var n=fd(r%60),o=_d(r);i.push({ampm:vd(r).toString().toUpperCase(),label:Td(yd(o[0],r),n),value:Td(fd(Math.floor(r/60)),n)}),r+=s}return i},Ed=(e,t)=>{var s=t.find(t=>t.date===e);return"object"==typeof s&&s.hasOwnProperty("unavailable")?s.unavailable:[]},Cd=(e,t)=>{var s=e.split(":"),a=60*parseInt(s[0],10)+parseInt(s[1],10),i=a+t,r=_d(a),n=_d(i);return"".concat(Td(yd(r[0],a),bd(r[1])))+"".concat(vd(a))+"-"+"".concat(Td(yd(n[0],i),bd(n[1])))+"".concat(vd(i))},Sd={accessibility:!1,arrows:!0,autoplay:!1,infinite:!1,slidesToShow:7,slidesToScroll:7,speed:200,zIndex:1,responsive:[{breakpoint:900,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1100,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1300,settings:{slidesToShow:7,slidesToScroll:7}}],nextArrow:".showing-booking-tool__date__navigation--right",prevArrow:".showing-booking-tool__date__navigation--left"},Rd={accessibility:!1,arrows:!0,autoplay:!1,infinite:!1,slidesToShow:7,slidesToScroll:7,speed:200,zIndex:1,responsive:[{breakpoint:900,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1100,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1300,settings:{slidesToShow:7,slidesToScroll:7}}],nextArrow:".showing-booking-tool__time__navigation--right",prevArrow:".showing-booking-tool__time__navigation--left"},Nd=e=>{var[t,s]=Object(i.useState)(!0),[a,n]=Object(i.useState)(!1),[o,l]=Object(i.useState)(!1),[c,p]=Object(i.useState)(!1),h=()=>{e.handleGoToStep(1),Se.a.pushDynamicEvent("book-online-edit-details-button",window.DP.context.pageType)},u=()=>{if(!a)return r.a.createElement("div",{className:"cancel_showing_popup_actions__group"},m(),g())},m=()=>r.a.createElement("button",{className:"button button--back",onClick:()=>s(!0)},e.labels.actions.no),g=()=>r.a.createElement("button",{className:"button button--arrow button--right",onClick:_.bind(void 0)},e.labels.actions.yes),_=t=>{t.preventDefault(),p(!1),l(!1),n(!0);var s="/en/api-proxy/showing/cancel/".concat(e.showingToken,"/").concat(e.agentId);return d.a.ajax({method:"POST",url:s,data:{},beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))},success:e=>{!0==!!e.cancelCompleted&&l(!0)},error:()=>{p(!0),l(!0)}})},b=()=>{if(o)return c?r.a.createElement("div",{className:"showing-booking-tool-message error"},e.labels.messages.default_error_defined):r.a.createElement("div",{className:"showing-booking-tool-message success"},e.labels.messages.confirm_cancel_showing)},v=()=>r.a.createElement("div",{className:"modal__close-button",onClick:()=>s(!0)},r.a.createElement(Ge.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}));return r.a.createElement("div",{className:"showing-booking-tool__booking-information"},(()=>{if(!e.type)return r.a.createElement("p",{className:"title"},e.labels.titles.summary);var t=e.labels.inputs[e.type]||e.type;return r.a.createElement("p",{className:"title"},t," ",e.labels.titles.summary_type)})(),e.address?r.a.createElement("div",{className:"showing-booking-tool__booking-information__address showing-booking-tool__booking-information__address--with-icon"},e.address):null,r.a.createElement("div",{className:"showing-booking-tool__booking-information__date showing-booking-tool__booking-information__date--with-icon"},md(e.date)),r.a.createElement("div",{className:"showing-booking-tool__booking-information__time showing-booking-tool__booking-information__time--with-icon"},Cd(e.time,e.addMinutes),r.a.createElement("span",{className:"showing-booking-tool__booking-information__time-zone"},e.timezone)),e.labels.messages.lock_box_info?r.a.createElement("div",{className:"showing-booking-tool__booking-information__lock-box--with-icon"},e.labels.messages.lock_box_info):null,e.notes?r.a.createElement("div",null,r.a.createElement("div",{className:"showing-booking-tool__booking-information__note--with-icon"},e.labels.titles.notes),r.a.createElement("div",{className:"showing-booking-tool__booking-information__note"},e.notes)):null,(()=>{if(e.canCancelBooking)return r.a.createElement("div",{className:"showing-booking-tool__booking-actions"},r.a.createElement(cd,{handleOnClick:()=>s(!1),label:"Cancel showing",type:"cancel-showing"}))})(),e.handleGoToStep?r.a.createElement("div",null,r.a.createElement(cd,{handleOnClick:h,label:e.labels.actions.edit_details,type:"link-back"})):null,(()=>{if(!t){var s=r.a.createElement("div",{className:"cancel_showing_popup__title"},e.labels.titles.confirm_cancel_showing);return a&&(s=""),r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal__content"},b(),v(),s,u()))}})())};Nd.propTypes={address:je.PropTypes.string,date:je.PropTypes.string.isRequired,handleGoToStep:je.PropTypes.func,labels:je.PropTypes.object.isRequired,time:je.PropTypes.string.isRequired,timezone:je.PropTypes.string.isRequired,notes:je.PropTypes.string,showingToken:je.PropTypes.string,agentId:je.PropTypes.number,canCancelBooking:je.PropTypes.bool,type:je.PropTypes.string,addMinutes:je.PropTypes.number.isRequired},Nd.defaultProps={notes:null,type:""};var kd=Nd,Ld=e=>r.a.createElement("div",{className:"showing-booking-tool__agent__item"},r.a.createElement("div",{className:"showing-booking-tool__agent__item-label"},e.label),r.a.createElement("div",{className:"showing-booking-tool__agent__item-value"},e.value));Ld.propTypes={label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired};var qd=Ld,Od=e=>r.a.createElement("div",{className:"showing-booking-tool__agent"},r.a.createElement(qd,{label:e.labels.agent.full_name,value:e.name}),4!==e.brokerage.province?null:r.a.createElement(qd,{label:e.labels.agent.brokerage.phone,value:e.brokerage.phone}),r.a.createElement(qd,{label:e.labels.agent.cell_number,value:e.phone}));Od.propTypes={brokerage:je.PropTypes.object.isRequired,labels:je.PropTypes.object.isRequired,name:je.PropTypes.string.isRequired,phone:je.PropTypes.string.isRequired};var xd=Od,Dd=e=>{var t=t=>{e.handleOnAgentPhoneChange(t.target.value)},s=()=>{e.agent&&e.handleConfirmAgent()},a=()=>{e.handleRemoveAgent(),Se.a.pushDynamicEvent("book-online-showing-summary-try-button-click",window.DP.context.pageType)},i=t=>{if("Enter"===t.key){var s=e.agentPhone.replace(/\D+/g,"");if(e.processing||10!==s.length)return;n()}},n=()=>{e.handleLookup(),Se.a.pushDynamicEvent("book-online-showing-summary-continue-button-click",window.DP.context.pageType)},o=()=>e.processing?null:r.a.createElement("div",null,r.a.createElement(cd,{handleOnClick:a,label:e.labels.actions.go_back,type:"button-back"}),r.a.createElement(cd,{handleOnClick:s,label:e.labels.actions.confirm})),l=()=>{var t=e.agentPhone.replace(/\D+/g,"");return e.processing||10!==t.length?null:(Se.a.pushDynamicEvent("book-online-showing-summary-continue-button-view",window.DP.context.pageType),r.a.createElement(cd,{handleOnClick:n,label:e.labels.actions.continue,type:"button-right"}))};return r.a.createElement("div",{className:"showing-booking-tool__booking-step-agentvalidation"},r.a.createElement("p",{className:"title"},e.labels.titles.confirm_identity),null!==e.agent?null:r.a.createElement("div",null,r.a.createElement("p",null,e.labels.messages.confirm_identity),r.a.createElement("label",{className:"showing-booking-tool__booking-step-agentvalidation__label",htmlFor:"phone"},e.labels.inputs.phone.label,"*"),r.a.createElement(Vo.a,{id:"phone",name:"phone",type:"tel",mask:"(999) 999-9999",className:"showing-booking-tool__booking-step-agentvalidation__input",placeholder:e.labels.inputs.phone.placeholder,onChange:t,onKeyPress:i,value:e.agentPhone}),r.a.createElement("p",{className:"showing-booking-tool__booking-step-agentvalidation__required-field-text"},e.labels.inputs.phone.required),l()),null!==e.agent&&e.agent.hasOwnProperty("id")?r.a.createElement("div",null,r.a.createElement("p",null,e.labels.messages.identity_found),r.a.createElement(xd,{brokerage:e.agent.brokerage,labels:e.labels,name:e.agent.name,phone:e.agent.phone}),r.a.createElement("p",{className:"showing-booking-tool__booking-step-complete__incorrect-information"},e.labels.messages.incorrect_info," ",r.a.createElement("strong",{className:"showing-booking-tool__booking-step-complete__incorrect-phone"},e.phone)),o()):null,null===e.agent||e.agent.hasOwnProperty("id")?null:r.a.createElement("div",null,r.a.createElement("p",null,e.labels.messages.identity_not_found),r.a.createElement("p",{className:"showing-booking-tool__booking-step-agentvalidation__not-found-phone"},e.phone),r.a.createElement("div",null,r.a.createElement(cd,{handleOnClick:a,label:e.labels.actions.try_another_phone,type:"link-back"}))))};Dd.propTypes={agent:je.PropTypes.object,agentPhone:je.PropTypes.string,handleConfirmAgent:je.PropTypes.func.isRequired,handleLookup:je.PropTypes.func.isRequired,handleOnAgentPhoneChange:je.PropTypes.func.isRequired,handleRemoveAgent:je.PropTypes.func.isRequired,labels:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired,processing:je.PropTypes.bool.isRequired};var Md=Dd,Ad=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-complete"},r.a.createElement("p",{className:"title"},e.labels.titles.thank_you),r.a.createElement("p",null,e.labels.messages.request_received),r.a.createElement("ul",{className:"showing-booking-tool__booking-step-complete__agent"},r.a.createElement("li",{className:"showing-booking-tool__booking-step-complete__agent-information"},e.agent.name),r.a.createElement("li",{className:"showing-booking-tool__booking-step-complete__agent-information"},e.agent.phone)),r.a.createElement("p",{className:"showing-booking-tool__booking-step-complete__incorrect-information"},e.labels.messages.incorrect_request," ",r.a.createElement("strong",{className:"showing-booking-tool__booking-step-complete__incorrect-phone"},e.phone)));Ad.propTypes={agent:je.PropTypes.object.isRequired,labels:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired};var Id=Ad,Bd=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-inactive"},r.a.createElement("p",{className:"title"},e.labels.titles.inactive),r.a.createElement("p",null,e.labels.messages.inactive),r.a.createElement("p",{className:"showing-booking-tool__booking-step-agentvalidation__not-found-phone"},e.phone));Bd.propTypes={labels:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired};var Fd=Bd,jd=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-error-booking"},r.a.createElement("p",{className:"title"},e.message.title),r.a.createElement("p",null,e.message.text));jd.propTypes={message:je.PropTypes.object.isRequired};var Vd=jd,Ud=e=>r.a.createElement("div",{className:"showing-booking-tool__date__item-container",onClick:()=>{e.handleOnDateChange(e.value),Se.a.pushDynamicEvent("book-online-date-click",window.DP.context.pageType)}},r.a.createElement("div",{className:He("showing-booking-tool__date__item-content",{selected:e.selected===e.value})},r.a.createElement("div",{className:"showing-booking-tool__date__dow"},e.dow),r.a.createElement("div",{className:"showing-booking-tool__date__day"},e.day),r.a.createElement("div",{className:"showing-booking-tool__date__month"},e.month)));Ud.propTypes={day:je.PropTypes.string.isRequired,dow:je.PropTypes.string.isRequired,handleOnDateChange:je.PropTypes.func.isRequired,month:je.PropTypes.string.isRequired,selected:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired};var $d=Ud;class Gd extends r.a.Component{componentDidMount(){this.createSlider()}componentDidUpdate(){this.createSlider()}UNSAFE_componentWillUpdate(e){this.props.structure!==e.structure&&this.destroySlider()}createSlider(){void 0===this.dateElements||this.dateElements.is(".slick-initialized")||di()(this.dateElements,Sd)}destroySlider(){void 0!==this.dateElements&&this.dateElements.slick("unslick")}mapDate(){var{handleOnDateChange:e,selected:t,structure:s}=this.props;return s.map((s,a)=>s.hasOwnProperty("times")&&0===s.times.length?null:r.a.createElement($d,{day:s.day,dow:s.dow,handleOnDateChange:e,key:a,month:s.month,selected:t,value:s.value}))}render(){var{structure:e}=this.props;return 0===e.length?null:r.a.createElement("div",{className:"showing-booking-tool__date__container"},r.a.createElement("div",{className:"showing-booking-tool__date__navigation showing-booking-tool__date__navigation--left"},r.a.createElement(Ge.a,{className:"showing-booking-tool__date__navigation__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:"",ref:e=>this.dateElements=d()(e)},this.mapDate()),r.a.createElement("div",{className:"showing-booking-tool__date__navigation showing-booking-tool__date__navigation--right"},r.a.createElement(Ge.a,{className:"showing-booking-tool__date__navigation__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})))}}Gd.propTypes={handleOnDateChange:je.PropTypes.func.isRequired,selected:je.PropTypes.string.isRequired,structure:je.PropTypes.array.isRequired};var Hd=Gd,zd=e=>r.a.createElement("div",{className:"showing-booking-tool__time__item-container",onClick:()=>{e.unavailable||(e.handleOnTimeChange(e.value),Se.a.pushDynamicEvent("book-online-time-click",window.DP.context.pageType))}},r.a.createElement("div",{className:He("showing-booking-tool__time__item-content",{selected:e.selected===e.value})},r.a.createElement("div",{className:"showing-booking-tool__time__elements"},r.a.createElement("span",{className:"showing-booking-tool__time__elements__time"},e.label),r.a.createElement("span",{className:"showing-booking-tool__time__elements__ampm"}," ",e.ampm))));zd.propTypes={ampm:je.PropTypes.string.isRequired,handleOnTimeChange:je.PropTypes.func.isRequired,label:je.PropTypes.string.isRequired,selected:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired};var Wd=zd;class Kd extends r.a.Component{componentDidMount(){this.createSlider()}componentDidUpdate(){this.createSlider()}UNSAFE_componentWillUpdate(e){this.props.times!==e.times&&this.destroySlider()}createSlider(){void 0===this.timeElements||this.timeElements.is(".slick-initialized")||di()(this.timeElements,Rd)}destroySlider(){void 0!==this.timeElements&&this.timeElements.slick("unslick")}mapTime(){var{handleOnTimeChange:e,selected:t,times:s}=this.props;return s.map((s,a)=>r.a.createElement(Wd,{ampm:s.ampm,handleOnTimeChange:e,key:a,label:s.label,selected:t,value:s.value}))}render(){var{times:e}=this.props;return 0===e.length?null:r.a.createElement("div",{className:"showing-booking-tool__time__container"},r.a.createElement("div",{className:"showing-booking-tool__time__navigation showing-booking-tool__time__navigation--left"},r.a.createElement(Ge.a,{className:"showing-booking-tool__time__navigation__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),r.a.createElement("div",{className:"showing-booking-tool__time__content",ref:e=>this.timeElements=d()(e)},this.mapTime()),r.a.createElement("div",{className:"showing-booking-tool__time__navigation showing-booking-tool__time__navigation--right"},r.a.createElement(Ge.a,{className:"showing-booking-tool__time__navigation__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})))}}Kd.propTypes={date:je.PropTypes.string,handleOnTimeChange:je.PropTypes.func.isRequired,selected:je.PropTypes.string.isRequired,times:je.PropTypes.array.isRequired};var Yd=Kd,Xd=(e,t)=>t.find(t=>t.value===e),Zd=(e,t,s,a,i)=>{var r=gd(t,new Date),n=wd(s,a,i),o=Pd(e);return r.forEach(e=>{var t=[],s=Ed(e.value,o);n.forEach(e=>{-1===s.indexOf(e.value)&&t.push(e)}),e.times=t}),r},Jd=(e,t)=>{var s=Xd(e,t);return"object"==typeof s&&s.hasOwnProperty("times")?s.times:[]},Qd=e=>{var t=()=>{e.date&&e.time&&(e.handleGoToStep(2),Se.a.pushDynamicEvent("book-online-continue-button",window.DP.context.pageType))},s=()=>{e.handleGoToStep(0)};return r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-date"},(()=>{if(!e.type)return r.a.createElement("p",{className:"title"},e.labels.titles.select_date_time);var t=(e.labels.inputs[e.type]||e.type).toLowerCase();return r.a.createElement("p",{className:"title"},e.labels.titles.select_date_time_type," ",t)})(),e.receivedOffer?r.a.createElement("div",{className:"showing-booking-tool__message"},e.labels.messages.received_offer):null,r.a.createElement(Hd,{handleOnDateChange:e.handleOnDateChange,selected:e.date,structure:e.structure}),r.a.createElement(Yd,{handleOnTimeChange:e.handleOnTimeChange,selected:e.time,times:Jd(e.date,e.structure)}),e.date&&e.time&&!e.processing?(Se.a.pushDynamicEvent("book-online-continue-button-view",window.DP.context.pageType),r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-date__footer"},r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-date__footer--left"},r.a.createElement("div",{className:"showing-booking-tool__booking-information__date"},md(e.date)),r.a.createElement("div",{className:"showing-booking-tool__booking-information__time"},Cd(e.time,e.addMinutes),r.a.createElement("span",{className:"showing-booking-tool__booking-information__time-zone"},e.timezone))),r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-date__footer--right"},r.a.createElement(cd,{handleOnClick:t,label:e.labels.actions.continue})))):null,e.type?r.a.createElement("div",null,r.a.createElement(cd,{handleOnClick:s,label:e.labels.actions.edit_type,type:"link-back"})):null)};Qd.propTypes={date:je.PropTypes.string.isRequired,handleGoToStep:je.PropTypes.func.isRequired,handleOnDateChange:je.PropTypes.func.isRequired,handleOnTimeChange:je.PropTypes.func.isRequired,labels:je.PropTypes.object.isRequired,processing:je.PropTypes.bool.isRequired,receivedOffer:je.PropTypes.bool.isRequired,structure:je.PropTypes.array.isRequired,time:je.PropTypes.string.isRequired,timezone:je.PropTypes.string.isRequired,type:je.PropTypes.string,addMinutes:je.PropTypes.number.isRequired};var eh=Qd,th=e=>void 0===e.render||e.render?r.a.createElement("div",{className:He("showing-booking-tool__type__item-content",{selected:e.type===e.value}),onClick:()=>e.handleOnClick(e.value)},e.labels.inputs[e.value]||e.value):null;th.propTypes={labels:je.PropTypes.object.isRequired,value:je.PropTypes.string.isRequired,type:je.PropTypes.string.isRequired,render:je.PropTypes.boolean,handleOnClick:je.PropTypes.func.isRequired};var sh=th,ah=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-showing-type"},r.a.createElement("div",{className:"showing-booking-tool__booking-information__address showing-booking-tool__booking-information__address--with-icon"},e.listing.address," ","\n",e.listing.city),r.a.createElement("p",{className:"title"},e.labels.titles.select_type),r.a.createElement("div",{className:"showing-booking-tool__type__item-container"},r.a.createElement(sh,{labels:e.labels,type:e.type,value:"booking",handleOnClick:e.handleOnClick}),r.a.createElement(sh,{labels:e.labels,type:e.type,value:"agent_preview",handleOnClick:e.handleOnClick}),r.a.createElement(sh,{labels:e.labels,type:e.type,value:"virtual_showing",render:e.virtualShowingEnabled,handleOnClick:e.handleOnClick})));ah.propTypes={labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,type:je.PropTypes.string.isRequired,virtualShowingEnabled:je.PropTypes.bool,handleOnClick:je.PropTypes.func.isRequired};var ih=ah,rh=e=>{var t=Ke()(window.DP.urls.proxy.showing.agent.findbyphone,e);return d.a.ajax({method:"GET",url:t,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},nh=e=>{var t=window.DP.urls.proxy.showing.booking.post;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},oh=(e,t)=>{var s=Ke()(window.DP.urls.proxy.showing.findbylisting,e,t);return d.a.ajax({method:"GET",url:s,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class lh extends r.a.Component{constructor(e){super(e),this.state={agent:null,agentPhone:"",date:"",addMinutes:60,messageSave:null,processing:!1,receivedOffer:!1,step:0,type:"",structure:[],time:"",virtualShowingEnabled:e.virtualShowingEnabled,timezone:""}}componentDidMount(){this.props.active&&this.findShowingService()}componentDidUpdate(e,t){var{step:s}=this.state;1===s&&s!==t.step&&this.findShowingService()}handleGoToStep(e){1===e&&this.setState({date:"",time:""}),0===e&&this.setState({type:"",date:"",time:""}),this.setState({step:e})}handleOnAgentPhoneChange(e){this.setState({agentPhone:e})}handleOnDateChange(e){this.setState({date:e,time:""})}handleOnTimeChange(e){this.setState({time:e})}createBooking(){var{date:e,time:t,type:s,agent:a}=this.state,{listing:i}=this.props;this.setState({messageSave:null,processing:!0}),nh({agent:a.id,date:e,listing:i.code,time:t,type:s}).then(e=>{var t=4;e.hasOwnProperty("type")&&"success"===e.type&&(t=3,Se.a.pushDynamicEvent("book-online-credentials-confirm",window.DP.context.pageType)),e.hasOwnProperty("message")&&this.setState({messageSave:e.message}),this.handleGoToStep(t),this.setState({processing:!1})})}findAgent(){var{agentPhone:e}=this.state,t=e.replace(/\D+/g,"");this.setState({agent:null,processing:!0}),rh(t).then(e=>{var t={};e.hasOwnProperty("found")&&e.found&&(t=e.agent,Se.a.pushDynamicEvent("book-online-credentials-continue",window.DP.context.pageType)),this.setState({agent:t,processing:!1})})}findShowingService(){var{listing:e}=this.props;this.setState({processing:!0}),oh(e.code,"booking").then(e=>{if(e.hasOwnProperty("unavailabilities")){var t=Zd(e,14,9,20,30);this.setState({structure:t})}e.hasOwnProperty("timezone")&&this.setState({timezone:e.timezone}),this.setState({receivedOffer:e.received_offer}),this.setState({processing:!1}),this.setState({virtualShowingEnabled:e.virtual_showing_enabled})})}removeAgent(){this.setState({agent:null,agentPhone:""})}renderBookingUnavailable(){return r.a.createElement("p",null,this.props.labels.messages.booking_unavailable)}renderBookingInformation(){var{date:e,step:t,time:s,timezone:a,addMinutes:i,type:n}=this.state,{active:o,labels:l,listing:c}=this.props;return o&&e&&s&&1!==t?r.a.createElement(kd,{address:c.address,date:e,handleGoToStep:3!==t?e=>this.handleGoToStep(e):null,labels:l,time:s,type:n,timezone:a,addMinutes:i}):null}renderCurrentStep(){var{agent:e,agentPhone:t,date:s,messageSave:a,processing:i,receivedOffer:n,step:o,structure:l,time:c,timezone:p,addMinutes:d,type:h,virtualShowingEnabled:u}=this.state,{active:m,labels:g,phone:_,listing:b}=this.props;if(!m)return r.a.createElement(Fd,{labels:g,phone:_});switch(o){case 2:return r.a.createElement(Md,{agent:e,agentPhone:t,handleConfirmAgent:()=>this.createBooking(),handleLookup:()=>this.findAgent(),handleOnAgentPhoneChange:e=>this.handleOnAgentPhoneChange(e),handleRemoveAgent:()=>this.removeAgent(),labels:g,type:h,phone:_,processing:i});case 3:return r.a.createElement(Id,{agent:e,labels:g,phone:_});case 4:return r.a.createElement(Vd,{message:a});case 1:return r.a.createElement(eh,{date:s,handleGoToStep:e=>this.handleGoToStep(e),handleOnDateChange:e=>this.handleOnDateChange(e),handleOnTimeChange:e=>this.handleOnTimeChange(e),labels:g,type:h,processing:i,addMinutes:d,receivedOffer:n,structure:l,time:c,timezone:p});default:return r.a.createElement(ih,{labels:g,listing:b,type:h,virtualShowingEnabled:u,handleOnClick:e=>this.handleOnTypeChange(e)})}}handleOnTypeChange(e){"Home inspection"===e&&this.setState({addMinutes:180}),this.setState({type:e,step:1})}specialMessage(){return this.state.step in[0,1]?r.a.createElement("div",{className:"information-bar"},r.a.createElement("p",{className:"desktop"},this.props.labels.messages.COVID),r.a.createElement("p",{className:"mobile"},this.props.labels.messages.COVID)):null}render(){return!this.props.listing.has_showing_service||this.props.listing.is_sold?r.a.createElement("div",{className:"showing-booking-tool__container"},this.renderBookingUnavailable()):r.a.createElement("div",{className:"showing-booking-tool__container"},r.a.createElement("div",{className:"showing-booking-tool__content"},this.renderBookingInformation(),this.renderCurrentStep()),this.specialMessage())}}lh.propTypes={active:je.PropTypes.bool.isRequired,labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,virtualShowingEnabled:je.PropTypes.boolean,phone:je.PropTypes.string.isRequired};var ch=lh,ph=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-complete"},r.a.createElement("p",{className:"title"},e.labels.titles.thank_you),r.a.createElement("p",null,e.labels.messages.request_received),r.a.createElement("p",{className:"showing-booking-tool__booking-step-complete__incorrect-information"},e.labels.messages.incorrect_request," ",r.a.createElement("strong",{className:"showing-booking-tool__booking-step-complete__incorrect-phone"},e.phone)));ph.propTypes={labels:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired};var dh=ph,hh=e=>r.a.createElement("div",{className:"showing-booking-tool__booking-step-select-showing-type"},r.a.createElement("div",{className:"showing-booking-tool__booking-information__address showing-booking-tool__booking-information__address--with-icon"},e.listing.address," ","\n",e.listing.city),r.a.createElement("p",{className:"title"},e.labels.titles.select_type),r.a.createElement("div",{className:"showing-booking-tool__type__item-container"},r.a.createElement(sh,{labels:e.labels,type:e.type,value:e.labels.inputs.home_inspection,handleOnClick:e.handleOnClick}),r.a.createElement(sh,{labels:e.labels,type:e.type,value:e.labels.inputs.walkthrough,handleOnClick:e.handleOnClick}),r.a.createElement(sh,{labels:e.labels,type:e.type,value:e.labels.inputs.appraisal,handleOnClick:e.handleOnClick})));hh.propTypes={labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,type:je.PropTypes.string.isRequired,handleOnClick:je.PropTypes.func.isRequired};var uh=hh;class mh extends r.a.Component{constructor(e){super(e),this.state={agent:e.agentId,booking:e.bookingId,agentPhone:"",date:"",messageSave:null,processing:!1,receivedOffer:!1,step:0,type:"",addMinutes:60,structure:[],time:"",timezone:""}}componentDidMount(){this.props.active&&this.findShowingService()}componentDidUpdate(e,t){var{step:s}=this.state;1===s&&s!==t.step&&this.findShowingService()}handleGoToStep(e){1===e&&this.setState({date:"",time:""}),0===e&&this.setState({type:"",date:"",time:"",addMinutes:60}),this.setState({step:e})}handleOnDateChange(e){this.setState({date:e,time:""})}handleOnTimeChange(e){this.setState({time:e})}handleOnTypeChange(e){"Home inspection"===e&&this.setState({addMinutes:180}),this.setState({type:e,step:1})}findShowingService(){var{listing:e}=this.props;this.setState({processing:!0}),oh(e.code,"post-offer").then(e=>{if(e.hasOwnProperty("unavailabilities")){var t=Zd(e,14,9,20,30);this.setState({structure:t})}e.hasOwnProperty("timezone")&&this.setState({timezone:e.timezone}),this.setState({processing:!1})})}renderBookingUnavailable(){return r.a.createElement("p",null,this.props.labels.messages.booking_unavailable)}handleConfirm(){var{date:e,time:t,agent:s,type:a,booking:i}=this.state,{listing:r}=this.props;this.setState({messageSave:null,processing:!0}),nh({agent:s,date:e,listing:r.code,time:t,type:"post offer activities ".concat(a),booking:i}).then(e=>{var t=4;e.hasOwnProperty("type")&&"success"===e.type&&(t=3),e.hasOwnProperty("message")&&this.setState({messageSave:e.message}),this.handleGoToStep(t),this.setState({processing:!1})})}renderBookingInformation(){var{date:e,step:t,time:s,timezone:a,type:i,addMinutes:n}=this.state,{active:o,labels:l,listing:c}=this.props;return o&&e&&s&&1!==t?r.a.createElement(kd,{address:c.address,date:e,handleGoToStep:3!==t?e=>this.handleGoToStep(e):null,labels:l,time:s,timezone:a,type:i,addMinutes:n}):null}renderCurrentStep(){var{agent:e,date:t,messageSave:s,processing:a,receivedOffer:i,step:n,structure:o,time:l,timezone:c,type:p,addMinutes:d}=this.state,{active:h,labels:u,phone:m,listing:g}=this.props;if(!h)return r.a.createElement(Fd,{labels:u,phone:m});switch(n){case 2:return r.a.createElement(cd,{label:u.actions.confirm,handleOnClick:()=>this.handleConfirm(),type:"button-right"});case 3:return r.a.createElement(dh,{agent:e,labels:u,phone:m});case 4:return r.a.createElement(Vd,{message:s});case 1:return r.a.createElement(eh,{date:t,handleGoToStep:e=>this.handleGoToStep(e),handleOnDateChange:e=>this.handleOnDateChange(e),handleOnTimeChange:e=>this.handleOnTimeChange(e),labels:u,processing:a,receivedOffer:i,structure:o,time:l,addMinutes:d,timezone:c,type:p});default:return r.a.createElement(uh,{labels:u,listing:g,type:p,handleOnClick:e=>this.handleOnTypeChange(e)})}}render(){return this.props.listing.has_showing_service?r.a.createElement("div",{className:"showing-booking-tool__container"},r.a.createElement("div",{className:"showing-booking-tool__content"},this.renderBookingInformation(),this.renderCurrentStep())):r.a.createElement("div",{className:"showing-booking-tool__container"},this.renderBookingUnavailable())}}mh.propTypes={active:je.PropTypes.bool.isRequired,agentId:je.PropTypes.number.isRequired,bookingId:je.PropTypes.number.isRequired,labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired};var gh=mh,_h=e=>r.a.createElement("div",{className:"showing-booking-tool__container"},r.a.createElement("div",{className:"showing-booking-tool__content"},r.a.createElement(kd,{address:e.listing.address,date:e.booking.date,handleGoToStep:null,labels:e.labels,time:e.booking.time,type:e.booking.displayType,timezone:e.showing.timezone,notes:e.showing.notes,showingToken:e.showing.token,canCancelBooking:e.booking.can_cancel,agentId:e.agent.id,addMinutes:e.booking.duration}),r.a.createElement("div",{className:"showing-booking-tool__booking-step-agentvalidation"},r.a.createElement("p",{className:"title"},e.labels.titles.agent),r.a.createElement(xd,{brokerage:e.agent.brokerage,labels:e.labels,name:e.agent.name,phone:e.agent.phone}),r.a.createElement("p",{className:"showing-booking-tool__booking-step-complete__incorrect-information"},e.labels.messages.incorrect_info,r.a.createElement("strong",{className:"showing-booking-tool__booking-step-complete__incorrect-phone"},e.phone)))));_h.propTypes={labels:je.PropTypes.object.isRequired,listing:je.PropTypes.object.isRequired,booking:je.PropTypes.object.isRequired,showing:je.PropTypes.object.isRequired,agent:je.PropTypes.object.isRequired,phone:je.PropTypes.string.isRequired};var bh=_h,vh=e=>{var t=window.DP.urls.proxy.showing.feedback.post;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};class yh extends r.a.Component{constructor(e){super(e),this.state={comment:"",displayedMessage:"",displayedMessageType:"",isSubmitted:!1}}handleSubmit(e){e.preventDefault();var{token:t}=this.props,{comment:s}=this.state;this.validateForm()&&(this.setState({isSubmitted:!0}),vh({token:t,comment:s}).then(e=>{"success"===e.type&&Se.a.pushDynamicEvent("showing-feedback-submit",window.DP.context.pageType),this.setState({comment:"",displayedMessage:e.message,displayedMessageType:e.type,isSubmitted:!1})}))}handleTextAreaChange(e){this.setState({comment:e.target.value})}validateForm(){var{labels:e}=this.props,{comment:t}=this.state,s=!0;return t||(this.setState({displayedMessage:e.fields.comment.validation.required,displayedMessageType:"error"}),s=!1),s}renderButton(){var{labels:e}=this.props,{isSubmitted:t}=this.state;if(!t)return r.a.createElement("button",{className:"button button--full-width button--arrow",type:"Submit"},e.fields.submit.label)}renderDisplayedMessage(){var{displayedMessage:e,displayedMessageType:t}=this.state;if(e){var s="landing-form__message";return t&&(s+=" is-".concat(t)),r.a.createElement("div",{className:s},e)}}render(){var{labels:e}=this.props,{comment:t}=this.state;return r.a.createElement("div",null,r.a.createElement("h1",{className:"landing-content__text__title"},e.title),r.a.createElement("p",null,e.intro),this.renderDisplayedMessage(),r.a.createElement("form",{onSubmit:e=>this.handleSubmit(e),className:"landing-form"},r.a.createElement("textarea",{className:"landing-form__textarea",id:"comment",name:"comment",onChange:e=>this.handleTextAreaChange(e),placeholder:e.fields.comment.placeholder,rows:"8",value:t}),this.renderButton()))}}yh.propTypes={token:je.PropTypes.string.isRequired,labels:je.PropTypes.object.isRequired};var fh=yh,Th=r.a.Fragment;class Ph extends r.a.Component{constructor(e){super(e),this.state={activeTabName:this.props.activeTabName},this.itemsCount=this.props.items.length,this.isSingleTab=1===this.itemsCount}componentDidMount(){this.manageHashtagNavigation()}handleItemClick(e){e.preventDefault();var t=d()(e.currentTarget).data("item");t===this.state.activeTabName&&Qe()&&!this.isSingleTab?(window.location.replace("#"),this.setState({activeTabName:""})):(window.location.replace("#".concat(t)),Se.a.pushDynamicEvent("contact-click-tab-".concat(t),window.DP.context.pageType),this.setState({activeTabName:t})),this.manageAriaTags()}manageHashtagNavigation(){var e=window.location.hash.substring(1);e&&(this.setState({activeTabName:e}),this.manageAriaTags())}manageAriaTags(){var e=d()(".".concat("contact-us__tabs_content")),t=d()(".".concat("contact-us__tabs-list__item"));t.find("a").attr("aria-selected","false"),e.attr("aria-hidden","true"),t.removeClass("contact-us__tabs-list__item--active"),e.removeClass("contact-us__tabs_content--active"),setTimeout(()=>{var e=d()(".".concat("contact-us__tabs_content","--").concat(this.state.activeTabName));d()(".".concat("contact-us__tabs-list__item","--").concat(this.state.activeTabName)).addClass("contact-us__tabs-list__item--active").find("a").attr("aria-selected","true"),e.addClass("contact-us__tabs_content--active").attr("aria-hidden","false")})}render(){return r.a.createElement("div",{className:"contact-us__container"},r.a.createElement("ul",{className:"contact-us__tabs-list contact-us__tabs-list--items-count-".concat(this.itemsCount)},this.props.items.map(({name:e,label:t,labelShort:s})=>this.renderTab(e,t,s))))}renderTabsContainer(e){if(e===this.state.activeTabName)return r.a.createElement("li",{className:"contact-us__tabs_container contact-us__tabs_container--mobile"},this.props.items.map(({name:e,subTitle:t,email:s,phoneLabel:a,phoneValue:i,phoneLink:r,openHours:n,subTitleOfferAssist:o,emailOfferAssist:l,phoneLabelOfferAssist:c,phoneValueOfferAssist:p,phoneLinkOfferAssist:d,openHoursOfferAssist:h,faxValue:u,faxValueOfferAssist:m,faxValueLink:g,faxValueLinkOfferAssist:_})=>this.renderTabContent(e,t,s,a,i,r,n,o,l,c,p,d,h,u,m,g,_)))}renderTab(e,t,s){var a=Qe()||this.isSingleTab?s:t,i=He("contact-us__tabs-list__item",{active:e===this.state.activeTabName,single:this.isSingleTab});return r.a.createElement(Th,null,r.a.createElement("li",{key:"contactUsTabs:item:".concat(e),className:"".concat(i," ").concat("contact-us__tabs-list__item","--").concat(e)},r.a.createElement("button",{"aria-selected":"false","aria-labelledby":e,className:"contact-us__tabs-list__item-link","data-item":e,onClick:this.handleItemClick.bind(this),dangerouslySetInnerHTML:{__html:a}})),this.renderTabsContainer(e))}renderFaxNumber(e,t,s){if(void 0!==e)return r.a.createElement("a",{href:t,className:"contact-us__action-link contact-us__action-link--fax gtm__push-event gtm__push-event__contact-link-fax-".concat(s)},r.a.createElement(Ge.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--fax",src:"/build/img/svg/purplebricks/icn-fax.svg",cacheGetRequests:!0}),r.a.createElement("span",null,"".concat(e)))}renderOpenHours(e){var t=[];for(var s of e)t.push(this.renderSingleOpenHour(s));return t}renderSingleOpenHour(e){return r.a.createElement("div",{className:"contact-us__open-hours-single"},r.a.createElement("span",{className:"contact-us__open-hours-days"},e.days)," ",r.a.createElement("span",{className:"contact-us__open-hours-hours"},e.hours))}renderMultiOpenHours(e){return e.map((e,t)=>r.a.createElement("div",{key:t,className:"contact-us__open-multi-hours"},r.a.createElement("h3",{className:"contact-us__open-multi-hours-title"},e.title),this.renderOpenHours(e.hours),void 0!==e.disclaimer&&r.a.createElement("small",{className:"contact-us__open-multi-hours-disclaimer"},e.disclaimer)))}renderTabContentDescription(e,t,s,a,i,n,o,l){return r.a.createElement("div",{className:"contact-us__tabs-list__item__description"},r.a.createElement("a",{href:a,className:"contact-us__action-link gtm__push-event gtm__push-event__contact-link-phone-".concat(l)},r.a.createElement(Ge.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--phone",src:"/build/img/svg/icn-phone.svg",cacheGetRequests:!0}),r.a.createElement("span",null,"".concat(t," ").concat(s))),r.a.createElement("div",{className:"contact-us__open-hours"},void 0===i[0].title?this.renderOpenHours(i):this.renderMultiOpenHours(i)),r.a.createElement("a",{href:"mailto:".concat(e),className:"contact-us__action-link gtm-contact-us-link-email gtm__push-event gtm__push-event__contact-link-email-".concat(l)},r.a.createElement(Ge.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--mail",src:"/build/img/svg/icn-mail.svg",cacheGetRequests:!0}),r.a.createElement("span",{className:"contact-us__action-link-address"},e)),this.renderFaxNumber(n,o,l))}renderTabContentOfferAssistTitle(e){return Qe()?r.a.createElement(Th,null,r.a.createElement("h3",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:e}})):r.a.createElement("h2",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:e}})}renderTabContentOfferAssist(e,t,s,a,i,n,o,l,c,p){if(void 0!==s){var d="".concat(e,"-OA");return r.a.createElement(Th,null,r.a.createElement("div",{key:"contactUsTabs:item-OA:".concat(e),className:"".concat(t," ").concat("contact-us__tabs_content","--").concat(e," ").concat("contact-us__tabs_content","--offer-assist"),"aria-hidden":"false"},this.renderTabContentOfferAssistTitle(s),this.renderTabContentDescription(a,i,n,o,l,c,p,d)))}}renderTabContent(e,t,s,a,i,n,o,l,c,p,d,h,u,m,g,_,b){var v=He("contact-us__tabs_content",{active:e===this.state.activeTabName});return r.a.createElement(Th,null,r.a.createElement("div",{key:"contactUsTabs:item:".concat(e),className:"".concat(v," ").concat("contact-us__tabs_content","--").concat(e),"aria-hidden":"false"},r.a.createElement("h2",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:t}}),this.renderTabContentDescription(s,a,i,n,o,m,_,e)),this.renderTabContentOfferAssist(e,v,l,c,p,d,h,u,g,b))}}Ph.propTypes={activeTabName:je.PropTypes.string.isRequired,items:je.PropTypes.arrayOf(je.PropTypes.shape({name:je.PropTypes.string,label:je.PropTypes.string,labelShort:je.PropTypes.string,subTitle:je.PropTypes.string,email:je.PropTypes.string,phoneLabel:je.PropTypes.string,phoneValue:je.PropTypes.string,phoneLink:je.PropTypes.string,faxValue:je.PropTypes.string,faxValueLink:je.PropTypes.string,openHours:je.PropTypes.array,subTitleOfferAssist:je.PropTypes.string,emailOfferAssist:je.PropTypes.string,phoneLabelOfferAssist:je.PropTypes.string,phoneValueOfferAssist:je.PropTypes.string,phoneLinkOfferAssist:je.PropTypes.string,faxValueLinkOfferAssist:je.PropTypes.string,faxValueOfferAssist:je.PropTypes.string,openHoursOfferAssist:je.PropTypes.array})).isRequired};var wh=Ph,Eh=(e=null,t=!0,s=1)=>{var a=window.DP.store.getState(),i={search:!!t||"",province:e||"",is_for_sale:s,type:a.searchTypes.selected,subtype:a.searchSubTypes.selected,cities:a.searchTerms.filter(e=>"cities"===e.typeOfResource),regions:a.searchTerms.filter(e=>"regions"===e.typeOfResource),rooms:a.searchRooms.selected.match(/[1-9~]+/g)?a.searchRooms.selected:"",min_price:a.searchPriceRange.selected[0]?a.searchPriceRange.selected[0].numericValue:"",max_price:a.searchPriceRange.selected[1]?a.searchPriceRange.selected[1].numericValue:"",parent:1,with_builders:1,with_external_listings:1},r=Object.keys(i),n=r.map(e=>i[e]);return r.map((e,t)=>{var s=n[t];if(s)return Array.isArray(s)?s.map((t,s)=>"".concat(e,"[").concat(s,"]=").concat(t.id?t.id:t)).join("&"):"".concat(e,"=").concat(s)}).filter(Boolean).join("&")};class Ch extends r.a.Component{constructor(e){super(e)}render(){var{labels:e,labelsCommon:t}=this.props,s="".concat(window.DP.urls.search,"?").concat(encodeURI(Eh()));return r.a.createElement("div",{className:"alert-subscription-app__panel"},r.a.createElement("h2",{className:"alert-subscription-app__panel__title"},e.title),r.a.createElement("p",null,e.message),r.a.createElement("div",{className:"alert-subscription-app__row"},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement("a",{href:s,className:"button button--full-width alert-subscription-app__button-submit",onClick:()=>Se.a.pushDynamicEvent("alert-subscription-cta",window.DP.context.pageType)},e.buttons.finish)),r.a.createElement("div",{className:"alert-subscription-app__row__cell"})),r.a.createElement("div",{className:"alert-subscription-app__did-you-know"},r.a.createElement("p",{className:"alert-subscription-app__did-you-know__title"},e.didyouknow.title),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:e.didyouknow.message}}),r.a.createElement("p",null,r.a.createElement("strong",null,e.didyouknow.callus," ",r.a.createElement("a",{href:t.phone.link,onClick:()=>Se.a.pushDynamicEvent("alert-subscription-cta-phone",window.DP.context.pageType)},t.phone.text),"."))))}}Ch.propTypes={labels:je.PropTypes.object.isRequired,labelsCommon:je.PropTypes.object.isRequired};var Sh=Ch;class Rh extends r.a.Component{constructor(e){super(e)}render(){return this.props.currentStep!==this.props.totalSteps&&r.a.createElement("div",{className:"alert-subscription-app__indicator"},this.props.currentStep," / ",this.props.totalSteps-1)}}Rh.propTypes={currentStep:je.PropTypes.number.isRequired,totalSteps:je.PropTypes.number.isRequired};var Nh=Rh;class kh extends r.a.Component{constructor(e){super(e),this.state={displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}isFormValid(){var{searchTerms:e,searchTypes:t}=this.props;return!(0===e.length||0===t.selected.length)}handleNextStep(){Se.a.pushDynamicEvent("alert-subscription-next-success",window.DP.context.pageType),this.props.handleNextStep()}renderForm(){return r.a.createElement("div",null,this.renderTypeField(),this.renderRegionField(),this.renderBedroomsField(),this.renderPriceField(),this.renderSubmitButton())}renderTypeField(){var e=this.props.searchBar.selected,t=this.props.labels.form.fields.type;return r.a.createElement("label",{className:"alert-subscription-app__row"},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},t.label,r.a.createElement("span",{className:"alert-subscription-app__form__required"},"*")),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement(Ts,{selectedAsLabel:!0,extraClasses:"search-types--full",selectedLabel:e})))}renderRegionField(){var e=this.props.labels.form.fields.region;return r.a.createElement("label",{className:"alert-subscription-app__row"},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},e.label,r.a.createElement("span",{className:"alert-subscription-app__form__required"},"*")),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement(zt,{location:"AlertSubscription",nearMeTermLabel:this.props.searchBar.nearMeTermLabel,locale:this.props.searchBar.locale,nearMePush:this.props.searchBarPushEvents.nearMe,locationText:this.props.searchBar.locationText,clearValuesText:this.props.searchBar.clearValuesText,suggestType:"simple",showNearMe:!1,showSearchIcon:!1,showClearValues:!0})))}renderBedroomsField(){var e=this.props.labels.form.fields.bedrooms;return r.a.createElement("label",{className:"alert-subscription-app__row"},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},e.label),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement(Jt,{selectedAsLabel:!0,extraClasses:"search-rooms--full"})))}renderPriceField(){var e=this.props.labels.form.fields.price;return r.a.createElement("label",{className:"alert-subscription-app__row"},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},e.label),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement(ss,{provider:"searchBar",extraClasses:"search-price-range--full"})))}renderSubmitButton(){var e=this.props.labels.form;return r.a.createElement("div",{className:"alert-subscription-app__row alert-subscription-app__row--space-top"},r.a.createElement("div",{className:"alert-subscription-app__row__cell alert-subscription-app__legal",dangerouslySetInnerHTML:{__html:e.legal}}),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement("button",{className:"button button--full-width alert-subscription-app__button-submit",onClick:()=>this.handleNextStep(),disabled:!this.isFormValid()},e.buttons.submit)))}render(){var{labels:e}=this.props;return r.a.createElement("div",{className:"alert-subscription-app__panel"},r.a.createElement("h2",{className:"alert-subscription-app__panel__title"},e.title),this.renderForm())}}kh.propTypes={handleNextStep:je.PropTypes.func.isRequired,labels:je.PropTypes.object.isRequired,searchBar:je.PropTypes.object.isRequired,searchBarPushEvents:je.PropTypes.object.isRequired,searchPriceRange:je.PropTypes.object.isRequired,searchRooms:je.PropTypes.object.isRequired,searchTerms:je.PropTypes.array.isRequired,searchTypes:je.PropTypes.object.isRequired};var Lh=kh=Object(m.b)(({searchBar:e,searchBarPushEvents:t,searchPriceRange:s,searchRooms:a,searchTerms:i,searchTypes:r})=>({searchBar:e,searchBarPushEvents:t,searchPriceRange:s,searchRooms:a,searchTerms:i,searchTypes:r}))(kh);class qh extends r.a.Component{constructor(e){super(e),this.state={nameValue:"",emailValue:"",telephoneValue:"",errorMessage:"",errorField:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}isFormValid(){var{nameValue:e,emailValue:t,telephoneValue:s}=this.state;return!(0===e.length||0===t.length||0===s.length)}handleSubmitForm(e){if(e.preventDefault(),this.isFormValid()){var{nameValue:t,emailValue:s,telephoneValue:a}=this.state,i=Eh(window.DP.province,!1);this.setState({isSubmitting:!0}),qc({nameValue:t,emailValue:s,telephoneValue:a,searchHash:i,details:"Alert Subscription"}).then(()=>{this.setState({errorField:"",errorMessage:"",isSubmitting:!1}),Se.a.pushDynamicEvent("alert-subscription-subscribe","".concat(window.DP.context.pageType,"Page")),this.props.handleNextStep()}).catch(e=>{this.setState({errorField:e.responseJSON.field,errorMessage:e.responseJSON.message,isSubmitting:!1})})}return!1}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleTelephoneValueChange(e){this.setState({telephoneValue:e.target.value})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}renderForm(){return r.a.createElement("form",{className:"alert-subscription-app__form",autoComplete:"off"},this.renderNameField(),this.renderTelephoneField(),this.renderEmailField(),this.renderButtons())}renderNameField(){var e=this.props.labels.form.fields.name;return this.renderField({name:"name",value:this.state.nameValue,label:e.label,placeholder:e.placeholder,required:!0,type:"text",mask:"",changeCallback:this.handleNameValueChange})}renderTelephoneField(){var e=this.props.labels.form.fields.telephone;return this.renderField({name:"telephone",value:this.state.telephoneValue,label:e.label,placeholder:e.placeholder,required:!0,type:"tel",mask:"(999) 999-9999",changeCallback:this.handleTelephoneValueChange})}renderEmailField(){var e=this.props.labels.form.fields.email;return this.renderField({name:"email",value:this.state.emailValue,label:e.label,placeholder:e.placeholder,required:!0,type:"email",mask:"",changeCallback:this.handleEmailValueChange})}renderButtons(){var e=this.props.labels.form;return r.a.createElement("div",{className:"alert-subscription-app__row alert-subscription-app__row--space-top"},r.a.createElement("div",{className:"alert-subscription-app__row__cell alert-subscription-app__legal",dangerouslySetInnerHTML:{__html:e.legal}}),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},this.state.isSubmitting?r.a.createElement("button",{className:"button button--full-width alert-subscription-app__button-submit",disabled:!0},r.a.createElement("div",{className:"button__content"},r.a.createElement(ze,null))):r.a.createElement("button",{type:"button",className:"button button--full-width alert-subscription-app__button-submit",onClick:this.handleSubmitForm.bind(this),disabled:!this.isFormValid()},e.buttons.submit)))}renderField({name:e,value:t,label:s,placeholder:a,required:i,type:n,mask:o,changeCallback:l}){var c=He("alert-subscription-app__row",{invalid:this.state.errorField===e}),p="alert-subscription-app-".concat(e);return r.a.createElement("label",{className:c},r.a.createElement("div",{className:"alert-subscription-app__row__cell"},s,i?r.a.createElement("span",{className:"alert-subscription-app__form__label__required"},"*"):""),r.a.createElement("div",{className:"alert-subscription-app__row__cell"},r.a.createElement(Vo.a,{mask:o,id:p,name:e,value:t,className:"alert-subscription-app__form__input",placeholder:a,type:n,onChange:l.bind(this)})))}renderSelectedCriterionBedrooms(){var{searchRooms:e}=this.props;return parseInt(e.selected,10)>0?r.a.createElement(r.a.Fragment,null," with ",r.a.createElement("strong",null,this.countRooms(e," bedroom"))," "):""}countRooms(e,t){var s=e.options.find(t=>t.value===e.selected).label,a=parseInt(e.selected,10);return a>1&&(s.includes("+")?t+="s or more":t+="s"),1===a&&s.includes("+")&&(t+=" or more"),a+t}renderSelectedCriterionPrice(){var{searchPriceRange:e}=this.props;if(!e.selected[0]&&!e.selected[1])return null;var t,s=0;return e.selected[0]&&e.selected[1]?(t=h.a.encodeCurrencyValue(e.selected[0].value,{noDecimal:!1}),s=h.a.encodeCurrencyValue(e.selected[1].value,{noDecimal:!1}),r.a.createElement(r.a.Fragment,null," in a ",r.a.createElement("strong",null,"".concat(t," - ").concat(s))," price range")):e.selected[0]?(t=h.a.encodeCurrencyValue(e.selected[0].value,{noDecimal:!1}),r.a.createElement(r.a.Fragment,null," with a ",r.a.createElement("strong",null,"minimum price")," of ",r.a.createElement("strong",null,t))):e.selected[1]?(s=h.a.encodeCurrencyValue(e.selected[1].value,{noDecimal:!1}),r.a.createElement(r.a.Fragment,null," with a ",r.a.createElement("strong",null,"maximum price")," of ",r.a.createElement("strong",null,s))):""}renderSelectedCriterionRegion(){var{searchTerms:e}=this.props,t=e.map((function(e){return ya(e.name)})),s=t.length,a=t.join(", ");return s>3&&(a="".concat(t.slice(0,3).join(", ")," (and ").concat(s-3," more)")),r.a.createElement(r.a.Fragment,null," in ",r.a.createElement("strong",null,a))}renderSelectedCriterionType(){var{searchTypes:e}=this.props;if(e.selected.length>0){var t=e.selected.map((function(t){return e.options.find((function(e){return e.id===t})).name}));return r.a.createElement(r.a.Fragment,null," for ",r.a.createElement("strong",null,t.join(", "))," ")}return""}renderSelectedCriteria(){var e=this.props.labels.form.buttons;return r.a.createElement("p",{className:"alert-subscription-app__selected-criteria"},"Send me notifications",this.renderSelectedCriterionType(),this.renderSelectedCriterionBedrooms(),this.renderSelectedCriterionPrice(),this.renderSelectedCriterionRegion(),".",r.a.createElement("button",{className:"alert-subscription-app__button-back",onClick:this.props.handlePreviousStep.bind(this)},r.a.createElement(Ge.a,{className:"alert-subscription-app__button-back__icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0}),e.back))}renderErrorMessage(){var{errorMessage:e}=this.state;return e?r.a.createElement("div",{className:"alert-subscription-app__error-message"},r.a.createElement("p",null,e)):null}render(){var{labels:e}=this.props;return r.a.createElement("div",{className:"alert-subscription-app__panel"},r.a.createElement("h2",{className:"alert-subscription-app__panel__title"},e.title),this.renderSelectedCriteria(),this.renderErrorMessage(),this.renderForm())}}qh.propTypes={handleNextStep:je.PropTypes.func.isRequired,handlePreviousStep:je.PropTypes.func.isRequired,labels:je.PropTypes.object.isRequired,searchPriceRange:je.PropTypes.object.isRequired,searchRooms:je.PropTypes.object.isRequired,searchTerms:je.PropTypes.array.isRequired,searchTypes:je.PropTypes.object.isRequired};var Oh=qh=Object(m.b)(({searchPriceRange:e,searchRooms:t,searchTerms:s,searchTypes:a})=>({searchPriceRange:e,searchRooms:t,searchTerms:s,searchTypes:a}))(qh);class xh extends r.a.Component{constructor(e){super(e),this.state={currentStep:1,totalSteps:3}}nextStep(){this.setState({currentStep:this.state.currentStep+1})}previousStep(){this.setState({currentStep:this.state.currentStep-1})}render(){var{labels:e}=this.props,t={marginLeft:"".concat(-100*(this.state.currentStep-1),"%")};return r.a.createElement("div",{className:"alert-subscription-app"},r.a.createElement("div",{className:"alert-subscription-app__panels",style:t},r.a.createElement(Lh,{handleNextStep:e=>this.nextStep(e),labels:e.panels.search}),r.a.createElement(Oh,{handleNextStep:e=>this.nextStep(e),handlePreviousStep:e=>this.previousStep(e),labels:e.panels.signup}),r.a.createElement(Sh,{labels:e.panels.confirm,labelsCommon:e.common})),r.a.createElement(Nh,{currentStep:this.state.currentStep,totalSteps:this.state.totalSteps}))}}xh.propTypes={labels:je.PropTypes.object.isRequired};var Dh=g.createProviderWrappedComponent(e=>r.a.createElement(xh,e)),Mh=window.DP.context.pageType;class Ah extends r.a.Component{handleSelect(e){if(e.value){var t=this.labelGenerator(e.value);Se.a.pushToDataLayer("gtm-event",Mh,"Click_Category",t),window.location.href="".concat(this.props.baseUrl,"/").concat(e.value)}else d()(".".concat("select-dropdown__arrow")).click()}labelGenerator(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join("")}render(){return r.a.createElement(ar,{dropdownId:"blog-category-dropdown",options:this.props.options,selected:this.props.selected,placeholder:this.props.placeholder,onSelect:this.handleSelect.bind(this)})}}Ah.propTypes={baseUrl:je.PropTypes.string.isRequired,selected:je.PropTypes.string,placeholder:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired};var Ih=Ah,Bh=window.DP.context.pageType;class Fh extends r.a.Component{handleSelect(e){if(e.value){var t=this.provinceSelection(e.value);Se.a.pushToDataLayer("gtm-event",Bh,"Click_Province",t),window.location.href=e.value}}provinceSelection(e){switch(e.slice(-2)){case"mb":e="Manitoba";break;case"ab":e="Alberta";break;case"on":e="Ontario"}return e}render(){return r.a.createElement(ar,{dropdownId:"blog-province-dropdown",options:this.props.options,selected:this.props.selected,placeholder:this.props.placeholder,onSelect:this.handleSelect.bind(this)})}}Fh.propTypes={selected:je.PropTypes.string,placeholder:je.PropTypes.string.isRequired,options:je.PropTypes.arrayOf(je.PropTypes.shape({label:je.PropTypes.string.isRequired,value:je.PropTypes.string.isRequired})).isRequired};var jh=Fh,Vh=s(108),Uh=s.n(Vh),$h=s(4),Gh=s(18),Hh=s.n(Gh),zh=Hh()("style",{default:"#02BBFF"}),Wh=Hh()("style",{default:"#e6fffb"}),Kh=Hh()("style",{default:"#21c1ce"}),Yh=Hh()("style",{default:"#58bf26"}),Xh=Hh()("style",{default:"#E2FBDA"}),Zh=Hh()("style",{default:"#9b9b9b"}),Jh=Hh()("style",{default:"#f8f8f8"}),Qh=Hh()("style",{default:"#333"}),eu=Hh()("style",{default:"#666"}),tu=Hh()("style",{default:"pink"}),su=Hh()("style",{default:"#f00"}),au=s(10),iu=e=>({type:"MODAL_SELECTED_ITEM",selected:e});function ru(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: flex;\n    position: absolute;\n    z-index: 1;\n    flex-direction: column;\n    align-items: center;\n    justify-content: space-around;\n    height: 100%;\n    width: 100%;\n    backface-visibility: hidden;\n    padding: 26px 22px;\n    margin-bottom: 1rem;\n    border-radius: 10px;\n    transition: 1s ease-in-out;\n\n    &.card--blue {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n\n    &.card--green {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n\n    &.card--gray {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n"]);return ru=function(){return e},e}var nu=$h.default.div(ru(),Kh,Wh,Yh,Xh,Zh,Jh),ou=({content:e,classes:t})=>r.a.createElement(nu,{className:t},e);ou.propTypes={classes:je.PropTypes.string,content:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.func,je.PropTypes.object,je.PropTypes.element])};var lu=ou;function cu(){var e=Tu(["\n    position: absolute;\n    top: 16px;\n    right: 8px;\n    background: transparent;\n\n    .flip-card__icon-reload {\n        svg {\n            display: block;\n            width: 15px;\n            height: 17px;\n        }\n    }\n"]);return cu=function(){return e},e}function pu(){var e=Tu(["\n    display: none;\n    font-size: 22px;\n    font-weight: 700;\n    color: ",";\n\n    "," {\n        display: block;\n    }\n\n    .flip-card__face--front & {\n        "," {\n            font-size: 20px;\n        }\n    }\n"]);return pu=function(){return e},e}function du(){var e=Tu(["\n    display: none;\n    margin: 10px 0 0;\n    font-size: 15px;\n    font-weight: 600;\n    color: ",";\n\n    "," {\n        display: block;\n    }\n\n    .flip-card__face--front & {\n        "," {\n            font-size: 13px;\n        }\n    }\n"]);return du=function(){return e},e}function hu(){var e=Tu(["\n    width: 100%;\n    margin: 14px 0 0;\n\n    .select-dropdown {\n        margin: 0;\n    }\n\n    .select-dropdown__label {\n        padding: 14px 11px;\n        font-size: 16px;\n        font-weight: 700;\n        background-color: ",";\n        color: #fff;\n        border: none !important;\n\n        svg,\n        path {\n            fill: #fff;\n        }\n    }\n\n    .select-dropdown__arrow {\n        top: 15px;\n    }\n\n    .select-dropdown__option--selected,\n    .select-dropdown__option:focus,\n    .select-dropdown__option:hover {\n        background-color: ",";\n    }\n\n    .select-dropdown__placeholder {\n        margin: 0 auto;\n    }\n"]);return hu=function(){return e},e}function uu(){var e=Tu(["\n    width: 100%;\n    padding: 14px 0;\n    margin: 14px 0;\n    font-size: 16px;\n    font-weight: 700;\n    background-color: ",";\n    color: #fff;\n    border-radius: 3px;\n    text-decoration: none;\n\n    "," {\n        max-width: 161px;\n        margin-top: 10px;\n\n        .flip-card__face--back & {\n            display: none;\n        }\n    }\n"]);return uu=function(){return e},e}function mu(){var e=Tu(["\n    display: inline-block;\n    align-self: flex-start;\n    padding: 2px 0 10px;\n    font-size: 14px;\n    font-weight: 600;\n    color: ",";\n    text-decoration: none;\n"]);return mu=function(){return e},e}function gu(){var e=Tu(["\n    align-self: stretch;\n    width: 100%;\n\n    &.flip-card__face__text--strike {\n        color: #bebebe;\n        text-decoration: line-through;\n    }\n\n    &.flip-card__face__text--optional::before {\n        font-weight: 700;\n        content: 'Optional: ';\n    }\n\n    :lang(fr).flip-card__face__text--optional::before {\n        content: 'En option : ';\n    }\n"]);return gu=function(){return e},e}function _u(){var e=Tu(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 16px 0;\n    font-size: 14px;\n    font-weight: 600;\n    color: ",";\n\n    strong {\n        font-weight: 800;\n    }\n\n    a {\n        display: flex;\n        align-items: center;\n        width: 100%;\n        text-align: left;\n\n        &:active svg g {\n            stroke: ",";\n        }\n    }\n\n    .flip-card__face--back & {\n        &:last-child {\n            margin-top: 24px;\n            padding-top: 20px;\n            border-top: 1px solid #000;\n        }\n\n        margin: 17px 0;\n    }\n"]);return _u=function(){return e},e}function bu(){var e=Tu(["\n    width: 100%;\n"]);return bu=function(){return e},e}function vu(){var e=Tu(["\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 100%;\n\n    .flip-card__face--front & {\n        "," {\n            width: calc(40% - 20px);\n\n            &.flip-card__column--list {\n                flex: 1 1 100%;\n                order: 1;\n                justify-content: center;\n                width: calc(60% - 20px);\n                padding-left: 38px;\n                margin-left: 20px;\n\n                .card--blue & {\n                    border-left: 1px solid ",";\n                }\n\n                .card--green & {\n                    border-left: 1px solid ",";\n                }\n\n                .card--gray & {\n                    border-left: 1px solid ",";\n                }\n            }\n        }\n    }\n\n    .flip-card__face--back & {\n        "," {\n            flex-direction: row;\n            justify-content: center;\n\n            h3 {\n                display: inline-block;\n                margin: 0 0 0 5px !important;\n                text-transform: lowercase;\n            }\n        }\n    }\n\n    .flip-card__icon-more {\n        margin-top: 4px;\n\n        svg {\n            display: block;\n            width: 11px;\n            height: 11px;\n        }\n    }\n\n    .flip-card__icon-arrow-right {\n        margin: 0 0 0 5px;\n\n        svg {\n            display: inline-block;\n            width: 5px;\n            height: 9px;\n            fill: ",";\n        }\n    }\n\n    h2 {\n        font-size: 20px;\n        font-weight: 700;\n        line-height: 0.8;\n\n        .card--blue & {\n            color: ",";\n        }\n\n        .card--green & {\n            color: ",";\n        }\n\n        .card--gray {\n            color: ",";\n        }\n    }\n\n    h3 {\n        margin-bottom: 2px;\n        font-size: 20px;\n        font-weight: 600;\n        color: ",";\n        line-height: 1.5;\n    }\n"]);return vu=function(){return e},e}function yu(){var e=Tu(["\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 100%;\n\n    "," {\n        width: calc(40% - 20px);\n    }\n\n    h2 {\n        font-size: 20px;\n        font-weight: 700;\n        line-height: 0.8;\n\n        .card--blue & {\n            color: ",";\n        }\n\n        .card--green & {\n            color: ",";\n        }\n\n        .card--gray & {\n            color: ",";\n        }\n    }\n\n    h3 {\n        font-size: 40px;\n        font-weight: 600;\n        color: ",";\n\n        sup {\n            bottom: 0.9ex;\n            font-size: 60%;\n        }\n    }\n"]);return yu=function(){return e},e}function fu(){var e=Tu(["\n    position: relative;\n    height: 464px;\n\n    "," {\n        height: 345px;\n    }\n\n    "," {\n        height: 494px;\n    }\n\n    .flip-card__face--front {\n        transform: perspective(1200px) rotateY(0deg);\n\n        "," {\n            flex-wrap: wrap;\n            justify-content: center;\n            transform: perspective(1200px) rotateX(0deg);\n        }\n    }\n\n    .flip-card__face--back {\n        border: 1px solid ",";\n        border-top: none;\n        background-color: #fff;\n        transform: perspective(1200px) rotateY(180deg);\n\n        "," {\n            transform: perspective(1200px) rotateX(180deg);\n        }\n\n        .select-dropdown {\n            margin-bottom: 4px;\n        }\n    }\n\n    &.flip-card--flipped {\n        .flip-card__face--front {\n            transform: perspective(1200px) rotateY(-179.9deg);\n\n            "," {\n                transform: perspective(1200px) rotateX(-179.9deg);\n            }\n        }\n\n        .flip-card__face--back {\n            transform: perspective(1200px) rotateY(0);\n\n            "," {\n                transform: perspective(1200px) rotateX(0);\n            }\n        }\n    }\n"]);return fu=function(){return e},e}function Tu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Pu="@media (min-width: 580px) and (max-width: 936px)",wu=$h.default.div(fu(),"@media (max-width: 937px)","@media (max-width: 579px)",Pu,eu,Pu,Pu,Pu),Eu=$h.default.div(yu(),Pu,Kh,Yh,eu,Qh),Cu=$h.default.div(vu(),Pu,Kh,Yh,Zh,Pu,zh,Kh,Yh,eu,Qh),Su=$h.default.ul(bu()),Ru=$h.default.li(_u(),Qh,zh),Nu=$h.default.span(gu()),ku=$h.default.a(mu(),zh),Lu=$h.default.a(uu(),zh,Pu),qu=$h.default.div(hu(),zh,zh),Ou=$h.default.p(du(),Qh,"@media (max-width: 937px)",Pu),xu=$h.default.a(pu(),Qh,"@media (max-width: 937px)",Pu),Du=$h.default.button(cu()),Mu=({pricing:e})=>{var{back:t,cityId:s,packageCode:a,packageColor:n,common:o,front:l,packageId:c,packageName:p,packageType:d}=e,[h,u]=Object(i.useState)(!1),[m]=Object(au.d)("packages"),g=[{label:m("subTypes.res"),value:"RES"},{label:m("subTypes.comm"),value:"COMM"},{label:m("subTypes.mult"),value:"MULT"}],_=(e,t)=>{e.preventDefault(),u(!h),t&&Se.a.pushDynamicEvent("pricing-slide-".concat(c,"-include-click"),window.DP.context.pageType)},b=()=>{window.scrollTo({behavior:"smooth",left:0,top:document.getElementById("packagesCallUs").offsetTop-50})},v=()=>{Fe()&&b(),y()},y=()=>{Se.a.pushDynamicEvent("pricing-slide-".concat(c,"-cta-click"),window.DP.context.pageType)},f=(e,t)=>{var s=He("flip-card__face__text",{strike:"no"===e.status||!1===e.status||"0"===e.status,optional:"optional"===e.status});return r.a.createElement("a",{onClick:s=>((e,t,s)=>{e.preventDefault(),window.DP.store.dispatch({type:"SHOW_MODAL"}),window.DP.store.dispatch(iu(t)),Se.a.pushDynamicEvent("pricing-slide-".concat(c,"-item-").concat(s,"-click"),window.DP.context.pageType)})(s,e,t)},r.a.createElement(Nu,{className:s,dangerouslySetInnerHTML:{__html:e.list}}),r.a.createElement(Ge.a,{className:"flip-card__icon-more",src:"/build/img/svg/icn-more.svg",cacheGetRequests:!0}))},T=(e,t)=>Object.entries(e).map(([e,s])=>r.a.createElement(Ru,{key:e},f(s,t))),P=e=>{if(!window.DP.configSwitch.NewPackagesPage)return"#";var t="",i="",r=Oc()?"":"&city=".concat(s),n="&package=".concat(a.match(/\d+/g)),o="&prov=".concat(window.DP.province),l="&type=".concat("RES"===d?e:d);return"fr"===window.DP.lang?(i="/vendre/adhesion/",t=Oc()?"compte?client-existant":"compte?nouveau-client"):(i="/sell/subscription/",t=Oc()?"account?client-exist":"account?new-user"),Fe()?"#":"".concat(i).concat(t).concat(o).concat(n).concat(r).concat(l)},w=()=>"RES"===d?r.a.createElement(qu,null,r.a.createElement(ar,{onSelect:E.bind(void 0),dropdownId:"res-type-dropdown",options:g,placeholder:o.button})):r.a.createElement(Lu,{href:P(),className:"js-noPopup",onClick:v},o.button),E=e=>{Fe()?(b(),window.Dropdown("hide")):window.location.href=P(e.value),y()},C=r.a.createElement(r.a.Fragment,null,r.a.createElement(Eu,null,r.a.createElement("h2",null,p),r.a.createElement("h3",{dangerouslySetInnerHTML:{__html:l.price}})),r.a.createElement(Cu,{className:"flip-card__column--list"},r.a.createElement(Su,null,T(l.items,"front")),void 0!==t&&r.a.createElement(ku,{href:"#",onClick:e=>_(e,!0)},o.include,r.a.createElement(Ge.a,{className:"flip-card__icon-arrow-right",src:"/build/img/svg/icn-arrow-full-right.svg",cacheGetRequests:!0}))),r.a.createElement(Cu,null,w(),r.a.createElement(Ou,null,o.more),r.a.createElement(xu,{href:"tel:".concat(o.phone),onClick:()=>{Se.a.pushDynamicEvent("pricing-slide-".concat(c,"-phone-click"),window.DP.context.pageType)}},o.phone))),S=He("flip-card",{flipped:h}),R=He("card",{blue:"blue"===n,green:"green"===n,gray:"gray"===n});return r.a.createElement(wu,{className:S},r.a.createElement(lu,{classes:"flip-card__face flip-card__face--front ".concat(R),content:C}),void 0===t?r.a.createElement("div",null," "):r.a.createElement(lu,{classes:"flip-card__face flip-card__face--back ".concat(R),content:void 0===t?r.a.createElement("div",null," "):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(Du,{onClick:e=>_(e,!1)},r.a.createElement(Ge.a,{className:"flip-card__icon-reload",src:"/build/img/svg/icn-reload.svg",cacheGetRequests:!0}))),r.a.createElement(Cu,null,r.a.createElement("h2",null,p),r.a.createElement("h3",null,t.include)),r.a.createElement(Cu,null,r.a.createElement(Su,null,T(t.items,"back")),w()))}))};Mu.propTypes={pricing:je.PropTypes.object.isRequired};var Au=Mu;function Iu(){var e=$u(["\n    width: 100%;\n    margin-top: 30px;\n    font-size: 10px;\n    text-align: center;\n"]);return Iu=function(){return e},e}function Bu(){var e=$u(["\n    position: absolute;\n    top: 15px;\n    right: 15px;\n    cursor: pointer;\n\n    .pricing-modal__close-button-icon {\n        display: block;\n\n        svg {\n            width: 20px;\n            height: 20px;\n            transition: fill 0.2s ease;\n            fill: #b9b9b9;\n        }\n\n        svg:focus,\n        svg:hover {\n            fill: #58bf26;\n        }\n\n        svg:active {\n            fill: #369600;\n        }\n    }\n"]);return Bu=function(){return e},e}function Fu(){var e=$u(["\n    width: 100%;\n    font-size: 14px;\n    color: #333;\n    text-align: center;\n\n    .pricing-modal__description--italic {\n        font-style: italic;\n    }\n"]);return Fu=function(){return e},e}function ju(){var e=$u(["\n    display: block;\n    margin-bottom: 15px;\n    width: 100%;\n    font-size: 20px;\n    font-weight: 600;\n    color: #333;\n    text-align: center;\n"]);return ju=function(){return e},e}function Vu(){var e=$u(["\n    position: fixed;\n    display: flex;\n    z-index: 10000;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 50px;\n    width: 600px;\n    height: 400px;\n    margin: auto;\n    background: #fff;\n    transition: all 0.4s ease;\n    touch-action: pan-y;\n\n    @media (min-width: 769px) {\n        &.pricing-modal--visible {\n            display: flex;\n            top: 0;\n            animation: fadeInAnimation ease 300ms;\n        }\n\n        &.pricing-modal--hidden {\n            display: none;\n        }\n    }\n\n    @keyframes fadeInAnimation {\n        0% {\n            opacity: 0;\n        }\n\n        100% {\n            opacity: 1;\n        }\n    }\n\n    @media (max-width: 768px) {\n        width: 100%;\n        height: 100%;\n\n        &.pricing-modal--visible {\n            top: 0;\n            transform: translate(0, 0);\n        }\n\n        &.pricing-modal--hidden {\n            transform: translate(0, 100%);\n        }\n    }\n"]);return Vu=function(){return e},e}function Uu(){var e=$u(["\n    display: none;\n    position: fixed;\n    z-index: 10000;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.75);\n\n    &.overlay-modal--visible {\n        display: block;\n\n        @media (max-width: 768px) {\n            display: none;\n        }\n    }\n"]);return Uu=function(){return e},e}function $u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Gu=$h.default.div(Uu()),Hu=$h.default.div(Vu()),zu=$h.default.h2(ju()),Wu=$h.default.p(Fu()),Ku=$h.default.a(Bu()),Yu=$h.default.small(Iu());class Xu extends r.a.Component{constructor(e){super(e),this.state={yAxisDown:0,yAxisUp:0}}componentDidMount(){this.$html=d()("html")}componentDidUpdate(){this.props.modalVisible?this.$html.css("overflow","hidden"):this.$html.css("overflow","auto")}handleTouchMove(e){this.setState({yAxisUp:Math.floor(e.changedTouches[0].pageY)});var t=this.state.yAxisUp-this.state.yAxisDown-30,s=t>0?t:0;e.currentTarget.style.transform="translate(0, ".concat(s,"px)")}handleTouchStart(e){this.setState({yAxisDown:Math.floor(e.changedTouches[0].pageY)})}handleTouchEnd(e){this.state.yAxisUp>=this.state.yAxisDown+30?(this.hideModal(),e.currentTarget.style.removeProperty("transform")):e.currentTarget.style.transform="translate(0, 0)"}handleCloseButton(e){e.preventDefault(),this.hideModal(),e.currentTarget.parentElement.style.removeProperty("transform")}hideModal(){window.DP.store.dispatch({type:"HIDE_MODAL"}),window.DP.store.dispatch(iu(null))}renderTitle(){var e=this.props.modalContent?this.props.modalContent.modal.title:"";return r.a.createElement(zu,null,e)}renderDescription(){var e=this.props.modalContent?this.props.modalContent.modal.description:"";return r.a.createElement(Wu,{dangerouslySetInnerHTML:{__html:e}})}renderCloseButton(){return r.a.createElement(Ku,{href:"#",onClick:this.handleCloseButton.bind(this)},r.a.createElement(Ge.a,{className:"pricing-modal__close-button-icon",src:"/build/img/svg/icn-close-thin.svg",cacheGetRequests:!0}))}renderDisclaimer(){if(this.props.modalContent){var e=this.props.modalContent.modal.disclaimer;return e&&r.a.createElement(Yu,null,e)}}render(){var e=He("pricing-modal",{visible:this.props.modalVisible,hidden:!this.props.modalVisible}),t=He("overlay-modal",{visible:this.props.modalVisible});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Gu,{className:"".concat(t),onClick:this.handleCloseButton.bind(this)}),r.a.createElement(Hu,{className:"".concat(e),onTouchMove:this.handleTouchMove.bind(this),onTouchStart:this.handleTouchStart.bind(this),onTouchEnd:this.handleTouchEnd.bind(this)},this.renderCloseButton(),this.renderTitle(),this.renderDescription(),this.renderDisclaimer()))}}Xu.propTypes={modalContent:je.PropTypes.object,modalVisible:je.PropTypes.bool};var Zu=Xu;function Ju(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin: 0;\n    padding: 0.4rem 0.8rem;\n    width: 100%;\n    background-color: #fff;\n    color: #333;\n    font-size: 0.9rem;\n    font-weight: 700;\n    border: 1px solid #333;\n    border-radius: 7px;\n    cursor: pointer;\n    text-align: left;\n    line-height: 1.1em;\n    white-space: pre-line;\n\n    &:hover,\n    &.selected {\n        border: 2px solid #58bf26;\n        background-color: #e7fbe0;\n    }\n"]);return Ju=function(){return e},e}var Qu=$h.default.button(Ju()),em=({selected:e=!1,handleOnClick:t,children:s})=>r.a.createElement(Qu,{className:"".concat(e?"selected":""),selected:!!e,onClick:e=>{t(e)}},s);em.propTypes={selected:je.PropTypes.bool,handleOnClick:je.PropTypes.func.isRequired,children:je.PropTypes.oneOfType([je.PropTypes.string,je.PropTypes.array,je.PropTypes.object]).isRequired};var tm=em,sm=()=>r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 69.681 50.649"},r.a.createElement("path",{"data-name":"Path 2716",d:"M39.722 15.547h4.172L25.441.304a1.329 1.329 0 0 0-1.692 0L0 19.928l1.692 2.046 22.9-18.923zm-2.814 3.32v2.656h32.774v-2.656zm28.947 5.976H63.2v23.15h-8.466V30.672a1.327 1.327 0 0 0-1.328-1.328h-15.07a1.327 1.327 0 0 0-1.328 1.328v17.322h-6.115V36.671a1.327 1.327 0 0 0-1.328-1.328h-9.948a1.328 1.328 0 0 0-1.328 1.328v11.323H9.823V19.562l-2.656 2.195v26.237H2.878v2.653h66.8v-2.656h-3.827zm-37.618 23.15h-7.292v-9.995h7.292zm23.841 0H39.663v-3.924h12.414zm0-6.579H39.663v-3.38h12.414zm0-6.036H39.663v-3.379h12.414zM19.616 18.867a1.328 1.328 0 0 0-1.328 1.328v6.687a1.327 1.327 0 0 0 1.328 1.328h10.1a1.327 1.327 0 0 0 1.328-1.328v-6.687a1.328 1.328 0 0 0-1.328-1.328zm8.768 6.687h-7.44v-4.031h7.44z"})),am=()=>r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 56.674 53.035"},r.a.createElement("path",{"data-name":"Path 2717",d:"M14.355 18.534a45.248 45.248 0 0 0 27.968 0 1.273 1.273 0 0 0 .879-1.211v-3.991a1.273 1.273 0 0 0-1.096-1.26l-1.173-.168a12.693 12.693 0 0 0-8.566-10.316A3.019 3.019 0 0 0 29.704 0h-2.733a3.018 3.018 0 0 0-2.664 1.59 12.7 12.7 0 0 0-8.565 10.319l-1.173.168a1.273 1.273 0 0 0-1.094 1.26v3.991a1.272 1.272 0 0 0 .88 1.206zm1.666-4.1l1.072-.153a1.275 1.275 0 0 0 1.093-1.191 10.145 10.145 0 0 1 5.816-8.64v8.359h2.546V2.825a.48.48 0 0 1 .429-.279h2.729a.48.48 0 0 1 .429.279h-.006v9.984h2.546V4.453a10.148 10.148 0 0 1 5.817 8.64 1.274 1.274 0 0 0 1.093 1.191l1.07.153v1.95a42.882 42.882 0 0 1-24.634 0zM54.296 42.19a237.473 237.473 0 0 0-10.454-3.161c-5.82-1.881-6.93-5.017-7.139-6.247a11.938 11.938 0 0 0 2.687-5.55c1.908-.487 2.4-3.268 2.573-4.24a11.461 11.461 0 0 0 .162-1.41c-.872.261-1.748.5-2.63.714-.013.084-.023.161-.038.252a4.861 4.861 0 0 1-.734 2.2h-.027a1.923 1.923 0 0 0-.375-.02h-.007a1.273 1.273 0 0 0-1.26 1.094 9.676 9.676 0 0 1-2.559 5.582l-.02.023a8.279 8.279 0 0 1-6.162 2.063 8.2 8.2 0 0 1-6.106-2.056c-.008-.008-.014-.018-.023-.028a9.673 9.673 0 0 1-2.561-5.585 1.306 1.306 0 0 0-1.193-1.086 1.672 1.672 0 0 0-.448.013h-.025a4.841 4.841 0 0 1-.734-2.2c-.015-.09-.025-.168-.039-.252a47.765 47.765 0 0 1-2.63-.714 11.775 11.775 0 0 0 .163 1.41c.172.972.663 3.751 2.57 4.239a11.965 11.965 0 0 0 2.688 5.552c-.21 1.231-1.318 4.364-7.087 6.23A240.168 240.168 0 0 0 2.382 42.19a3.561 3.561 0 0 0-2.346 3.8l.966 7.038H3.57l-1.014-7.4a1.029 1.029 0 0 1 .629-1.027c.048-.015 4.833-1.6 10.433-3.153a22.014 22.014 0 0 0 1.821-.684l5.562 5.268a1.272 1.272 0 0 0 .876.349h.069a1.275 1.275 0 0 0 .9-.449l.575-.677 1.238 1.15-1.376 6.624h2.6l1.414-6.808a1.272 1.272 0 0 0-.379-1.191l-1.85-1.719 2.111-2.494c.252.01.5.03.758.03h.375c.4.006.793-.008 1.181-.027l2.112 2.494-1.852 1.721a1.272 1.272 0 0 0-.379 1.191l1.414 6.808h2.6l-1.377-6.624 1.239-1.152.575.679a1.278 1.278 0 0 0 .9.449h.069a1.269 1.269 0 0 0 .876-.349l5.565-5.272c.577.248 1.2.486 1.87.7 5.548 1.533 10.334 3.122 10.381 3.137a1.03 1.03 0 0 1 .627 1.042l-.984 7.384h2.542l.963-7.022a3.563 3.563 0 0 0-2.338-3.812zm-32.52 1.072l-3.954-3.746a12.842 12.842 0 0 0 1.683-1.277 12.075 12.075 0 0 0 4.675 2.184zm6.537-4.964a11.185 11.185 0 0 1-7.132-1.99 8.817 8.817 0 0 0 .918-1.773 11.274 11.274 0 0 0 5.916 1.5h.3a11.559 11.559 0 0 0 6.266-1.5 8.839 8.839 0 0 0 .918 1.77 11.3 11.3 0 0 1-7.187 1.997zm6.589 4.964l-2.407-2.843a12.054 12.054 0 0 0 4.681-2.184 12.875 12.875 0 0 0 1.686 1.276z"})),im=()=>r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64.371 48.603"},r.a.createElement("path",{"data-name":"Path 2718",d:"M13.632 30.25a8.542 8.542 0 0 0 3.559 1.334 1.284 1.284 0 1 0 .339-2.545 6 6 0 0 1-3.485-1.754 1.284 1.284 0 0 0-2.154.551 4.75 4.75 0 1 1-6.09-5.786 1.283 1.283 0 0 0 .781-1.693A8.841 8.841 0 0 1 20.051 9.963a1.284 1.284 0 1 0 1.532-2.057 11.309 11.309 0 0 0-6.79-2.242 11.427 11.427 0 0 0-11.41 11.415 11.305 11.305 0 0 0 .422 3.062 7.318 7.318 0 1 0 9.832 10.114zm45.927-12.668a8.442 8.442 0 0 0 1.417-4.709 8.565 8.565 0 0 0-8.556-8.555 8.469 8.469 0 0 0-3.827.909 13.719 13.719 0 0 0-23.928 12.4 8.7 8.7 0 1 0 11.627 11.858 10.2 10.2 0 0 0 11.73 0 8.695 8.695 0 1 0 11.537-11.9zm-3.885 13.91a6.148 6.148 0 0 1-5.9-4.476 1.284 1.284 0 0 0-2.156-.55 7.626 7.626 0 0 1-10.928 0 1.285 1.285 0 0 0-2.156.551 6.126 6.126 0 1 1-7.853-7.461 1.283 1.283 0 0 0 .781-1.694 11.151 11.151 0 0 1 19.7-10.226 1.284 1.284 0 0 0 1.814.347 5.979 5.979 0 0 1 7.542 9.242 1.284 1.284 0 0 0 .582 2.183 6.127 6.127 0 0 1-1.429 12.085zm-9.969 6.906l3.133-2.032a1.284 1.284 0 0 0-1.4-2.154l-3.755 2.438a1.284 1.284 0 0 0-.584 1.143l.425 8.238h-2.741l.426-8.238a1.284 1.284 0 0 0-.584-1.143l-3.755-2.437a1.284 1.284 0 0 0-1.4 2.154l3.133 2.032-.393 7.632H22.266l-.395-7.632 1.46-.946a1.284 1.284 0 0 0-1.4-2.154L19.85 36.65a1.281 1.281 0 0 0-.584 1.143l.425 8.238h-2.738l.426-8.238a1.284 1.284 0 0 0-.584-1.143l-2.95-1.914a1.284 1.284 0 1 0-1.4 2.153l2.328 1.511-.395 7.632h-3.93V48.6h39.584v-2.568h-3.941z"}));function rm(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: inline-block;\n    padding: ",";\n\n    & svg {\n        width: ",";\n        height: ",";\n        transition: width 0.2s ease, height 0.2s ease, transform 0.5s ease;\n        fill: ",";\n        transform: rotate(","deg);\n\n        &.opened {\n            transform: rotate(180deg);\n        }\n    }\n"]);return rm=function(){return e},e}var nm=$h.default.span(rm(),e=>e.padding,e=>e.dimension,e=>e.dimension,e=>e.color||"#58bf26",e=>e.rotation||"0"),om=({name:e,clsName:t})=>{var s={residential:r.a.createElement(sm,{clsName:t}),newhomes:r.a.createElement(am,{clsName:t}),land:r.a.createElement(im,{clsName:t})}[e];return s&&s||r.a.createElement(sm,null)},lm=({clsName:e,color:t,dimension:s,name:a,padding:i,rotation:n})=>r.a.createElement(nm,{className:e,color:t,dimension:s,padding:i,rotation:n},r.a.createElement(om,{name:a,clsName:e}));lm.defaultProps={clsName:"",color:"",dimension:"22px",padding:"0",rotation:""},lm.propTypes={clsName:je.PropTypes.string,color:je.PropTypes.string,dimension:je.PropTypes.string,name:je.PropTypes.string.isRequired,padding:je.PropTypes.string,rotation:je.PropTypes.string};var cm=lm;function pm(){var e=hm(["\n    display: none;\n    margin: 1rem auto;\n    width: 50%;\n    min-width: 264px;\n\n    .select-dropdown__label {\n        justify-content: center;\n        border: 1px solid #333 !important;\n        border-radius: 0;\n        font-size: 0.8rem;\n        font-weight: 700;\n        color: #333;\n    }\n\n    @media (max-width: 768px) {\n        display: block;\n    }\n"]);return pm=function(){return e},e}function dm(){var e=hm(["\n    display: flex;\n    align-items: center;\n    width: 936px;\n    margin: 2rem auto;\n\n    @media (max-width: 936px) {\n        width: auto;\n        margin: 2rem 50px;\n    }\n\n    @media (max-width: 768px) {\n        display: none;\n    }\n\n    li {\n        flex: 1 0 33%;\n        padding: 0 0.5rem;\n    }\n"]);return dm=function(){return e},e}function hm(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var um=$h.default.ul(dm()),mm=$h.default.div(pm()),gm=({selectedType:e,handleOnClick:t})=>{if(!window.DP.configSwitch.NewPackagesPage)return null;var[s]=Object(au.d)("packages"),a=[{label:s("types.residential"),value:"RES"},{label:s("types.newHomes"),value:"CONS"},{label:s("types.land"),value:"TERR"}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(um,null,r.a.createElement("li",null,r.a.createElement(tm,{handleOnClick:()=>t("RES"),selected:"RES"===e},r.a.createElement(cm,{clsName:"",name:"residential",color:"#333",dimension:"39px",padding:"0 1.3rem 0 0"}),s("types.residential"))),r.a.createElement("li",null,r.a.createElement(tm,{handleOnClick:()=>t("CONS"),selected:"CONS"===e},r.a.createElement(cm,{clsName:"",name:"newhomes",color:"#333",dimension:"39px",padding:"0 1.3rem 0 0"}),s("types.newHomes"))),r.a.createElement("li",null,r.a.createElement(tm,{handleOnClick:()=>t("TERR"),selected:"TERR"===e},r.a.createElement(cm,{clsName:"",name:"land",color:"#333",dimension:"39px",padding:"0 1.3rem 0 0"}),s("types.land")))),r.a.createElement(mm,null,r.a.createElement(ar,{dropdownId:"property-type-dropdown",options:a,selected:e,onSelect:(e=>{t(e.value),window.Dropdown("hide")}).bind(void 0)})))};gm.propTypes={selectedType:je.PropTypes.string.isRequired,handleOnClick:je.PropTypes.func.isRequired};var _m=gm;function bm(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    font-size: 1.25rem;\n    font-weight: 700;\n    text-align: center;\n\n    sup {\n        font-weight: 600;\n        font-size: 0.7rem;\n    }\n\n    @media (max-width: 768px) {\n        display: none;\n    }\n"]);return bm=function(){return e},e}var vm=$h.default.h2(bm()),ym=({selectedType:e})=>{if(!window.DP.configSwitch.NewPackagesPage)return null;var[t]=Object(au.d)("packages"),s=t("subTitle.residential");switch(e){case"CONS":s=t("subTitle.newHomes");break;case"TERR":s=t("subTitle.land")}return r.a.createElement(vm,{dangerouslySetInnerHTML:{__html:s}})};ym.propTypes={selectedType:je.PropTypes.string.isRequired};var fm=ym,Tm=s(3);function Pm(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    span {\n        display: inline-block;\n        height: 10px;\n        width: 10px;\n        margin: 0 3px;\n        background-color: ",";\n        border-radius: 0.5rem;\n        animation: loading-dots-keyframes 1.5s infinite ease-in-out;\n\n        &:nth-child(2) {\n            background-color: ",";\n            animation-delay: 0.5s;\n        }\n\n        &:nth-child(3) {\n            background-color: ",";\n            animation-delay: 1s;\n        }\n    }\n\n    @keyframes loading-dots-keyframes {\n        0% {\n            transform: scale(1);\n            opacity: 0.4;\n        }\n\n        50% {\n            transform: scale(1.2);\n            opacity: 1;\n        }\n\n        100% {\n            transform: scale(1);\n            opacity: 0.4;\n        }\n    }\n"]);return Pm=function(){return e},e}var wm=$h.default.div(Pm(),e=>e.primaryColor||Tm.l,e=>e.secondaryColor||Tm.l,e=>e.ternaryColor||Tm.l),Em=({className:e,styleName:t})=>r.a.createElement($h.ThemeProvider,{theme:{style:t}},r.a.createElement(wm,{className:e},r.a.createElement("span",null," "),r.a.createElement("span",null," "),r.a.createElement("span",null," ")));Em.defaultProps={className:"",primaryColor:"",secondaryColor:"",styleName:"default",ternaryColor:""},Em.propTypes={className:je.PropTypes.string,primaryColor:je.PropTypes.string,secondaryColor:je.PropTypes.string,styleName:je.PropTypes.string,ternaryColor:je.PropTypes.string};var Cm=Em,Sm=e=>new Promise((t,s)=>{var a="".concat(window.DP.urls.proxyPackages);d.a.ajax({url:a,data:e}).done(e=>{e||s(),t(e)}).fail(s)}),Rm=s(75);function Nm(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function km(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Lm=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Nm(Object(s),!0).forEach((function(t){km(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Nm(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},s(243));function qm(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function Om(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var xm=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?qm(Object(s),!0).forEach((function(t){Om(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qm(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},s(244));Rm.a.use(au.c).init({fallbackLng:"en",debug:!0,react:{wait:!0},resources:{fr:Lm,en:xm},interpolation:{escapeValue:!1}});var Dm=Rm.a;function Mm(){return(Mm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}function Am(){var e=Fm(["\n    display: block;\n    width: 70%;\n    max-width: 600px;\n    margin: 20px auto;\n    padding: 10px;\n    color: ",";\n    font-size: 0.9rem;\n    border: 1px solid ",";\n    background-color: ",";\n\n    @media only screen and (max-width: 1020px) {\n        // margin: 0;\n    }\n"]);return Am=function(){return e},e}function Im(){var e=Fm(["\n    max-width: 936px;\n    margin: 0 auto;\n\n    .slick-slider {\n        display: flex;\n        flex-direction: column-reverse;\n\n        .slick-track {\n            margin: 35px auto 25px;\n        }\n\n        .slick-slide {\n            padding: 0 8px;\n            touch-action: pan-y;\n\n            div {\n                outline: none;\n            }\n        }\n    }\n\n    .pricing-carrousel__dots {\n        display: flex !important;\n        justify-content: center;\n        margin: 0 0 -15px;\n\n        .slick-active button {\n            background: ",";\n        }\n\n        button {\n            width: 7px;\n            height: 7px;\n            margin: 0 7px 0 0;\n            padding: 0;\n            background: rgba(102, 102, 102, 0.3);\n            border-radius: 50%;\n            font-size: 0;\n            outline: none;\n            transition: background 0.1s ease;\n        }\n    }\n"]);return Im=function(){return e},e}function Bm(){var e=Fm(["\n    margin: 20px 0;\n\n    @media only screen and (max-width: 1020px) {\n        margin: 0;\n    }\n"]);return Bm=function(){return e},e}function Fm(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var jm={infinite:!1,arrows:!1,dots:!1,swipeToSlide:!1,focusOnSelect:!0,centerMode:!0,speed:200,slidesToShow:3,centerPadding:"0",dotsClass:"pricing-carrousel__dots",responsive:[{breakpoint:936,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"50px"}},{breakpoint:375,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"35px"}},{breakpoint:320,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"20px"}}]},Vm=$h.default.div(Bm()),Um=$h.default.div(Im(),eu),$m=$h.default.span(Am(),su,su,tu),Gm=document.getElementsByTagName("html")[0].getAttribute("lang")||"fr";Dm.changeLanguage(Gm);class Hm extends r.a.Component{constructor(e){super(e);var t=window.DP.isNewHomes?"CONS":"RES";this.state={packages:[],prestigeShown:!1,premiumShown:!1,classicShown:!1,selectedType:t,loading:!0,hasFailed:!1},this.slideVisibility=this.slideVisibility.bind(this),this.handleTypeSelectionClick=this.handleTypeSelectionClick.bind(this)}fetchPackages(e){this.setState({loaded:!1}),Sm({group:e}).then(e=>{this.setState({loading:!1}),this.setState({packages:e})}).catch(()=>{this.setState({loading:!1,hasFailed:!0})})}componentDidMount(){this.fetchPackages(this.state.selectedType)}componentDidUpdate(e,t,s){var{loading:a}=this.state;a||a===t.loading||(this.$prestige=document.querySelector(".".concat("js-slide-1")),this.$premium=document.querySelector(".".concat("js-slide-2")),this.$classic=document.querySelector(".".concat("js-slide-3")),document.addEventListener("DOMContentLoaded",()=>{window.$window.on("scroll.".concat("js-slide-1"),this.slideVisibility),this.slideVisibility()}))}slideVisibility(){this.isVisible(this.$prestige)&&!this.state.prestigeShown&&(this.handleGtmSlideView("LaTotale"),this.setState({prestigeShown:!0}),window.$window.off("scroll.".concat("js-slide-1"))),this.isVisible(this.$premium)&&!this.state.premiumShown&&(this.handleGtmSlideView("LeGrosForfait"),this.setState({premiumShown:!0})),this.isVisible(this.$classic)&&!this.state.classicShown&&(this.handleGtmSlideView("LeDeBase"),this.setState({classicShown:!0}))}handleGtmSlideView(e){Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"View_Package",e)}handleGtmMenuClick(e){Se.a.pushDynamicEvent("pricing-menu-".concat(e.toLowerCase(),"-click"),window.DP.context.pageType)}handleTypeSelectionClick(e){this.setState({loading:!0}),this.setState({selectedType:e}),this.fetchPackages(e),this.handleGtmMenuClick(e),window.DP.store.dispatch({type:"SELECTED_PACKAGE",selected:e})}isVisible(e){if(null===e)return null;var{top:t,bottom:s,x:a,right:i}=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return(t>0||s>0)&&t<r&&a+i<=n}filterItems(e,t){var s={},a=Object.keys(e).map(e=>e);for(var i in t)t.hasOwnProperty(i)&&a.includes(i)&&(s[i]=t[i],s[i].status=e[i]);return s}applyDynamicValues(e,t){var s=JSON.stringify(e);for(var a in t)if(t.hasOwnProperty(a)){var i=new RegExp(":".concat(a),"i");s=s.replace(i,t[a])}return JSON.parse(s)}renderPackagesCards(){if(this.state.loading)return r.a.createElement(Cm,null);var e=0,t=this.state.packages.sort((e,t)=>e.code>t.code?-1:1);return("CONS"===this.state.selectedType?t.reverse():t).map(t=>{if("OWN_ADH_4"===t.code||void 0===this.props[t.code])return!1;e++;var s=this.props[t.code],a={common:this.props.common,packageId:s.id,packageName:s.name,packageColor:s.color,packageCode:t.code,cityId:t.cityId,packageType:this.state.selectedType},i=s.front.items;Object.keys(t).map(e=>e);if(a.front={items:this.filterItems(t,i),price:fa(h.a.encodeCurrencyValue(t.price,{noDollarSign:!0,noDecimal:!1}))},void 0!==s.back){var n=s.back.items;a.back={include:s.back.include,items:this.filterItems(t,n)}}return a=this.applyDynamicValues(a,t),r.a.createElement("div",{className:"js-slide-".concat(e),key:e},r.a.createElement(Au,{pricing:a}))})}renderErrorMessage(){return r.a.createElement($m,null,this.props.common.error)}renderSlider(){return this.state.hasFailed?this.renderErrorMessage():r.a.createElement(Um,null,r.a.createElement(_m,{handleOnClick:this.handleTypeSelectionClick,selectedType:this.state.selectedType}),r.a.createElement(fm,{selectedType:this.state.selectedType}),r.a.createElement(Uh.a,Mm({},jm,{afterChange:this.slideVisibility}),this.renderPackagesCards()),r.a.createElement(Zu,{modalContent:this.props.currentItem,modalVisible:this.props.visible}))}render(){return r.a.createElement(au.a,{i18n:Dm},r.a.createElement($h.ThemeProvider,{theme:{style:"default"}},r.a.createElement(Vm,null,this.renderSlider())))}}Hm.propTypes={common:je.PropTypes.object.isRequired,BLD_ADH_1:je.PropTypes.object,BLD_ADH_2:je.PropTypes.object,OWN_ADH_1:je.PropTypes.object,OWN_ADH_2:je.PropTypes.object,OWN_ADH_3:je.PropTypes.object,OWN_ADH_TERR_1_SS:je.PropTypes.object,OWN_ADH_TERR_2_SS:je.PropTypes.object,visible:je.PropTypes.bool,currentItem:je.PropTypes.object,currentPackage:je.PropTypes.string};var zm=Hm=Object(m.b)(({Modal:e,Packages:t})=>{var{visible:s,currentItem:a}=e,{currentPackage:i}=t;return{visible:s,currentItem:a,currentPackage:i}})(Hm),Wm=g.createProviderWrappedComponent(e=>r.a.createElement(zm,e));class Km extends r.a.Component{renderDisclaimer(){var e=this.props.residential;switch(this.props.currentPackage){case"CONS":e=this.props.builder;break;case"TERR":e=this.props.land}return e}render(){return window.DP.context.route==="".concat(window.DP.lang,"::sell::pricing")&&r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.renderDisclaimer()}})}}Km.propTypes={residential:je.PropTypes.string,builder:je.PropTypes.string,land:je.PropTypes.string,currentPackage:je.PropTypes.string.isRequired};var Ym=Km=Object(m.b)(({Packages:e})=>{var{currentPackage:t}=e;return{currentPackage:t}})(Km),Xm=g.createProviderWrappedComponent(e=>r.a.createElement(Ym,e));function Zm(){var e=Qm(["\n    padding: 0 45px 20px;\n    text-align: center;\n    border: none;\n\n    @media only screen and (max-width: 768px) {\n        padding: 0 45px 40px;\n        border-bottom: solid 10px #f6f6f6;\n    }\n\n    > div {\n        margin-top: -15px;\n        margin-bottom: 30px;\n        font-size: 9px;\n        color: #666;\n    }\n\n    > p {\n        font-size: 20px;\n        font-weight: 600;\n        line-height: 1;\n\n        span {\n            display: inline-block;\n            font-size: 20px;\n            font-weight: 700;\n\n            @media (max-width: 640px) {\n                display: block;\n            }\n        }\n    }\n\n    > a {\n        display: block;\n        margin-top: 10px;\n        font-size: 14px;\n        font-weight: 600;\n        color: #00c6ff;\n        text-decoration: none;\n\n        span {\n            display: inline-block;\n            width: 5px;\n            margin: 0 0 0 5px;\n\n            svg {\n                display: inline-block;\n                width: 5px;\n                height: 9px;\n                fill: #00c6ff;\n            }\n        }\n    }\n"]);return Zm=function(){return e},e}function Jm(){var e=Qm(["\n    margin: 20px 0;\n    height: 65px;\n\n    @media only screen and (max-width: 1020px) {\n        margin: 0;\n    }\n\n    @media only screen and (max-width: 768px) {\n        height: auto;\n    }\n"]);return Jm=function(){return e},e}function Qm(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var eg=$h.default.div(Jm()),tg=$h.default.div(Zm());class sg extends r.a.Component{handleClickDetails(e){e.preventDefault(),window.DP.store.dispatch({type:"SHOW_MODAL"}),window.DP.store.dispatch(iu(this.props.modal)),Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"Click_Financing","Overlay-Button")}renderNoPaymentInfo(){if("RES"!==this.props.currentPackage)return!1;var{content:e,btnLabel:t}=this.props;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{dangerouslySetInnerHTML:{__html:e}}),r.a.createElement("a",{onClick:this.handleClickDetails.bind(this),href:"#"},t,r.a.createElement(Ge.a,{src:"/build/img/svg/icn-arrow-full-right.svg",cacheGetRequests:!0})))}renderFooter(){return r.a.createElement(tg,null,this.renderNoPaymentInfo())}render(){return r.a.createElement(eg,null,this.renderFooter())}}sg.propTypes={content:je.PropTypes.string,btnLabel:je.PropTypes.string,modal:je.PropTypes.object,visible:je.PropTypes.bool,currentItem:je.PropTypes.object,currentPackage:je.PropTypes.string};var ag=sg=Object(m.b)(({Modal:e,Packages:t})=>{var{visible:s,currentItem:a}=e,{currentPackage:i}=t;return{visible:s,currentItem:a,currentPackage:i}})(sg),ig=g.createProviderWrappedComponent(e=>r.a.createElement(ag,e));class rg extends r.a.Component{render(){return this.props.showWarningMessage?r.a.createElement(Xa,{message:this.props.geoWarningMessage}):null}}rg.propTypes={geoWarningMessage:je.PropTypes.string.isRequired,showWarningMessage:je.PropTypes.bool};var ng=rg=Object(m.b)(({warningMessageBar:e})=>{var{showWarningMessage:t}=e;return{showWarningMessage:t}})(rg),og=g.createProviderWrappedComponent(e=>r.a.createElement(ng,e)),lg=()=>{var e=function(e,s){var a=e?d()(this):s,i=a.hasClass("".concat("jq-dropdown","-open"));if(e){if(d()(e.target).hasClass("".concat("jq-dropdown","-ignore")))return;e.preventDefault(),e.stopPropagation()}else if(a!==s.target&&d()(s.target).hasClass("".concat("jq-dropdown","-ignore")))return;t(),i||a.hasClass("".concat("jq-dropdown","-disabled"))||(a.addClass("".concat("jq-dropdown","-open")),d()(document).find(".".concat("jq-dropdown","-open")).each((function(){var e=d()(this).next(".jq-dropdown");e.data("".concat("jq-dropdown","-trigger"),a).show(),e.trigger("show",{jqDropdown:e,trigger:a})})))},t=function(e){var t=e?d()(e.target).parents().addBack():null;if(t&&t.is(".".concat("jq-dropdown"))){if(!t.is(".".concat("jq-dropdown","-menu")))return;if(!t.is("A"))return}d()(document).find(".".concat("jq-dropdown",":visible")).each((function(){var e=d()(this);e.hide().removeData("".concat("jq-dropdown","-trigger")).trigger("hide",{jqDropdown:e})})),d()(document).find(".".concat("jq-dropdown","-open")).removeClass("".concat("jq-dropdown","-open")),d()(".mobile-header").is(":visible")||(d()(document).find(".".concat("jq-dropdown-children",":visible")).each((function(){var e=d()(this);e.hide().removeData("".concat("jq-dropdown-children","-trigger")).trigger("hide",{jqDropdown:e})})),d()(document).find(".".concat("jq-dropdown-children","-open")).removeClass("".concat("jq-dropdown-children","-open")))};return d.a.fn.jqDropdown=function(s,a){switch(s){case"show":return e(null,d()(this)),d()(this);case"hide":return t(),d()(this);case"attach":return d()(this).attr("data-".concat("jq-dropdown"),a);case"detach":return t(),d()(this).removeAttr("data-".concat("jq-dropdown"));case"disable":return d()(this).addClass("".concat("jq-dropdown","-disabled"));case"enable":return t(),d()(this).removeClass("".concat("jq-dropdown","-disabled"))}},d()(document).on("click.jq-dropdown","[data-".concat("jq-dropdown","]"),e),d()(document).on("click.jq-dropdown",t),d.a.fn.jqDropdown},cg=()=>{var e=function(e,s){var a=e?d()(this):s,i=a.hasClass("".concat("jq-dropdown-children","-open"));if(e){if(d()(e.target).hasClass("".concat("jq-dropdown-children","-ignore")))return;e.preventDefault(),e.stopPropagation()}else if(a!==s.target&&d()(s.target).hasClass("".concat("jq-dropdown-children","-ignore")))return;t(),i||a.hasClass("".concat("jq-dropdown-children","-disabled"))||(a.addClass("".concat("jq-dropdown-children","-open")),d()(document).find(".".concat("jq-dropdown-children","-open")).each((function(){var e=d()(this).next(".jq-dropdown-children");e.data("".concat("jq-dropdown-children","-trigger"),a).show(),e.find(".select-dropdown__input").focus(),e.trigger("show",{jqDropdownChildren:e,trigger:a})})))},t=function(e){var t=e?d()(e.target).parents().addBack():null;if(t&&t.is(".".concat("jq-dropdown-children"))){if(!t.is(".".concat("jq-dropdown-children","-menu")))return;if(!t.is("A"))return}d()(document).find(".".concat("jq-dropdown-children",":visible")).each((function(){var e=d()(this);e.hide().removeData("".concat("jq-dropdown-children","-trigger")).trigger("hide",{jqDropdownChildren:e})})),d()(document).find(".".concat("jq-dropdown-children","-open")).removeClass("".concat("jq-dropdown-children","-open")),d()(".mobile-header").is(":visible")||(d()(document).find(".".concat("jq-dropdown",":visible")).not("#characteristics-dropdown").each((function(){var e=d()(this);e.hide().removeData("".concat("jq-dropdown","-trigger")).trigger("hide",{jqDropdownChildren:e})})),d()(document).find(".".concat("jq-dropdown","-open:not([data-jq-dropdown='#characteristics-dropdown'])")).removeClass("".concat("jq-dropdown","-open")))};return d.a.fn.jqDropdownChildren=function(s,a){switch(s){case"show":return e(null,d()(this)),d()(this);case"hide":return t(),d()(this);case"attach":return d()(this).attr("data-".concat("jq-dropdown-children"),a);case"detach":return t(),d()(this).removeAttr("data-".concat("jq-dropdown-children"));case"disable":return d()(this).addClass("".concat("jq-dropdown-children","-disabled"));case"enable":return t(),d()(this).removeClass("".concat("jq-dropdown-children","-disabled"))}},d()(document).on("click.jq-dropdown-children","[data-".concat("jq-dropdown-children","]"),e),d()(document).on("click.jq-dropdown-children",t),d.a.fn.jqDropdownChildren};class pg{constructor(e){this.$element=d()(e),this.componentDidMount()}componentDidMount(){}}var dg=[".carousel-modal","slick-slider",".slick-list",".slick-track",".slick-slide"],hg={arrows:!0,focusOnSelect:!0,nextArrow:".carousel-modal__navigation--right",prevArrow:".carousel-modal__navigation--left",speed:200};var ug=class extends pg{componentDidMount(){this.$carousel=this.$element.find(".carousel-modal__carousel"),this.$triggers=d()(".carousel-modal-trigger[data-carousel-id=".concat(this.$element.data("carousel-id"),"]")),this.$currentSlideIndex=this.$element.find(".carousel-modal__counter-current"),this.$totalSlides=this.$element.find(".carousel-modal__counter-total"),this.$closeButton=this.$element.find(".carousel-modal__close-icon"),this.$carousel.slick(hg),this.$element.on("click.CarouselModal",this.handleModalClick.bind(this)),this.$triggers.on("click.CarouselModal",this.handleTriggerClick.bind(this)),this.$carousel.on("afterChange.CarouselModal",this.handleSlideChange.bind(this)),this.$closeButton.on("click.CarouselModal",this.handleCloseButtonClick.bind(this))}handleTriggerClick(e){this.$carousel.slick("slickGoTo",d()(e.currentTarget).data("carousel-slide-id")),this.showModal()}handleModalClick(e){!0===d()(e.target).is(dg.join())&&this.hideModal()}handleSlideChange(){var e=this.$element.find(".slick-active"),t=this.$element.find(".slick-slide:not(.slick-cloned)"),s=e.find(".slick-slide-content").data("category"),a=e.find(".slick-slide-content").data("action");this.$currentSlideIndex.html(e.index()),this.$totalSlides.html(t.length),Se.a.pushToDataLayer("gtm-event",s,a,"undefined")}handleCloseButtonClick(){this.hideModal()}showModal(){setTimeout(()=>this.$element.addClass("carousel-modal--visible"),0)}hideModal(){this.$element.removeClass("carousel-modal--visible")}},mg="page-packages-from--hidden",gg=0;var _g=class extends pg{componentDidMount(){window.$window.on("scroll.CallMeFormAnchor",this.updateNav.bind(this)),window.$window.on("resize.CallMeFormAnchor",this.updateNav.bind(this)),this.$element.removeClass("page-packages-from--loading"),this.updateNav()}updateNav(){if(!this.shouldDisplayStickyVersion())return null;gg<this.$element.offset().top&&(gg=this.$element.offset().top),this.$element.hasClass("page-packages-from--always-anchored")?(this.anchorForm(),this.$element.removeClass(mg)):(this.toggleBarVisibility(),this.toggleBarAnchor())}toggleBarVisibility(){window.$window.scrollTop()<150?(this.$element.addClass(mg),this.$element.removeClass("page-packages-from--visible")):(this.$element.removeClass(mg),this.$element.addClass("page-packages-from--visible"))}toggleBarAnchor(){this.shouldAnchor()?this.anchorForm():this.$element.removeClass("page-packages-from--anchored")}anchorForm(){this.$element.addClass("page-packages-from--anchored")}shouldAnchor(){return window.$window.outerHeight()+120>this.getAnchorThresholdBasedOnWindowWidth()?(this.$element.removeClass(mg),this.$element.addClass("page-packages-from--visible"),!0):window.$window.scrollTop()+window.$window.outerHeight()>this.getAnchorThresholdBasedOnWindowWidth()}shouldDisplayStickyVersion(){return window.$window.outerWidth()>768}getAnchorThresholdBasedOnWindowWidth(){var e=28,t=window.$window.outerWidth();return t<936||t<1021?e=20:t<1025&&(e=40),gg-e}};var bg=class extends pg{componentDidMount(){this.$element.on("click.ContactFormTrigger",this.handleClick.bind(this))}handleClick(){window.DP.store.dispatch({type:"SHOW_CONTACT_FORM"}),window.DP.store.dispatch({type:"ADD_GTM_CATEGORY_CONTACT_FORM",gtmCategory:this.$element.data("form-gtm-category")}),window.DP.store.dispatch({type:"ADD_GTM_ACTION_CONTACT_FORM",gtmAction:this.$element.data("form-gtm-action")}),window.DP.store.dispatch({type:"ADD_GTM_SUBMIT_CALL_NAME",gtmSubmitCallName:this.$element.data("form-gtm-submit-call-name")})}};var vg=class extends pg{componentDidMount(){this.$element.on("click.ProvinceSelectorTrigger",this.handleClick.bind(this)),window.$document.on("click.ProvinceSelectorTrigger",this.handleOutsideClick.bind(this)),window.$document.on("touchend.ProvinceSelectorTrigger",this.handleOutsideClick.bind(this))}handleClick(){this.toggleProvinceSelector()}handleOutsideClick(e){var t=d()(e.target);t.hasClass("province-selector")||t.parents(".province-selector").length||this.hideProvinceSelector()}handleMouseEnter(){this.showProvinceSelector()}handleMouseLeave(){this.hideProvinceSelector()}toggleProvinceSelector(){this.$element.toggleClass("province-selector--active")}hideProvinceSelector(){this.$element.removeClass("province-selector--active")}showProvinceSelector(){this.$element.addClass("province-selector--active")}};var yg=class extends pg{componentDidMount(){this.$element.on("click.SellerContactFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.auth.check?window.DP.store.dispatch({type:"SHOW_SELLER_CONTACT_FORM"}):Wo("do=contact-owner-list&code=".concat(this.$element.data("listing-code"),"&url-back=").concat(encodeURIComponent(window.location.href)))}};var fg=class extends pg{componentDidMount(){this.$element.on("click.ListingTroubleReachingFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch(Ko("trouble"))}};var Tg=class extends pg{componentDidMount(){this.$element.on("click.ListingRentalWarningTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch(Ko("warning"))}};var Pg=class extends pg{componentDidMount(){this.$element.on("click.ListingContactFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch({type:"SHOW_LISTING_CONTACT_FORM"})}};var wg=class extends pg{componentDidMount(){this.$element.on("click.CallbackFormTrigger",this.handleClick.bind(this))}handleClick(e){e.preventDefault(),window.DP.store.dispatch({type:"SHOW_CALLBACK_FORM"}),window.DP.store.dispatch({type:"ADD_GTM_CATEGORY_CALLBACK_FORM",gtmCategory:this.$element.data("form-gtm-category")}),window.DP.store.dispatch({type:"ADD_GTM_ACTION_CALLBACK_FORM",gtmAction:this.$element.data("form-gtm-action")}),this.$element.data("click-gtm-action")&&Se.a.pushToDataLayer("gtm-event",this.$element.data("form-gtm-category"),this.$element.data("click-gtm-action"),"undefined")}};var Eg=class extends pg{componentDidMount(){this.$body=d()("body"),this.$mobileNav=d()(".mobile-header"),this.$loginPopover=d()(".my-account-popover"),this.$informationBar=d()(".".concat("information-bar")),window.$window.on("scroll.FixedHeader",this.updateNav.bind(this)),window.$window.on("resize.FixedHeader",this.updateNav.bind(this)),this.updateNav()}removeBodyInlinePaddingTop(){this.$body.css("padding-top","")}shouldShowFixedHeader(){var e=window.$window.scrollTop(),t=50;return this.$informationBar.length&&(t+=this.$informationBar.outerHeight()),e>t}toggleFixedHeader(){this.shouldShowFixedHeader()?this.showFixedHeader():this.hideFixedHeader()}showFixedHeader(){this.$body.css("padding-top","115px"),this.$loginPopover.addClass("my-account-popover--fixed-header"),this.$element.addClass("header--fixed")}hideFixedHeader(){this.removeBodyInlinePaddingTop(),this.$loginPopover.removeClass("my-account-popover--fixed-header"),this.$element.removeClass("header--fixed")}updateNav(){this.$element.is(":visible")?this.toggleFixedHeader():this.$mobileNav.is(":visible")&&this.removeBodyInlinePaddingTop()}};var Cg=class extends pg{componentDidMount(){this.$menu=this.$element.parents(".".concat("footer__column--menu")),this.$subMenu=this.$element.parents(".".concat("footer__menu-link")),this.$element.on("click.FooterMenuTitle",this.handleClick.bind(this))}handleClick(){this.$subMenu.length||this.$menu.toggleClass("footer__column--menu-active")}};var Sg=class extends pg{componentDidMount(){this.$networkTrigger=this.$element.find(".mobile-header__item--network .mobile-header__trigger"),this.$networkMenu=d()(".mobile-menu--network"),this.$mainLink=this.$element.find(".mobile-header__item--main"),this.$mainMenu=d()(".mobile-menu--main"),this.$contactLink=this.$element.find(".mobile-header__item--contact"),this.$contactMenu=d()(".mobile-menu--contact"),this.$searchLink=this.$element.find(".mobile-header__item--search"),this.$searchMenu=d()(".mobile-menu--search"),this.$provinceSelectorLink=d()(".province-selector-mobile-trigger"),this.$provinceSelector=d()(".province-selector"),this.$myAccountLoggedButton=d()(".mobile-my-account-logged-trigger"),this.$myAccountLogged=d()(".mobile-my-account-logged"),this.$links=this.$element.find(".".concat("mobile-header__item")),this.$menus=d()(".".concat("mobile-menu")),this.$anchorLink=d()(".".concat("js-collapse-menu")),this.$networkTrigger.on("click.MobileHeader",this.handleTriggerClick.bind(this,this.$networkTrigger,this.$networkMenu)),this.$mainLink.on("click.MobileHeader",this.handleLinkClick.bind(this,this.$mainLink,this.$mainMenu)),this.$anchorLink.on("click.MobileHeader",this.collapseMenus.bind(this)),this.$contactLink.on("click.MobileHeader",this.handleLinkClick.bind(this,this.$contactLink,this.$contactMenu)),this.$searchLink.on("click.MobileHeader",this.handleLinkClick.bind(this,this.$searchLink,this.$searchMenu)),this.$provinceSelectorLink.on("click.MobileHeader",this.handleProvinceSelectorLinkClick.bind(this)),this.$myAccountLoggedButton.on("click.MobileHeader",this.handleMyAccountLoggedButtonClick.bind(this))}handleLinkClick(e,t){var s=e.hasClass("mobile-header__item--active"),a=d()("#chat-widget-container");this.collapseMenus(),s?(a.show(),Se.a.pushDynamicEvent("header-close-menu-mobile",window.DP.context.pageType)):(t.addClass("mobile-menu--active"),e.addClass("mobile-header__item--active"),a.hide(),Se.a.pushDynamicEvent("header-open-menu-mobile",window.DP.context.pageType)),Se.a.pushToDataLayer("gtm-event","Header_Navigation",e.data("gtm-action"),"undefined")}handleTriggerClick(e,t){e=e.parents(".mobile-header__item"),this.handleLinkClick(e,t)}handleProvinceSelectorLinkClick(){this.$provinceSelector.toggleClass("province-selector--active"),this.$menus.toggleClass("mobile-menu--hidden-left"),this.$element.toggleClass("mobile-header--hidden-left")}handleMyAccountLoggedButtonClick(){this.$myAccountLogged.toggleClass("mobile-my-account-logged--active"),this.$menus.toggleClass("mobile-menu--hidden-left"),this.$element.toggleClass("mobile-header--hidden-left")}collapseMenus(){this.$menus.removeClass("mobile-menu--active"),this.$links.removeClass("mobile-header__item--active")}};var Rg=class extends pg{componentDidMount(){this.actualLinkSelector=this.$element.data("link-class"),this.$actualLink=d()(".".concat(this.actualLinkSelector)),this.$element.on("click.LinkClickDelegate",this.handleClick.bind(this))}handleClick(){this.$actualLink.click()}},Ng="listing-complete-list-characteristics__content--visible";var kg=class extends pg{componentDidMount(){this.$element.find(".".concat("listing-complete-list-characteristics__title")).on("click",this.handleClick.bind(this))}handleClick(){var e=this.$element.find(".".concat("listing-complete-list-characteristics__title__icon")),t=this.$element.find(".".concat("listing-complete-list-characteristics__content"));t.is(".".concat(Ng))?(t.removeClass(Ng),e.removeClass("listing-complete-list-characteristics__title__icon--arrow-up")):(t.addClass(Ng),e.addClass("listing-complete-list-characteristics__title__icon--arrow-up"))}};var Lg=class extends pg{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(){window.DP.store.dispatch(ko(this.$element.data("tab-name"),!0))}},qg="select-dropdown",Og="".concat(qg,"__option"),xg="".concat(Og,"--selected"),Dg="".concat(qg,"__label"),Mg="".concat(Dg,"__text"),Ag="".concat(qg,"__arrow"),Ig="".concat(qg,"__options"),Bg=(e,t,s)=>'<div class="'.concat(qg,'">\n        <span class="').concat(Dg,'" data-jq-dropdown="#').concat(e,'">\n            <span class="').concat(Mg,'">').concat(t.label,'</span>\n            <div class="').concat(Ag,'">').concat('<svg viewBox="0 0 27 15" xmlns="http://www.w3.org/2000/svg"><path d="M1.395 4.14c-.512-.47-.77-1.086-.77-1.702 0-.616.258-1.23.77-1.7 1.023-.94 2.687-.94 3.712 0L13.75 8.66 22.395.737c1.024-.94 2.687-.94 3.712 0 1.026.94 1.026 2.463 0 3.403l-10.5 9.625c-1.024.94-2.686.94-3.71 0L1.395 4.14z" fill-rule="evenodd"></path></svg>','</div>\n        </span>\n\n        <div id="').concat(e,'" class="').concat(Ig,' jq-dropdown">\n            ').concat(((e,t)=>t.map(t=>{var s=He(Og,{selected:e.value===t.value});return'<div class="'.concat(s,'" data-value="').concat(t.value,'">').concat(t.label,"</div>")}).join(""))(t,s),"\n        </div>\n    </div>");var Fg=class extends pg{componentDidMount(){this.options=this.fetchOptions(),this.selectedOption=this.options.find(e=>e.selected)||this.options[0],this.uniqueId=this.$element.data("select-id"),this.$newElement=d()(Bg(this.uniqueId,this.selectedOption,this.options)),this.$element.after(this.$newElement),this.$element.hide(),this.$newElementLabel=this.$newElement.find(".".concat(Mg)),this.$newElementOptions=this.$newElement.find(".".concat(Og)),this.$newElementOptions.on("click",this.handleOptionClick.bind(this)),this.$element.on("update",this.handleUpdate.bind(this))}handleUpdate(e,t){var s=this.$newElementOptions.toArray().filter(e=>e.dataset.value===t);this.updateWithOption(d()(s))}handleOptionClick(e){var t=d()(e.target);this.updateWithOption(t),window.Dropdown("hide")}fetchOptions(){return Array.from(this.$element.find("option")).map(e=>({value:e.value,label:e.innerHTML.trim(),selected:e.selected}))}updateWithOption(e){this.$newElementLabel.html(e.html()),this.$newElementOptions.removeClass(xg),e.addClass(xg),this.$element.val("".concat(e.data("value"))).change()}};var jg=class extends pg{componentDidMount(){this.$informationBar=d()(".".concat("information-bar")),window.$window.on("scroll.FixedHeader",this.updateListingHeader.bind(this)),window.$window.on("resize.FixedHeader",this.updateListingHeader.bind(this)),this.updateListingHeader()}updateListingHeader(){var e=window.$window.scrollTop(),t=150;this.$informationBar.length&&(t+=this.$informationBar.outerHeight()),e>t?this.$element.addClass("listing-fixed-header--active"):(this.$element.removeClass("listing-fixed-header--active"),d()(".favourite-notes-panel__popover--sticky").length&&window.DP.store.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"}))}};var Vg=class extends pg{componentDidMount(){this.$element.find(".".concat("listing-complete-list-open-house__title")).on("click",this.handleClick.bind(this))}handleClick(){var e=this.$element.find(".".concat("listing-complete-list-open-house__arrow")),t=this.$element.find(".".concat("listing-list-open-house__hours"));t.is(".".concat("listing-list-open-house__hours--visible"))?(t.removeClass("listing-list-open-house__hours--visible"),e.removeClass("listing-complete-list-open-house__arrow--arrow-up")):(t.addClass("listing-list-open-house__hours--visible"),e.addClass("listing-complete-list-open-house__arrow--arrow-up"))}},Ug="listing-owners-comments__actions-more-button--visible",$g="listing-owners-comments__actions-less-button--visible";var Gg=class extends pg{componentDidMount(){var e=this.$element.find(".".concat("js-listing-owners-comments-description__translate-actions-show-original")),t=this.$element.find(".".concat("js-listing-owners-comments-description__translate-actions-show-translation"));this.$moreButton=this.$element.find(".".concat("listing-owners-comments__actions-more-button")),this.$lessButton=this.$element.find(".".concat("listing-owners-comments__actions-less-button")),this.$showOriginalDescriptionDiv=this.$element.find(".".concat("js-listing-owners-comments-description-show-original")),this.$showTranslatedDescriptionDiv=this.$element.find(".".concat("js-listing-owners-comments-description-show-translation")),this.$description=this.$element.find(".".concat("listing-owners-comments__description")),this.setDescriptions(),this.$moreButton.on("click.ListingOwnersComments",this.handleMoreButtonClick.bind(this)),this.$lessButton.on("click.ListingOwnersComments",this.handleLessButtonClick.bind(this)),e.on("click",this.handleShowOriginalDescriptionButtonClick.bind(this)),t.on("click",this.handleShowTranslatedDescriptionButtonClick.bind(this)),this.isDescriptionExceedingMaxLength()?(this.$description.html(this.getTrimmedDescription()),this.$moreButton.addClass(Ug),this.$lessButton.removeClass($g)):(this.$description.html(this.activeDescription),this.$moreButton.removeClass(Ug),this.$lessButton.removeClass($g)),this.$description.attr("lang",this.activeLangugage)}handleMoreButtonClick(){this.$description.html(this.activeDescription),this.$moreButton.removeClass(Ug),this.$lessButton.addClass($g)}handleLessButtonClick(){this.$description.html(this.getTrimmedDescription()),this.$moreButton.addClass(Ug),this.$lessButton.removeClass($g)}handleShowOriginalDescriptionButtonClick(){this.setOriginalDescription(),this.isButtonMoreVisible()?this.$description.html(this.getTrimmedDescription()):this.$description.html(this.activeDescription),c.a.set("show_origin_lang_translation",1),this.$description.attr("lang",this.activeLangugage)}handleShowTranslatedDescriptionButtonClick(){this.setTranslatedDescription(),this.isButtonMoreVisible()?this.$description.html(this.getTrimmedDescription()):this.$description.html(this.activeDescription),c.a.set("show_origin_lang_translation",0),this.$description.attr("lang",this.activeLangugage)}descriptionIsVisible(e){return e&&!e.hasClass("is-hidden")}setDescriptions(){var e=this.$element.find(".".concat("js-listing-owners-comments-description-translation")),t=this.$element.find(".".concat("js-listing-owners-comments-description-original"));e&&t&&(this.fullTranslatedDescription=e.html(),this.fullOriginalDescription=t.html(),this.translatedLanguage=e.attr("lang"),this.originalLanguage=t.attr("lang")),c.a.get("show_origin_lang_translation")||this.descriptionIsVisible(t)?this.setOriginalDescription():this.descriptionIsVisible(e)?this.setTranslatedDescription():this.activeDescription=this.$description.html()}setOriginalDescription(){this.activeDescription=this.fullOriginalDescription,this.activeLangugage=this.originalLanguage,this.$showOriginalDescriptionDiv.addClass("is-hidden"),this.$showTranslatedDescriptionDiv.removeClass("is-hidden")}setTranslatedDescription(){this.activeDescription=this.fullTranslatedDescription,this.activeLangugage=this.translatedLanguage,this.$showOriginalDescriptionDiv.removeClass("is-hidden"),this.$showTranslatedDescriptionDiv.addClass("is-hidden")}getTrimmedDescription(){var{html:e}=va(this.activeDescription,1e3);return e}isDescriptionExceedingMaxLength(){if(!this.activeDescription)return!1;var{more:e}=va(this.activeDescription,1e3);return e}isButtonMoreVisible(){return this.$moreButton.hasClass(Ug)}};var Hg=class extends pg{componentDidMount(){this.$element.find(".".concat("listing-contact-more__modal-trigger")).on("click",this.handleContactOpenClick.bind(this)),this.$element.find(".".concat("listing-contact-more__modal-close")).on("click",this.handleContactCloseClick.bind(this))}handleContactOpenClick(){this.$element.find(".".concat("listing-contact-more__modal-content")).addClass("listing-contact-more__modal-content--visible")}handleContactCloseClick(){this.$element.find(".".concat("listing-contact-more__modal-content")).removeClass("listing-contact-more__modal-content--visible")}},zg=window.DP.breakpoints.regular,Wg=window.DP.context.pageType;var Kg=class extends pg{componentDidMount(){this.$viewport=d()("body, html"),this.$bar=this.$element.find(".know-more__bar"),this.$header=this.$element.find(".know-more__header"),this.$link=this.$element.find(".know-more__item-link"),this.$gtmClass=this.$element.attr("data-gtm-class"),Fe()&&this.$link.map((e,t)=>this.displayMobileUrl(t)),Fe()&&d()(".js-sticky-cta-link-packages").parent().addClass("know-more__item--hidden"),this.$header.on("click.KnowMoreAnchor",this.scrollToSection.bind(this)),window.$window.on("scroll.KnowMoreAnchor",this.updateNav.bind(this)),window.$window.on("resize.KnowMoreAnchor",this.updateNav.bind(this)),this.$alreadyDisplayed=!1,this.updateNav()}displayMobileUrl(e){e.dataset.mobileurl.length&&(e.attributes.href.nodeValue=e.dataset.mobileurl)}updateNav(){this.$element.hasClass("know-more--always-anchored")?(this.anchorKnowMore(),this.$element.removeClass("know-more--hidden")):(this.toggleBarVisibility(),this.toggleBarAnchor()),this.styleLiveChatBar()}styleLiveChatBar(){var e="110px";this.$liveChatBar=document.getElementById("chat-widget-container");var t=window.innerWidth;void 0!==this.$liveChatBar&&null!==this.$liveChatBar&&(this.$element.hasClass("know-more--hidden")||this.$element.hasClass("know-more--anchored")?this.$liveChatBar.style.setProperty("bottom",0,"important"):(t>1041?e="110px":t>1020&&t<1042?e="126px":t<1021&&(e="40px"),this.$liveChatBar.style.setProperty("bottom",e,"important")))}toggleBarVisibility(){var e=this.$element.attr("data-know-more-breakpoint")?this.$element.attr("data-know-more-breakpoint"):120;window.$window.scrollTop()<e?this.$element.addClass("know-more--hidden"):(this.$element.removeClass("know-more--hidden"),!this.$alreadyDisplayed&&this.$gtmClass&&(Se.a.pushToDataLayer("gtm-event",Wg,"View_Highway",""),this.$alreadyDisplayed=!0))}toggleBarAnchor(){this.shouldAnchorKnowMore()?this.anchorKnowMore():(this.$element.removeClass("know-more--anchored"),this.$element.height(this.shouldDisplayContent()?this.$element.outerHeight():this.$header.outerHeight()))}anchorKnowMore(){this.$element.addClass("know-more--anchored"),this.$element.height(this.$bar.outerHeight())}shouldAnchorKnowMore(){var e=window.$window.scrollTop()+window.$window.outerHeight(),t=this.$element.offset().top;return e>(t+=this.shouldDisplayContent()?this.$element.outerHeight():this.$header.outerHeight())}shouldDisplayContent(){return window.$window.outerWidth()>zg}scrollToSection(){this.$viewport.animate({scrollTop:this.$element.offset().top},500)}};var Yg=class extends pg{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(){Se.a.pushToDataLayer("gtm-event","Header_Navigation","Click_Login_MyAccount","undefined")}};var Xg=class extends pg{componentDidMount(){this.$element.on("click",this.handleClick.bind(this)),window.$document.on("click.MyAccountLoggedinButton",this.handleOutsideClick.bind(this)),window.$document.on("touchend.MyAccountLoggedinButton",this.handleOutsideClick.bind(this))}handleClick(){this.toggleLoggedin()}handleOutsideClick(e){d()(e.target).parents(".".concat("header__my-account")).length||this.hideLoggedinPopover()}toggleLoggedin(){d()(".".concat("my-account-popover")).toggleClass("my-account-popover--active"),d()(".".concat("header__my-account")).toggleClass("header__my-account--active")}hideLoggedinPopover(){d()(".".concat("my-account-popover")).removeClass("my-account-popover--active"),d()(".".concat("header__my-account")).removeClass("header__my-account--active")}};var Zg=class extends pg{componentDidMount(){this.CONTAINER_HASHTAG_LIST=[".js-savings-calculator",".js-auto-promo-viewer",".js-testimonial-viewer",".js-listing-main-characteristics:visible",".js-sell_why",".js-sell_how",".js-sell_how_much",".js-sell_how_much_save",".js-sell_services",".js-sell_savings",".js-sell_visibility",".js-sell_support",".js-buy_why",".js-buy_documents",".js-buy_how",".js-buy_tools",".js-home-la-capitale",".js-listing-la-capitale",".js-buy_cashback",".js-compare-agent",".js-compare-proprio-direct",".js-compare-protect",".js-pb-fixed-fee",".js-pb-sell-everything",".js-pb-sell-how"],this.CONTAINER_VIEW_LIST=[".js-mortgage-data__form__section-description:visible",".js-mortgage-data__form__section-costs:visible",".js-mortgage-data__form-description:visible",".js-mortgage-data__form-costs:visible",".js-mortgage-data__new-form-description:visible",".js-mortgage-data__new-form-costs:visible",".js-cogeco-listing-content-view:visible",".js-bell-listing-content-view:visible",".js-bell-ftth-listing-content-view:visible",".js-bell-fttn-listing-content-view:visible",".js-price-history-description:visible",".js-sticky-banner-ddf-idx",".js-know-more"],window.$window.on("scroll",this.handleScroll.bind(this)),this.sentDataOnce=[]}handleScroll(){this.CONTAINER_HASHTAG_LIST.map(e=>this.addHashtagToUrl(e)),this.CONTAINER_VIEW_LIST.map(e=>this.addGtmPageView(e))}addHashtagToUrl(e){this.onScrollDisplayOnce(e)&&history.replaceState(null,null,d()(e).data("label"))}addGtmPageView(e){var t=d()(e).data("category"),s=d()(e).data("action"),a="undefined"!==d()(e).data("label")?d()(e).data("label"):"undefined";this.onScrollDisplayOnce(e)&&Se.a.pushToDataLayer("gtm-event",t,s,a)}onScrollDisplayOnce(e){if(!this.sentDataOnce.includes(e))return Hl.a.hasScrolledIntoView(d()(e))?(this.sentDataOnce.push(e),!0):void 0}};var Jg=class extends pg{componentDidMount(){this.$viewport=d()("body, html"),this.$moreInfoContent=this.$element.find(".".concat("infosession__content-introduction__more-info")),this.$moreInfoLink=this.$element.find(".".concat("infosession__header-content-link")),this.$moreInfoLink.on("click",this.handleClick.bind(this))}handleClick(e){e.preventDefault(),this.$moreInfoContent.toggleClass("infosession__content-introduction__more-info--open"),this.$moreInfoLink.toggleClass("infosession__header-content-link--open"),this.$moreInfoContent.hasClass("infosession__content-introduction__more-info--open")?(Se.a.pushDynamicEvent("infosession-click-hero-more-info-open","SellerLanding_Mobile"),this.$viewport.animate({scrollTop:this.$moreInfoLink.offset().top},500)):Se.a.pushDynamicEvent("infosession-click-hero-more-info-close","SellerLanding_Mobile")}};var Qg=class extends pg{componentDidMount(){this.videoGtmAction=this.$element.data("gtm-event-action"),this.videoGtmCategory=this.$element.data("gtm-event-category"),this.videoGtmAction&&this.$element.on("click",this.handleGtmDatalayerPush.bind(this))}handleDataCategory(){return this.videoGtmCategory?this.videoGtmCategory:"Seller_Navigation"}handleGtmDatalayerPush(){Se.a.pushToDataLayer("gtm-event",this.handleDataCategory(),this.videoGtmAction,"undefined")}};var e_=class extends pg{componentDidMount(){this.$element.on("click.FooterMenuList",this.handleClick.bind(this))}handleClick(){this.$element.toggleClass("footer__menu-item--active")}},t_=(e,t)=>{var s=(e=>Ke()(window.DP.urls.proxyFeaturedBuilderStats,e))(e),a={type:t};return d.a.ajax({method:"POST",url:s,data:a,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};var s_=class extends pg{componentDidMount(){this.$element.find(".".concat("featured-builder__photo")).on("click",this.handleListingClick.bind(this,"click_listing")),this.$element.find(".".concat("featured-builder__logo")).on("click",this.handleListingClick.bind(this,"click_external")),this.$element.find(".".concat("featured-builder__properties-link")).on("click",this.handleListingClick.bind(this,"click_properties")),this.$element.find(".".concat("featured-builder__footer-link")).on("click",this.handleListingClick.bind(this,"click_external"))}handleListingClick(e){t_(this.$element.data("featured-builder-id"),e)}},a_=null;var i_=class extends pg{componentDidMount(){this.$body=d()("body"),this.$menus=d()(".".concat("mobile-menu")),this.$links=this.$body.find(".".concat("mobile-header__item")),this.$itemsList=d()(".".concat("sub-menu-navigation")),this.$element.find(".sub-menu-navigation__header-link").on("click",this.handleHeaderClick.bind(this)),Qe()?(this.$element.on("click.SubMenuNavigationTrigger",this.handleClick.bind(this)),this.$element.find(".sub-menu-navigation__link").on("click",this.handLinksClick.bind(this))):(this.$element.on("click.SubMenuNavigationTrigger touchstart.SubMenuNavigationTrigger",this.handleClick.bind(this)),this.$element.on("mouseover.SubMenuNavigationTrigger",this.handleMouseOver.bind(this)),window.$document.on("mouseout.SubMenuNavigationTrigger",this.handleMouseOut.bind(this)),window.$document.on("touchstart.SubMenuNavigationTrigger",this.handleMouseOut.bind(this)))}handleClick(){this.showMenuSelectorOnClick()}handleHeaderClick(e){var t=d()(e.target).parents(".".concat("header-primary-nav__item")).index(),s=t!==a_;"ontouchstart"in document.documentElement&&s&&(a_=t,e.preventDefault())}handLinksClick(){this.$menus.removeClass("mobile-menu--active"),this.$links.removeClass("mobile-header__item--active"),this.$itemsList.removeClass("sub-menu-navigation--active")}handleMouseOver(){this.showMenuSelectorOnHover()}handleMouseOut(e){d()(e.target).parents(".".concat("sub-menu-navigation")).length||(this.hideMenuSelector(),a_=null)}hideMenuSelector(){this.$element.removeClass("sub-menu-navigation--active")}showMenuSelectorOnClick(){this.hideAllSubMenus(),this.$element.find(".sub-menu-navigation__item--unavailable").length?this.$element.addClass("sub-menu-navigation--active"):this.$element.toggleClass("sub-menu-navigation--active")}showMenuSelectorOnHover(){this.hideAllSubMenus(),this.$element.addClass("sub-menu-navigation--active")}hideAllSubMenus(){Qe()||this.$itemsList.removeClass("sub-menu-navigation--active")}};var r_=class extends pg{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(e){e.preventDefault();var t=d()(e.currentTarget),s=t.data("id"),a=t.data("type"),i=t.attr("href"),r="_blank"===t.prop("target");Li(s,a),r?window.open(i):window.location=i}},n_=(e,t)=>{var s=(e=>Ke()(window.DP.urls.proxyFeaturedListingsViews,e))(e),a={type:t};return d.a.ajax({method:"POST",url:s,data:a,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})},o_=[];var l_=class extends pg{componentDidMount(){this.$featuredListingsList=this.$element.find(".".concat("search-results-listings-list__item--featured-landlord")),this.$featuredListingsList.each((e,t)=>{if("none"!==window.getComputedStyle(t,null).display){t.addEventListener("click",this.handleClick.bind(this));var s=t.getAttribute("id");s=s.slice(8),o_.push(s)}}),n_(o_,"search_result_list")}handleClick(e){var t=d()(e.currentTarget).data("featured-builder-id");t_(t,"click_listing")}};var c_=class extends pg{componentDidMount(){this.$phoneButton=this.$element.find(".".concat("listing-contact__item-phone-button")),this.$phoneButtonLabel=this.$element.find(".".concat("listing-contact__label--phone-label")),this.$phoneContent=this.$element.find(".".concat("listing-contact__item-phone")),this.$phoneButton.on("click.ListingContactPhoneTrigger",this.handleClick.bind(this))}handleClick(){this.$phoneButton.addClass("".concat("listing-contact__item-phone-button--hidden")),this.$phoneButtonLabel.hide(),this.$phoneContent.removeClass("".concat("listing-contact__item-phone--hidden")),this.$phoneButton.data("listing-preview")||Li(this.$phoneButton.data("listing-code"),"click_on_phone")}};var p_=class extends pg{componentDidMount(){this.$toggleAccordeonTab=this.$element.find(".".concat("pb-accordeon__tab__link")),this.$toggleAccordeonContent=this.$element.find(".".concat("pb-accordeon__tab__content")),this.$toggleAccordeonTab.on("click",this.handleClick.bind(this))}handleClick(e){e.preventDefault(),this.$toggleAccordeonTab.hasClass("pb-accordeon__tab__link--active")||(this.$element.siblings().find(".".concat("pb-accordeon__tab__link")).removeClass("pb-accordeon__tab__link--active"),this.$element.siblings().find(".".concat("pb-accordeon__tab__content")).removeClass("pb-accordeon__tab__content--active"),this.$toggleAccordeonTab.addClass("pb-accordeon__tab__link--active"),this.$toggleAccordeonContent.addClass("pb-accordeon__tab__content--active"))}},d_=e=>{var t=window.DP.urls.proxyBannerDisablePbRedirect;return d.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",d()('meta[name="csrf-token"]').attr("content"))}})};var h_=class extends pg{componentDidMount(){this.$redirectedBanner=d()(".".concat("pb-redirected-banner")),this.$closeButton=d()(".".concat("js-pb-redirected-banner-close")),this.$closeButton.on("click.PurplebricksRedirectedBanner",this.handleCloseButtonClick.bind(this))}handleCloseButtonClick(){this.$redirectedBanner.addClass("is-closed"),d_({})}};var u_=class extends pg{componentDidMount(){new SmoothScroll('a[href*="#"]',{speed:500,offset:50})}};var m_=class extends pg{componentDidMount(){"ontouchstart"in document.documentElement||(document.documentElement.className+="no-touch")}},g_=window.DP.context.pageType;var __=class extends pg{componentDidMount(){this.$blogFeatured=this.$element.find(".".concat("blog-featured")),this.$blogCard=this.$element.find(".".concat("blog-content__cards"," li")),this.$blogArticle=this.$element.find(".".concat("blog-article__text")),this.$blogArticle.find("a").css("color",this.$blogArticle.css("color")),this.$blogSearchFormInput=this.$element.find(".".concat("blog-search"," input[type=text]")),this.featuredTruncate(),this.cardTruncate(),this.$element.find(".".concat("blog-action__link")).length&&new SmoothScroll(".".concat("blog-action__link"),{speed:500,offset:50}),this.$element.find(".".concat("blog-category__link")).on("click",this.handleCategorySidebarGtmClick.bind(this)),this.$blogSearchFormInput.on("keyup",this.handleSearchFormState.bind(this))}handleCategorySidebarGtmClick(e){var t=this.labelGenerator(d()(e.currentTarget).data("category"));Se.a.pushToDataLayer("gtm-event",g_,"Click_Category",t)}labelGenerator(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join("")}featuredTruncate(){for(var e=this.$blogFeatured.find(".".concat("blog-featured__description")),t=this.$blogFeatured.find(".".concat("blog-featured__body")).height()-this.$blogFeatured.find(".".concat("blog-featured__title")).height(),s=e.text().split(" ");e.prop("scrollHeight")>t&&s.length>0;)s.pop(),e.text("".concat(s.join(" ")," ..."))}cardTruncate(){this.$blogCard.each((function(){for(var e=d()(this).find(".".concat("blog-card__description")),t=d()(this).find(".".concat("blog-card__body")).height()-d()(this).find(".".concat("blog-card__title")).height(),s=e.text().split(" ");e.prop("scrollHeight")>t&&s.length>0;)s.pop(),e.text("".concat(s.join(" ")," ..."))}))}handleSearchFormState(){var e=d()(event.currentTarget),t=d()(event.currentTarget).parent().find("label"),s=t.find("input[type=submit]");e.val().length>=3?(s.prop("disabled",!1),t.removeClass("is-disabled")):(s.prop("disabled",!0),t.addClass("is-disabled"))}},b_=[document.querySelectorAll(".js-sell-carousel-container--page .sell-services__step a"),document.querySelectorAll(".js-sell-carousel-container--modal .sell-services__step a")];var v_=class extends pg{componentDidMount(){this.boundedCreateCarousel=this.createCarousel.bind(this),this.boundedArrowButtonListener=this.arrowButtonListener.bind(this),this.boundedSlideByArrow=this.slideByArrow.bind(this),this.boundedCloseCarouselModal=this.closeCarouselModal.bind(this),this.boundedCreateCarousel(d()(".".concat("sell-carousel__page")),0),this.stepperButtonsListener(),this.boundedArrowButtonListener(),this.toggleArrowsDisplay(0),d()(".".concat("sell-carousel__button")).on("click",()=>{this.boundedCreateCarousel(d()(".".concat("sell-carousel__modal"))),d()(".".concat("sell-services-modal")).addClass("sell-services-modal__open"),this.slideCarousel(this.getActiveSlideIndex()+(d()(".".concat("sell-carousel__modal")).hasClass("slick-initialized")?-1:0))}),d()(".".concat("sell-services-modal__close-icon")).on("click",this.boundedCloseCarouselModal)}getActiveSlideIndex(){return parseInt(d()(".js-sell-carousel-container--page .sell-services__step--complete:last").find("a").data("step"),10)}createCarousel(e){var t=e.hasClass("sell-carousel__modal"),s=0;e.hasClass("sell-carousel__modal")&&e.hasClass("slick-initialized")||(t&&(s=this.getActiveSlideIndex()-1),this.carouselSlideListener(e),e.slick({infinite:!1,initialSlide:s,arrows:!1}),t&&this.slideCarousel(s))}closeCarouselModal(e){e.preventDefault(),d()(".".concat("sell-services-modal")).removeClass("sell-services-modal__open"),this.slideCarousel(this.getActiveSlideIndex()-1),Se.a.pushDynamicEvent("sell-carousel-modal-close-button-".concat(this.getActiveSlideIndex()),"SellerSection")}carouselSlideListener(e){var t=this;e.on("afterChange",(function(e,s,a){e.preventDefault(),d()(".js-sell-carousel-container--page").find(".".concat("sell-carousel__next-button")).toggleClass("sell-carousel__next-button--first",0===a),d()(".js-sell-carousel-container--modal").find(".".concat("sell-carousel__next-button")).toggleClass("sell-carousel__next-button--first",0===a),t.arrowButtonListener(),t.setCarouselStepsUI(a),t.toggleArrowsDisplay(a)})),e.on("beforeChange",t.arrowButtonListenerRemoval)}slideCarousel(e){var t=d()(".".concat("sell-carousel__page")),s=d()(".".concat("sell-carousel__modal"));t.slick("slickGoTo",e),s.hasClass("slick-initialized")&&s.slick("slickGoTo",e),this.toggleArrowsDisplay(e)}toggleArrowsDisplay(e){0===e?d()(".".concat("sell-carousel__prev-button")).hide():d()(".".concat("sell-carousel__prev-button")).show(),e===b_[0].length-1?d()(".".concat("sell-carousel__next-button")).hide():d()(".".concat("sell-carousel__next-button")).show()}setCarouselStepsUI(e){b_.forEach(e=>{for(var t=0;t<=e.length-1;t++)e[t].parentElement.classList.remove("sell-services__step--complete")});for(var t=0;t<=e;t++)b_[0][t].parentElement.classList.add("sell-services__step--complete"),b_[1][t].parentElement.classList.add("sell-services__step--complete")}stepperButtonsListener(){var e=this;b_.forEach(t=>{for(var s=function(s){t[s].addEventListener("click",t=>{t.preventDefault(),e.slideCarousel(s)})},a=0;a<=t.length-1;a++)s(a)})}arrowButtonListener(){for(var e=document.querySelectorAll(".sell-carousel__prev-button, .sell-carousel__next-button"),t=0;t<=e.length-1;t++)e[t].addEventListener("click",this.boundedSlideByArrow)}arrowButtonListenerRemoval(){for(var e=document.querySelectorAll(".sell-carousel__prev-button, .sell-carousel__next-button"),t=0;t<=e.length-1;t++)e[t].removeEventListener("click",this.boundedSlideByArrow)}slideByArrow(e){var t=d()(e.currentTarget),s=this.getActiveSlideIndex(),a="";e.preventDefault(),t.closest(".sell-services-modal").length&&(a="modal-"),t.hasClass("sell-carousel__prev-button")?(Se.a.pushDynamicEvent("sell-carousel-".concat(a,"prev-button-").concat(s-1),"SellerSection"),s-=2):Se.a.pushDynamicEvent("sell-carousel-".concat(a,"next-button-").concat(s),"SellerSection"),this.slideCarousel(s)}};var y_=class extends pg{componentDidMount(){this.$highway=this.$element.find(".".concat("js-fixed-highway")),this.$sellQuestionsWrapper=this.$element.find(".".concat("js-sell-questions-wrapper")),this.$sellQuestionsContent=this.$element.find(".".concat("js-sell-questions-content")),this.$WrapperPosition=this.$sellQuestionsWrapper.offset().top-this.$sellQuestionsWrapper.outerHeight(),this.$alreadyDisplayed=!1,this.$highwayDisplayed=!1,this.$highway.addClass("fixed-highway--hidden"),Fe()||(this.$sellQuestionsContent.hide(),window.$window.on("scroll.SellHighway",this.toggleHighwayVisibility.bind(this)),window.$window.on("resize.SellHighway",this.toggleHighwayVisibility.bind(this)),this.toggleHighwayVisibility())}toggleHighwayVisibility(){var e=window.$window.scrollTop();this.$liveChatBar=document.getElementById("chat-widget-container"),100<e&&e<this.$WrapperPosition?(this.$highway.addClass("fixed-highway--visible"),this.$highway.removeClass("fixed-highway--hidden"),this.liveChatBarPosition(102),this.handleGtmHighway()):(this.$highway.removeClass("fixed-highway--visible"),this.$highway.addClass("fixed-highway--hidden"),this.liveChatBarPosition(0)),e>this.$WrapperPosition&&!this.$alreadyDisplayed&&(this.$sellQuestionsContent.slideUp(1500).fadeIn(1500),this.$alreadyDisplayed=!0)}handleGtmHighway(){this.$highwayDisplayed||(Se.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"View_Highway",""),this.$highwayDisplayed=!0)}liveChatBarPosition(e){void 0!==this.$liveChatBar&&null!==this.$liveChatBar&&(this.$liveChatBar.style.marginBottom="".concat(e,"px"),this.$liveChatBar.style.transition="all ".concat(400,"ms"))}};window.jQuery=d.a,window.$=d.a,function(e){var t=e,s="undefined"!=typeof window&&window,a={frameLoaded:0,frameTry:0,frameTime:0,frameDetect:null,frameSrc:null,frameCallBack:null,frameThis:null,frameNavigator:window.navigator.userAgent,frameDelay:0,frameDataSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};t.fn.backDetect=function(e,s){a.frameThis=this,a.frameCallBack=e,null!==s&&(a.frameDelay=s),a.frameNavigator.indexOf("MSIE ")>-1||a.frameNavigator.indexOf("Trident")>-1?setTimeout((function(){t('<iframe src="'+a.frameDataSrc+'?loading" style="display:none;" id="backDetectFrame" onload="jQuery.fn.frameInit();""></iframe>').appendTo(a.frameThis)}),a.frameDelay):setTimeout((function(){t("<iframe src='about:blank?loading' style='display:none;' id='backDetectFrame' onload='jQuery.fn.frameInit();'></iframe>").appendTo(a.frameThis)}),a.frameDelay)},t.fn.frameInit=function(){a.frameDetect=document.getElementById("backDetectFrame"),a.frameLoaded>1&&2===a.frameLoaded&&(a.frameCallBack.call(this),s.history.go(-1)),a.frameLoaded+=1,1===a.frameLoaded&&(a.frameTime=setTimeout((function(){e.fn.setupFrames()}),500))},t.fn.setupFrames=function(){clearTimeout(a.frameTime),a.frameSrc=a.frameDetect.src,1===a.frameLoaded&&-1===a.frameSrc.indexOf("historyLoaded")&&(a.frameNavigator.indexOf("MSIE ")>-1||a.frameNavigator.indexOf("Trident")>-1?a.frameDetect.src=a.frameDataSrc+"?historyLoaded":a.frameDetect.src="about:blank?historyLoaded")}}(jQuery);var f_=class extends pg{componentDidMount(){var e=this;this.$html=d()("html"),this.$exitButton=this.$element.find(".js-callme-exit-button"),this.$popupContent=this.$element.find(".callme-exit-popup"),this.$popupContent.hide(),this.$urlLink="",this.$backButtonPressed=!1,this.$exitButton.on("click",this.hidePopup.bind(this)),this.$html.backDetect((function(){Np.a.get("exit_popup_seen_once")||(e.$element.$backButtonPressed=!0,history.pushState("backbutton-pressed","",null),e.triggerPopup())})),d()("a").not(".js-callme-exit-button, .js-noPopup, .province-selector__language-switch").bind("click",(function(t){if(!Np.a.get("exit_popup_seen_once"))return t.preventDefault(),t.stopImmediatePropagation(),e.handleLinkClicks(t,this),!1})),d()(".js-exit-popup").bind("click",(function(t){!document.querySelector(".callme-exit-popup").contains(t.target)&&e.hidePopup()}))}handleLinkClicks(e,t){e.preventDefault(),this.$urlLink=d()(t).attr("href"),this.triggerPopup()}triggerPopup(){this.$element.addClass("modal"),this.$popupContent.show(),(null===Np.a.get("exit_popup_seen_once")||isNaN(Np.a.get("exit_popup_seen_once"))||void 0===Np.a.get("exit_popup_seen_once"))&&Np.a.set("exit_popup_seen_once",!0)}hidePopup(){this.$element.removeClass("modal"),this.$popupContent.hide(),this.$element.$backButtonPressed?history.back():window.location.href=this.$urlLink}};s(336);h.a.init(window.DP.lang),c.a.setBucket("duproprio-"),((e,t=250)=>{var s;window.addEventListener("resize",()=>{clearTimeout(s),s=setTimeout(e,t)}),window.addEventListener("orientationchange",e),window.addEventListener("load",e)})(Ie,100),window.Dropdown=lg(),window.DropdownChildren=cg(),window.DP.store=we(window.DP.preloadedState),window.ComponentManager=new class{constructor(){this.registeredElementComponents=[],this.registeredCollectionComponents=[],window.$window=d()(window),window.$document=d()(document)}initialize(){return this.instanciateElementComponents(),this.instanciateCollectionComponents(),this}registerElementComponent(e,t){return this.registeredElementComponents.push({componentClass:e,componentSelector:t}),this}registerCollectionComponent(e,t){return this.registeredCollectionComponents.push({componentClass:e,componentSelector:t}),this}instanciateElementComponents(){return this.registeredElementComponents.forEach(({componentClass:e,componentSelector:t})=>{d()(t).toArray().forEach(t=>new e(t))}),this}instanciateCollectionComponents(){return this.registeredCollectionComponents.forEach(({componentClass:e,componentSelector:t})=>{new e(d()(t))}),this}},window.ComponentManager.registerElementComponent(ug,".carousel-modal").registerElementComponent(_g,".page-packages-from").registerElementComponent(bg,".contact-form-trigger").registerElementComponent(vg,".province-selector-trigger").registerElementComponent(Eg,".header").registerElementComponent(Cg,".footer__menu-title").registerElementComponent(Rg,".link-click-delegate").registerElementComponent(kg,".listing-complete-list-characteristics").registerElementComponent(Lg,".listing-tab-trigger-button").registerElementComponent(Vg,".listing-list-open-house").registerElementComponent(Gg,".listing-owners-comments").registerElementComponent(jg,".listing-fixed-header").registerElementComponent(Hg,".listing-contact-more").registerElementComponent(Sg,".mobile-header").registerElementComponent(Fg,".component-select-dropdown").registerElementComponent(yg,".seller-contact-form-trigger").registerElementComponent(fg,".listing-trouble-reaching-form-trigger").registerElementComponent(Tg,".listing-rental-warning-trigger").registerElementComponent(Kg,".know-more").registerElementComponent(e_,".footer__menu-item").registerCollectionComponent(Vs,".mortgage-data__form").registerCollectionComponent(Yg,"a.header__my-account-button").registerCollectionComponent(Xg,".header__my-account-button--loggedin").registerCollectionComponent(Zg,"body").registerElementComponent(Jg,".infosession-container").registerElementComponent(Qg,".wistia_embed").registerElementComponent(s_,".featured-builder").registerElementComponent(Pg,".listing-contact-form-trigger").registerElementComponent(i_,".sub-menu-navigation-trigger").registerElementComponent(r_,".dp-stats-tracking").registerElementComponent(c_,".listing-contact-phone-trigger").registerElementComponent(l_,".search-results-listings-list--featured").registerElementComponent(p_,".pb-accordeon__tab").registerElementComponent(wg,".js-modal-callback").registerElementComponent(h_,".pb-redirected-banner").registerElementComponent(u_,".faq").registerElementComponent(m_,"html").registerElementComponent(__,".blog").registerElementComponent(v_,".sell-services").registerElementComponent(y_,".sell-questions").registerElementComponent(f_,".js-exit-popup").initialize(),window.React=r.a,window.ReactDOM=o.a,window.ReactComponents={Message:$e,SearchBar:Qa,SearchPagination:ii,TestimonialsPagination:ci,PhotoViewer:Bi,MobileSearch:Vi,AutoPromoViewer:Zi,TestimonialViewer:er,SortOrderDropdown:rr,TestimonialsRegionDropdown:or,FeaturedProperties:hr,SimilarProperties:_r,SavingsCalculator:yr,ListingMap:To,SearchMap:So,ListingStreetViewButton:No,ListingTabs:Oo,ContactForm:Fo,ContactUsForm:$o,CallMeForm:zo,SellerContactForm:Zo,ListingContact:Sl,ListingContactForm:tl,MortgageCalculator:rc,CallbackForm:pc,ListingTroubleReachingForm:mc,SearchMapListingCount:fc,EmailAlertsForm:Dc,FavouriteToggleButton:so,FavouriteNotesPanel:Ic,FavouriteNotesModal:jc,SearchResultsParams:Lc,SearchResultsParamsCount:$c,ListingDistanceTag:Hc,BuilderListingsPagination:Kc,FeaturedCompany:rp,InfoSessionsList:up,InfoSessionsForm:lp,InfoSessionsTicker:_p,InfoSessionsCaroussel:yp,ProvinceSelectorModal:Tp,ReferralForm:Ep,TermsOfUsePopup:Sp,InfoSessionsPopup:Lp,WebinarPopup:Op,LiveChat:Dp,Packages:td,LandingPage3DShowcaseViewer:ad,LandingPageWistiaVirtualTour:rd,SurveyPopup:od,ShowingBookingTool:ch,ShowingBookingPostOffer:gh,ShowingBookingSummary:bh,ShowingFeedbackForm:fh,ContactUsTabs:wh,AlertSubscription:Dh,BlogCategoryDropdown:Ih,BlogProvinceDropdown:jh,PricingCarrousel:Wm,PricingDisclaimer:Xm,PricingFooter:ig,WarningMessageBar:og},window.addEventListener("message",Ce,!1),Se.a.registerElements()},5:function(e,t,s){"use strict";var a=s(2),i=s.n(a),r=["listing-view-property","sold-search-click-listing-image","sold-search-click-listing-link"],n=(e,t,s,a)=>{var i={event:e,eventCategory:t,eventAction:s,eventLabel:a};if(window.DP.isRental){i={event:e,eventCategory:t,eventAction:s,eventLabel:a,eventValue:1}}window.DP.configSwitch.Gtm&&dataLayer.push(i)};t.a={pushToDataLayer:n,pushVirtualPageView:e=>{window.DP.configSwitch.Gtm&&dataLayer.push({event:"gtm-virtualpageview",url:e})},registerElements:()=>{i()(".gtm__push-event").each((e,t)=>{i()(t).unbind("click".concat(".gtm__push-event")),i()(t).bind("click".concat(".gtm__push-event"),e=>{(e=>{if(window.DP.configSwitch.Gtm&&window.google_tag_manager){var t=Object.entries(window.DP.gtm_events),s=function(t,s){if(!e.currentTarget.matches("".concat(".gtm__push-event","__").concat(s.name)))return"continue";"non-link"!==s.type&&-1===r.indexOf(s.name)&&e.preventDefault(),dataLayer.push({event:"gtm-event",eventCategory:window.DP.context.pageType,eventAction:s.action,eventLabel:s.label,eventCallback:()=>{if("non-link"!==s.type&&-1===r.indexOf(s.name)){var t=i()(e.currentTarget).attr("target"),a=i()(e.currentTarget).attr("href");t&&"_blank"===t?window.open(a,t):window.location=a}},eventTimeout:2e3})};for(var[a,n]of t)s(0,n)}})(e)})})},pushDynamicEvent:(e,t)=>{if(window.DP.configSwitch.Gtm&&window.google_tag_manager){var s=Object.entries(window.DP.gtm_events);for(var[a,i]of s)i.name===e&&n("gtm-event",t,i.action,i.label)}}}},70:function(e,t,s){"use strict";var a=s(2),i=s.n(a);t.a={hasScrolledIntoView:e=>{var t=i()(window),s=i()(e);if(s.length){var a=t.scrollTop(),r=a+t.height(),n=s.offset().top,o=n+s.height();return a<n&&r>o}return!1}}}},[[265,0,1]]]);
//# sourceMappingURL=app.da2970.js.map